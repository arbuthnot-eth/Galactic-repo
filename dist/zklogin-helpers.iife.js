var SuiSDKZkLoginHelpers=(function(Ut){"use strict";const Fe=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];function Wn(e,t){if(!t||t==10)return BigInt(e);if(t==16)return e.slice(0,2)=="0x"?BigInt(e):BigInt("0x"+e)}const zt=Wn;function Se(e,t){let n=BigInt(0);t=BigInt(t);for(let o=0;o<e.length;o++)n=n*t+BigInt(e[o]);return n}function Mn(e){const t=e.toString(16);return(t.length-1)*4+Fe[parseInt(t[0],16)]}function da(e){return BigInt(e)<BigInt(0)}function _a(e){return!e}function Xn(e,t){return BigInt(e)<<BigInt(t)}function mn(e,t){return BigInt(e)>>BigInt(t)}const ve=Xn,xe=mn;function po(e){return(BigInt(e)&BigInt(1))==BigInt(1)}function Pe(e){let t=BigInt(e);const n=[];for(;t;){if(t&BigInt(1)){const o=2-Number(t%BigInt(4));n.push(o),t=t-BigInt(o)}else n.push(0);t=t>>BigInt(1)}return n}function ga(e){let t=BigInt(e);const n=[];for(;t;)t&BigInt(1)?n.push(1):n.push(0),t=t>>BigInt(1);return n}function ua(e){if(e>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("Number too big");return Number(e)}function Oe(e,t){const n=[];let o=BigInt(e);for(t=BigInt(t);o;)n.unshift(Number(o%t)),o=o/t;return n}function Ao(e,t){return BigInt(e)+BigInt(t)}function on(e,t){return BigInt(e)-BigInt(t)}function ha(e){return-BigInt(e)}function fa(e,t){return BigInt(e)*BigInt(t)}function Qe(e){return BigInt(e)*BigInt(e)}function qn(e,t){return BigInt(e)**BigInt(t)}function Me(e,t){return BigInt(e)**BigInt(t)}function qe(e){return BigInt(e)>=0?BigInt(e):-BigInt(e)}function wn(e,t){return BigInt(e)/BigInt(t)}function tn(e,t){return BigInt(e)%BigInt(t)}function pn(e,t){return BigInt(e)==BigInt(t)}function Ue(e,t){return BigInt(e)!=BigInt(t)}function ze(e,t){return BigInt(e)<BigInt(t)}function bo(e,t){return BigInt(e)>BigInt(t)}function ke(e,t){return BigInt(e)<=BigInt(t)}function La(e,t){return BigInt(e)>=BigInt(t)}function yo(e,t){return BigInt(e)&BigInt(t)}function De(e,t){return BigInt(e)|BigInt(t)}function Te(e,t){return BigInt(e)^BigInt(t)}function Ge(e,t){return BigInt(e)&&BigInt(t)}function Re(e,t){return BigInt(e)||BigInt(t)}function Ne(e){return!BigInt(e)}function Un(e,t,n,o){const a="0000000"+n.toString(16),s=new Uint32Array(e.buffer,e.byteOffset+t,o/4),f=((a.length-7)*4-1>>5)+1;for(let g=0;g<f;g++)s[g]=parseInt(a.substring(a.length-8*g-8,a.length-8*g),16);for(let g=f;g<s.length;g++)s[g]=0;for(let g=s.length*4;g<o;g++)e[g]=ua(yo(mn(n,g*8),255))}function pa(e,t,n,o){const a="0000000"+n.toString(16),s=new DataView(e.buffer,e.byteOffset+t,o),f=((a.length-7)*4-1>>5)+1;for(let g=0;g<f;g++)s.setUint32(o-g*4-4,parseInt(a.substring(a.length-8*g-8,a.length-8*g),16),!1);for(let g=0;g<o/4-f;g++)s[g]=0}function zn(e,t,n){n=n||e.byteLength,t=t||0;const o=new Uint32Array(e.buffer,e.byteOffset+t,n/4),a=new Array(n/4);return o.forEach((s,f)=>a[a.length-f-1]=s.toString(16).padStart(8,"0")),Wn(a.join(""),16)}function Aa(e,t,n){n=n||e.byteLength,t=t||0;const o=new DataView(e.buffer,e.byteOffset+t,n),a=new Array(n/4);for(let s=0;s<n/4;s++)a[s]=o.getUint32(s*4,!1).toString(16).padStart(8,"0");return Wn(a.join(""),16)}function ba(e,t){return e.toString(t)}function Bn(e){const t=new Uint8Array(Math.floor((Mn(e)-1)/8)+1);return Un(t,0,e,t.byteLength),t}const ya=zt(0),An=zt(1);var Ke=Object.freeze({__proto__:null,abs:qe,add:Ao,band:yo,bitLength:Mn,bits:ga,bor:De,bxor:Te,div:wn,e:zt,eq:pn,exp:Me,fromArray:Se,fromRprBE:Aa,fromRprLE:zn,fromString:Wn,geq:La,gt:bo,isNegative:da,isOdd:po,isZero:_a,land:Ge,leq:ke,lnot:Ne,lor:Re,lt:ze,mod:tn,mul:fa,naf:Pe,neg:ha,neq:Ue,one:An,pow:qn,shiftLeft:Xn,shiftRight:mn,shl:ve,shr:xe,square:Qe,sub:on,toArray:Oe,toLEBuff:Bn,toNumber:ua,toRprBE:pa,toRprLE:Un,toString:ba,zero:ya});function Ia(e,t,n){if(_a(n))return e.one;const o=ga(n);if(o.length==0)return e.one;let a=t;for(let s=o.length-2;s>=0;s--)a=e.square(a),o[s]&&(a=e.mul(a,t));return a}function He(e){if(e.m%2==1)if(pn(tn(e.p,4),1))if(pn(tn(e.p,8),1))if(pn(tn(e.p,16),1))Ve(e);else if(pn(tn(e.p,16),9))$e(e);else throw new Error("Field withot sqrt");else if(pn(tn(e.p,8),5))je(e);else throw new Error("Field withot sqrt");else pn(tn(e.p,4),3)&&Ye(e);else{const t=tn(qn(e.p,e.m/2),4);t==1?Ze(e):t==3?Je(e):We(e)}}function Ve(e){for(e.sqrt_q=qn(e.p,e.m),e.sqrt_s=0,e.sqrt_t=on(e.sqrt_q,1);!po(e.sqrt_t);)e.sqrt_s=e.sqrt_s+1,e.sqrt_t=wn(e.sqrt_t,2);let t=e.one;for(;e.eq(t,e.one);){const n=e.random();e.sqrt_z=e.pow(n,e.sqrt_t),t=e.pow(e.sqrt_z,2**(e.sqrt_s-1))}e.sqrt_tm1d2=wn(on(e.sqrt_t,1),2),e.sqrt=function(n){const o=this;if(o.isZero(n))return o.zero;let a=o.pow(n,o.sqrt_tm1d2);const s=o.pow(o.mul(o.square(a),n),2**(o.sqrt_s-1));if(o.eq(s,o.negone))return null;let f=o.sqrt_s,g=o.mul(n,a),I=o.mul(g,a),u=o.sqrt_z;for(;!o.eq(I,o.one);){let l=o.square(I),E=1;for(;!o.eq(l,o.one);)l=o.square(l),E++;a=u;for(let F=0;F<f-E-1;F++)a=o.square(a);u=o.square(a),I=o.mul(I,u),g=o.mul(g,a),f=E}return o.geq(g,o.zero)?g:o.neg(g)}}function $e(e){e.sqrt=function(){throw new Error("Sqrt alg 4 not implemented")}}function je(e){e.sqrt=function(){throw new Error("Sqrt alg 3 not implemented")}}function Ye(e){e.sqrt_q=qn(e.p,e.m),e.sqrt_e1=wn(on(e.sqrt_q,3),4),e.sqrt=function(t){if(this.isZero(t))return this.zero;const n=this.pow(t,this.sqrt_e1),o=this.mul(this.square(n),t);if(this.eq(o,this.negone))return null;const a=this.mul(n,t);return e.geq(a,e.zero)?a:e.neg(a)}}function Ze(e){e.sqrt=function(){throw new Error("Sqrt alg 10 not implemented")}}function Je(e){e.sqrt_q=qn(e.p,e.m/2),e.sqrt_e34=wn(on(e.sqrt_q,3),4),e.sqrt_e12=wn(on(e.sqrt_q,1),2),e.frobenius=function(t,n){return t%2==1?e.conjugate(n):n},e.sqrt=function(t){const n=this,o=n.pow(t,n.sqrt_e34),a=n.mul(n.square(o),t),s=n.mul(n.frobenius(1,a),a);if(n.eq(s,n.negone))return null;const f=n.mul(o,t);let g;if(n.eq(a,n.negone))g=n.mul(f,[n.F.zero,n.F.one]);else{const I=n.pow(n.add(n.one,a),n.sqrt_e12);g=n.mul(I,f)}return n.geq(g,n.zero)?g:n.neg(g)}}function We(e){e.sqrt=function(){throw new Error("Sqrt alg 8 not implemented")}}function dn(e,t,n,o,a){e[t]=e[t]+e[n]>>>0,e[a]=(e[a]^e[t])>>>0,e[a]=(e[a]<<16|e[a]>>>16&65535)>>>0,e[o]=e[o]+e[a]>>>0,e[n]=(e[n]^e[o])>>>0,e[n]=(e[n]<<12|e[n]>>>20&4095)>>>0,e[t]=e[t]+e[n]>>>0,e[a]=(e[a]^e[t])>>>0,e[a]=(e[a]<<8|e[a]>>>24&255)>>>0,e[o]=e[o]+e[a]>>>0,e[n]=(e[n]^e[o])>>>0,e[n]=(e[n]<<7|e[n]>>>25&127)>>>0}function Xe(e){dn(e,0,4,8,12),dn(e,1,5,9,13),dn(e,2,6,10,14),dn(e,3,7,11,15),dn(e,0,5,10,15),dn(e,1,6,11,12),dn(e,2,7,8,13),dn(e,3,4,9,14)}class tc{constructor(t){t=t||[0,0,0,0,0,0,0,0],this.state=[1634760805,857760878,2036477234,1797285236,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],0,0,0,0],this.idx=16,this.buff=new Array(16)}nextU32(){return this.idx==16&&this.update(),this.buff[this.idx++]}nextU64(){return Ao(fa(this.nextU32(),4294967296),this.nextU32())}nextBool(){return(this.nextU32()&1)==1}update(){for(let t=0;t<16;t++)this.buff[t]=this.state[t];for(let t=0;t<10;t++)Xe(this.buff);for(let t=0;t<16;t++)this.buff[t]=this.buff[t]+this.state[t]>>>0;this.idx=0,this.state[12]=this.state[12]+1>>>0,this.state[12]==0&&(this.state[13]=this.state[13]+1>>>0,this.state[13]==0&&(this.state[14]=this.state[14]+1>>>0,this.state[14]==0&&(this.state[15]=this.state[15]+1>>>0)))}}function Ca(e){let t=new Uint8Array(e);if(typeof globalThis.crypto<"u")globalThis.crypto.getRandomValues(t);else for(let n=0;n<e;n++)t[n]=Math.random()*4294967296>>>0;return t}function nc(){const e=Ca(32),t=new Uint32Array(e.buffer),n=[];for(let o=0;o<8;o++)n.push(t[o]);return n}let to=null;function Io(){return to||(to=new tc(nc()),to)}class oc{constructor(t,n,o){this.F=n,this.G=t,this.opMulGF=o;let a=n.sqrt_t||n.t,s=n.sqrt_s||n.s,f=n.one;for(;n.eq(n.pow(f,n.half),n.one);)f=n.add(f,n.one);this.w=new Array(s+1),this.wi=new Array(s+1),this.w[s]=this.F.pow(f,a),this.wi[s]=this.F.inv(this.w[s]);let g=s-1;for(;g>=0;)this.w[g]=this.F.square(this.w[g+1]),this.wi[g]=this.F.square(this.wi[g+1]),g--;this.roots=[],this._setRoots(Math.min(s,15))}_setRoots(t){for(let n=t;n>=0&&!this.roots[n];n--){let o=this.F.one;const a=1<<n,s=new Array(a);for(let f=0;f<a;f++)s[f]=o,o=this.F.mul(o,this.w[n]);this.roots[n]=s}}fft(t){if(t.length<=1)return t;const n=ma(t.length-1)+1;this._setRoots(n);const o=1<<n;if(t.length!=o)throw new Error("Size must be multiple of 2");return no(this,t,n,0,1)}ifft(t){if(t.length<=1)return t;const n=ma(t.length-1)+1;this._setRoots(n);const o=1<<n;if(t.length!=o)throw new Error("Size must be multiple of 2");const a=no(this,t,n,0,1),s=this.F.inv(this.F.mulScalar(this.F.one,o)),f=new Array(o);for(let g=0;g<o;g++)f[g]=this.opMulGF(a[(o-g)%o],s);return f}}function ma(e){return((e&4294901760)!==0?(e&=4294901760,16):0)|((e&4278255360)!==0?(e&=4278255360,8):0)|((e&4042322160)!==0?(e&=4042322160,4):0)|((e&3435973836)!==0?(e&=3435973836,2):0)|(e&2863311530)!==0}function no(e,t,n,o,a){const s=1<<n;if(s==1)return[t[o]];if(s==2)return[e.G.add(t[o],t[o+a]),e.G.sub(t[o],t[o+a])];const f=s>>1,g=no(e,t,n-1,o,a*2),I=no(e,t,n-1,o+a,a*2),u=new Array(s);for(let l=0;l<f;l++)u[l]=e.G.add(g[l],e.opMulGF(I[l],e.roots[n][l])),u[l+f]=e.G.sub(g[l],e.opMulGF(I[l],e.roots[n][l]));return u}class ac{constructor(t){this.type="F1",this.one=BigInt(1),this.zero=BigInt(0),this.p=BigInt(t),this.m=1,this.negone=this.p-this.one,this.two=BigInt(2),this.half=this.p>>this.one,this.bitLength=Mn(this.p),this.mask=(this.one<<BigInt(this.bitLength))-this.one,this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=this.n64*2,this.n8=this.n64*8,this.R=this.e(this.one<<BigInt(this.n64*64)),this.Ri=this.inv(this.R);const n=this.negone>>this.one;this.nqr=this.two;let o=this.pow(this.nqr,n);for(;!this.eq(o,this.negone);)this.nqr=this.nqr+this.one,o=this.pow(this.nqr,n);for(this.s=0,this.t=this.negone;(this.t&this.one)==this.zero;)this.s=this.s+1,this.t=this.t>>this.one;this.nqr_to_t=this.pow(this.nqr,this.t),He(this),this.FFT=new oc(this,this,this.mul.bind(this)),this.fft=this.FFT.fft.bind(this.FFT),this.ifft=this.FFT.ifft.bind(this.FFT),this.w=this.FFT.w,this.wi=this.FFT.wi,this.shift=this.square(this.nqr),this.k=this.exp(this.nqr,2**this.s)}e(t,n){let o;if(n?n==16&&(o=BigInt("0x"+t)):o=BigInt(t),o<0){let a=-o;return a>=this.p&&(a=a%this.p),this.p-a}else return o>=this.p?o%this.p:o}add(t,n){const o=t+n;return o>=this.p?o-this.p:o}sub(t,n){return t>=n?t-n:this.p-n+t}neg(t){return t&&this.p-t}mul(t,n){return t*n%this.p}mulScalar(t,n){return t*this.e(n)%this.p}square(t){return t*t%this.p}eq(t,n){return t==n}neq(t,n){return t!=n}lt(t,n){const o=t>this.half?t-this.p:t,a=n>this.half?n-this.p:n;return o<a}gt(t,n){const o=t>this.half?t-this.p:t,a=n>this.half?n-this.p:n;return o>a}leq(t,n){const o=t>this.half?t-this.p:t,a=n>this.half?n-this.p:n;return o<=a}geq(t,n){const o=t>this.half?t-this.p:t,a=n>this.half?n-this.p:n;return o>=a}div(t,n){return this.mul(t,this.inv(n))}idiv(t,n){if(!n)throw new Error("Division by zero");return t/n}inv(t){if(!t)throw new Error("Division by zero");let n=this.zero,o=this.p,a=this.one,s=t%this.p;for(;s;){let f=o/s;[n,a]=[a,n-f*a],[o,s]=[s,o-f*s]}return n<this.zero&&(n+=this.p),n}mod(t,n){return t%n}pow(t,n){return Ia(this,t,n)}exp(t,n){return Ia(this,t,n)}band(t,n){const o=t&n&this.mask;return o>=this.p?o-this.p:o}bor(t,n){const o=(t|n)&this.mask;return o>=this.p?o-this.p:o}bxor(t,n){const o=(t^n)&this.mask;return o>=this.p?o-this.p:o}bnot(t){const n=t^this.mask;return n>=this.p?n-this.p:n}shl(t,n){if(Number(n)<this.bitLength){const o=t<<n&this.mask;return o>=this.p?o-this.p:o}else{const o=this.p-n;return Number(o)<this.bitLength?t>>o:this.zero}}shr(t,n){if(Number(n)<this.bitLength)return t>>n;{const o=this.p-n;if(Number(o)<this.bitLength){const a=t<<o&this.mask;return a>=this.p?a-this.p:a}else return 0}}land(t,n){return t&&n?this.one:this.zero}lor(t,n){return t||n?this.one:this.zero}lnot(t){return t?this.zero:this.one}sqrt_old(t){if(t==this.zero)return this.zero;if(this.pow(t,this.negone>>this.one)!=this.one)return null;let o=this.s,a=this.nqr_to_t,s=this.pow(t,this.t),f=this.pow(t,this.add(this.t,this.one)>>this.one);for(;s!=this.one;){let g=this.square(s),I=1;for(;g!=this.one;)I++,g=this.square(g);let u=a;for(let l=0;l<o-I-1;l++)u=this.square(u);o=I,a=this.square(u),s=this.mul(s,a),f=this.mul(f,u)}return f>this.p>>this.one&&(f=this.neg(f)),f}normalize(t,n){if(t=BigInt(t,n),t<0){let o=-t;return o>=this.p&&(o=o%this.p),this.p-o}else return t>=this.p?t%this.p:t}random(){const t=this.bitLength*2/8;let n=this.zero;for(let o=0;o<t;o++)n=(n<<BigInt(8))+BigInt(Ca(1)[0]);return n%this.p}toString(t,n){n=n||10;let o;return t>this.half&&n==10?o="-"+(this.p-t).toString(n):o=t.toString(n),o}isZero(t){return t==this.zero}fromRng(t){let n;do{n=this.zero;for(let o=0;o<this.n64;o++)n+=t.nextU64()<<BigInt(64*o);n&=this.mask}while(n>=this.p);return n=n*this.Ri%this.p,n}fft(t){return this.FFT.fft(t)}ifft(t){return this.FFT.ifft(t)}toRprLE(t,n,o){Un(t,n,o,this.n64*8)}toRprBE(t,n,o){pa(t,n,o,this.n64*8)}toRprBEM(t,n,o){return this.toRprBE(t,n,this.mul(this.R,o))}toRprLEM(t,n,o){return this.toRprLE(t,n,this.mul(this.R,o))}fromRprLE(t,n){return zn(t,n,this.n8)}fromRprBE(t,n){return Aa(t,n,this.n8)}fromRprLEM(t,n){return this.mul(this.fromRprLE(t,n),this.Ri)}fromRprBEM(t,n){return this.mul(this.fromRprBE(t,n),this.Ri)}toObject(t){return t}}var _n={};_n.bigInt2BytesLE=function(t,n){const o=Array(n);let a=BigInt(t);for(let s=0;s<n;s++)o[s]=Number(a&0xFFn),a=a>>8n;return o},_n.bigInt2U32LE=function(t,n){const o=Array(n);let a=BigInt(t);for(let s=0;s<n;s++)o[s]=Number(a&0xFFFFFFFFn),a=a>>32n;return o},_n.isOcamNum=function(e){return!(!Array.isArray(e)||e.length!=3||typeof e[0]!="number"||typeof e[1]!="number"||!Array.isArray(e[2]))};var ic=function(t,n,o){const a=o||"int";if(t.modules[a])return a;t.modules[a]={};const s=n*2,f=n*8;function g(){const w=t.addFunction(a+"_copy");w.addParam("px","i32"),w.addParam("pr","i32");const _=w.getCodeBuilder();for(let p=0;p<n;p++)w.addCode(_.i64_store(_.getLocal("pr"),p*8,_.i64_load(_.getLocal("px"),p*8)))}function I(){const w=t.addFunction(a+"_zero");w.addParam("pr","i32");const _=w.getCodeBuilder();for(let p=0;p<n;p++)w.addCode(_.i64_store(_.getLocal("pr"),p*8,_.i64_const(0)))}function u(){const w=t.addFunction(a+"_one");w.addParam("pr","i32");const _=w.getCodeBuilder();w.addCode(_.i64_store(_.getLocal("pr"),0,_.i64_const(1)));for(let p=1;p<n;p++)w.addCode(_.i64_store(_.getLocal("pr"),p*8,_.i64_const(0)))}function l(){const w=t.addFunction(a+"_isZero");w.addParam("px","i32"),w.setReturnType("i32");const _=w.getCodeBuilder();function p(V){return V==0?_.ret(_.i64_eqz(_.i64_load(_.getLocal("px")))):_.if(_.i64_eqz(_.i64_load(_.getLocal("px"),V*8)),p(V-1),_.ret(_.i32_const(0)))}w.addCode(p(n-1)),w.addCode(_.ret(_.i32_const(0)))}function E(){const w=t.addFunction(a+"_eq");w.addParam("px","i32"),w.addParam("py","i32"),w.setReturnType("i32");const _=w.getCodeBuilder();function p(V){return V==0?_.ret(_.i64_eq(_.i64_load(_.getLocal("px")),_.i64_load(_.getLocal("py")))):_.if(_.i64_eq(_.i64_load(_.getLocal("px"),V*8),_.i64_load(_.getLocal("py"),V*8)),p(V-1),_.ret(_.i32_const(0)))}w.addCode(p(n-1)),w.addCode(_.ret(_.i32_const(0)))}function F(){const w=t.addFunction(a+"_gte");w.addParam("px","i32"),w.addParam("py","i32"),w.setReturnType("i32");const _=w.getCodeBuilder();function p(V){return V==0?_.ret(_.i64_ge_u(_.i64_load(_.getLocal("px")),_.i64_load(_.getLocal("py")))):_.if(_.i64_lt_u(_.i64_load(_.getLocal("px"),V*8),_.i64_load(_.getLocal("py"),V*8)),_.ret(_.i32_const(0)),_.if(_.i64_gt_u(_.i64_load(_.getLocal("px"),V*8),_.i64_load(_.getLocal("py"),V*8)),_.ret(_.i32_const(1)),p(V-1)))}w.addCode(p(n-1)),w.addCode(_.ret(_.i32_const(0)))}function A(){const w=t.addFunction(a+"_add");w.addParam("x","i32"),w.addParam("y","i32"),w.addParam("r","i32"),w.setReturnType("i32"),w.addLocal("c","i64");const _=w.getCodeBuilder();w.addCode(_.setLocal("c",_.i64_add(_.i64_load32_u(_.getLocal("x")),_.i64_load32_u(_.getLocal("y"))))),w.addCode(_.i64_store32(_.getLocal("r"),_.getLocal("c")));for(let p=1;p<s;p++)w.addCode(_.setLocal("c",_.i64_add(_.i64_add(_.i64_load32_u(_.getLocal("x"),4*p),_.i64_load32_u(_.getLocal("y"),4*p)),_.i64_shr_u(_.getLocal("c"),_.i64_const(32))))),w.addCode(_.i64_store32(_.getLocal("r"),p*4,_.getLocal("c")));w.addCode(_.i32_wrap_i64(_.i64_shr_u(_.getLocal("c"),_.i64_const(32))))}function k(){const w=t.addFunction(a+"_sub");w.addParam("x","i32"),w.addParam("y","i32"),w.addParam("r","i32"),w.setReturnType("i32"),w.addLocal("c","i64");const _=w.getCodeBuilder();w.addCode(_.setLocal("c",_.i64_sub(_.i64_load32_u(_.getLocal("x")),_.i64_load32_u(_.getLocal("y"))))),w.addCode(_.i64_store32(_.getLocal("r"),_.i64_and(_.getLocal("c"),_.i64_const("0xFFFFFFFF"))));for(let p=1;p<s;p++)w.addCode(_.setLocal("c",_.i64_add(_.i64_sub(_.i64_load32_u(_.getLocal("x"),4*p),_.i64_load32_u(_.getLocal("y"),4*p)),_.i64_shr_s(_.getLocal("c"),_.i64_const(32))))),w.addCode(_.i64_store32(_.getLocal("r"),p*4,_.i64_and(_.getLocal("c"),_.i64_const("0xFFFFFFFF"))));w.addCode(_.i32_wrap_i64(_.i64_shr_s(_.getLocal("c"),_.i64_const(32))))}function D(){const w=t.addFunction(a+"_mul");w.addParam("x","i32"),w.addParam("y","i32"),w.addParam("r","i32"),w.addLocal("c0","i64"),w.addLocal("c1","i64");for(let b=0;b<s;b++)w.addLocal("x"+b,"i64"),w.addLocal("y"+b,"i64");const _=w.getCodeBuilder(),p=[],V=[];function j(b,x){let z,ot;return p[b]?z=_.getLocal("x"+b):(z=_.teeLocal("x"+b,_.i64_load32_u(_.getLocal("x"),b*4)),p[b]=!0),V[x]?ot=_.getLocal("y"+x):(ot=_.teeLocal("y"+x,_.i64_load32_u(_.getLocal("y"),x*4)),V[x]=!0),_.i64_mul(z,ot)}let X="c0",O="c1";for(let b=0;b<s*2-1;b++){for(let x=Math.max(0,b-s+1);x<=b&&x<s;x++){const z=b-x;w.addCode(_.setLocal(X,_.i64_add(_.i64_and(_.getLocal(X),_.i64_const(4294967295)),j(x,z)))),w.addCode(_.setLocal(O,_.i64_add(_.getLocal(O),_.i64_shr_u(_.getLocal(X),_.i64_const(32)))))}w.addCode(_.i64_store32(_.getLocal("r"),b*4,_.getLocal(X))),[X,O]=[O,X],w.addCode(_.setLocal(O,_.i64_shr_u(_.getLocal(X),_.i64_const(32))))}w.addCode(_.i64_store32(_.getLocal("r"),s*4*2-4,_.getLocal(X)))}function B(){const w=t.addFunction(a+"_square");w.addParam("x","i32"),w.addParam("r","i32"),w.addLocal("c0","i64"),w.addLocal("c1","i64"),w.addLocal("c0_old","i64"),w.addLocal("c1_old","i64");for(let x=0;x<s;x++)w.addLocal("x"+x,"i64");const _=w.getCodeBuilder(),p=[];function V(x,z){let ot,tt;return p[x]?ot=_.getLocal("x"+x):(ot=_.teeLocal("x"+x,_.i64_load32_u(_.getLocal("x"),x*4)),p[x]=!0),p[z]?tt=_.getLocal("x"+z):(tt=_.teeLocal("x"+z,_.i64_load32_u(_.getLocal("x"),z*4)),p[z]=!0),_.i64_mul(ot,tt)}let j="c0",X="c1",O="c0_old",b="c1_old";for(let x=0;x<s*2-1;x++){w.addCode(_.setLocal(j,_.i64_const(0)),_.setLocal(X,_.i64_const(0)));for(let z=Math.max(0,x-s+1);z<x+1>>1&&z<s;z++){const ot=x-z;w.addCode(_.setLocal(j,_.i64_add(_.i64_and(_.getLocal(j),_.i64_const(4294967295)),V(z,ot)))),w.addCode(_.setLocal(X,_.i64_add(_.getLocal(X),_.i64_shr_u(_.getLocal(j),_.i64_const(32)))))}w.addCode(_.setLocal(j,_.i64_shl(_.i64_and(_.getLocal(j),_.i64_const(4294967295)),_.i64_const(1)))),w.addCode(_.setLocal(X,_.i64_add(_.i64_shl(_.getLocal(X),_.i64_const(1)),_.i64_shr_u(_.getLocal(j),_.i64_const(32))))),x%2==0&&(w.addCode(_.setLocal(j,_.i64_add(_.i64_and(_.getLocal(j),_.i64_const(4294967295)),V(x>>1,x>>1)))),w.addCode(_.setLocal(X,_.i64_add(_.getLocal(X),_.i64_shr_u(_.getLocal(j),_.i64_const(32)))))),x>0&&(w.addCode(_.setLocal(j,_.i64_add(_.i64_and(_.getLocal(j),_.i64_const(4294967295)),_.i64_and(_.getLocal(O),_.i64_const(4294967295))))),w.addCode(_.setLocal(X,_.i64_add(_.i64_add(_.getLocal(X),_.i64_shr_u(_.getLocal(j),_.i64_const(32))),_.getLocal(b))))),w.addCode(_.i64_store32(_.getLocal("r"),x*4,_.getLocal(j))),w.addCode(_.setLocal(O,_.getLocal(X)),_.setLocal(b,_.i64_shr_u(_.getLocal(O),_.i64_const(32))))}w.addCode(_.i64_store32(_.getLocal("r"),s*4*2-4,_.getLocal(O)))}function G(){const w=t.addFunction(a+"_squareOld");w.addParam("x","i32"),w.addParam("r","i32");const _=w.getCodeBuilder();w.addCode(_.call(a+"_mul",_.getLocal("x"),_.getLocal("x"),_.getLocal("r")))}function S(){const w=t.addFunction(a+"__mul1");w.addParam("px","i32"),w.addParam("y","i64"),w.addParam("pr","i32"),w.addLocal("c","i64");const _=w.getCodeBuilder();w.addCode(_.setLocal("c",_.i64_mul(_.i64_load32_u(_.getLocal("px"),0,0),_.getLocal("y")))),w.addCode(_.i64_store32(_.getLocal("pr"),0,0,_.getLocal("c")));for(let p=1;p<s;p++)w.addCode(_.setLocal("c",_.i64_add(_.i64_mul(_.i64_load32_u(_.getLocal("px"),4*p,0),_.getLocal("y")),_.i64_shr_u(_.getLocal("c"),_.i64_const(32))))),w.addCode(_.i64_store32(_.getLocal("pr"),p*4,0,_.getLocal("c")))}function st(){const w=t.addFunction(a+"__add1");w.addParam("x","i32"),w.addParam("y","i64"),w.addLocal("c","i64"),w.addLocal("px","i32");const _=w.getCodeBuilder();w.addCode(_.setLocal("px",_.getLocal("x"))),w.addCode(_.setLocal("c",_.i64_add(_.i64_load32_u(_.getLocal("px"),0,0),_.getLocal("y")))),w.addCode(_.i64_store32(_.getLocal("px"),0,0,_.getLocal("c"))),w.addCode(_.setLocal("c",_.i64_shr_u(_.getLocal("c"),_.i64_const(32)))),w.addCode(_.block(_.loop(_.br_if(1,_.i64_eqz(_.getLocal("c"))),_.setLocal("px",_.i32_add(_.getLocal("px"),_.i32_const(4))),_.setLocal("c",_.i64_add(_.i64_load32_u(_.getLocal("px"),0,0),_.getLocal("c"))),_.i64_store32(_.getLocal("px"),0,0,_.getLocal("c")),_.setLocal("c",_.i64_shr_u(_.getLocal("c"),_.i64_const(32))),_.br(0))))}function U(){S(),st();const w=t.addFunction(a+"_div");w.addParam("x","i32"),w.addParam("y","i32"),w.addParam("c","i32"),w.addParam("r","i32"),w.addLocal("rr","i32"),w.addLocal("cc","i32"),w.addLocal("eX","i32"),w.addLocal("eY","i32"),w.addLocal("sy","i64"),w.addLocal("sx","i64"),w.addLocal("ec","i32");const _=w.getCodeBuilder(),p=_.i32_const(t.alloc(f)),V=_.i32_const(t.alloc(f)),j=_.i32_const(t.alloc(f)),X=_.getLocal("cc"),O=_.getLocal("rr"),b=t.alloc(f*2),x=_.i32_const(b),z=_.i32_const(b+f);w.addCode(_.if(_.getLocal("c"),_.setLocal("cc",_.getLocal("c")),_.setLocal("cc",V))),w.addCode(_.if(_.getLocal("r"),_.setLocal("rr",_.getLocal("r")),_.setLocal("rr",j))),w.addCode(_.call(a+"_copy",_.getLocal("x"),O)),w.addCode(_.call(a+"_copy",_.getLocal("y"),p)),w.addCode(_.call(a+"_zero",X)),w.addCode(_.call(a+"_zero",x)),w.addCode(_.setLocal("eX",_.i32_const(f-1))),w.addCode(_.setLocal("eY",_.i32_const(f-1))),w.addCode(_.block(_.loop(_.br_if(1,_.i32_or(_.i32_load8_u(_.i32_add(p,_.getLocal("eY")),0,0),_.i32_eq(_.getLocal("eY"),_.i32_const(3)))),_.setLocal("eY",_.i32_sub(_.getLocal("eY"),_.i32_const(1))),_.br(0)))),w.addCode(_.setLocal("sy",_.i64_add(_.i64_load32_u(_.i32_sub(_.i32_add(p,_.getLocal("eY")),_.i32_const(3)),0,0),_.i64_const(1)))),w.addCode(_.if(_.i64_eq(_.getLocal("sy"),_.i64_const(1)),_.drop(_.i64_div_u(_.i64_const(0),_.i64_const(0))))),w.addCode(_.block(_.loop(_.block(_.loop(_.br_if(1,_.i32_or(_.i32_load8_u(_.i32_add(O,_.getLocal("eX")),0,0),_.i32_eq(_.getLocal("eX"),_.i32_const(7)))),_.setLocal("eX",_.i32_sub(_.getLocal("eX"),_.i32_const(1))),_.br(0))),_.setLocal("sx",_.i64_load(_.i32_sub(_.i32_add(O,_.getLocal("eX")),_.i32_const(7)),0,0)),_.setLocal("sx",_.i64_div_u(_.getLocal("sx"),_.getLocal("sy"))),_.setLocal("ec",_.i32_sub(_.i32_sub(_.getLocal("eX"),_.getLocal("eY")),_.i32_const(4))),_.block(_.loop(_.br_if(1,_.i32_and(_.i64_eqz(_.i64_and(_.getLocal("sx"),_.i64_const("0xFFFFFFFF00000000"))),_.i32_ge_s(_.getLocal("ec"),_.i32_const(0)))),_.setLocal("sx",_.i64_shr_u(_.getLocal("sx"),_.i64_const(8))),_.setLocal("ec",_.i32_add(_.getLocal("ec"),_.i32_const(1))),_.br(0))),_.if(_.i64_eqz(_.getLocal("sx")),[..._.br_if(2,_.i32_eqz(_.call(a+"_gte",O,p))),..._.setLocal("sx",_.i64_const(1)),..._.setLocal("ec",_.i32_const(0))]),_.call(a+"__mul1",p,_.getLocal("sx"),z),_.drop(_.call(a+"_sub",O,_.i32_sub(z,_.getLocal("ec")),O)),_.call(a+"__add1",_.i32_add(X,_.getLocal("ec")),_.getLocal("sx")),_.br(0))))}function lt(){const w=t.addFunction(a+"_inverseMod");w.addParam("px","i32"),w.addParam("pm","i32"),w.addParam("pr","i32"),w.addLocal("t","i32"),w.addLocal("newt","i32"),w.addLocal("r","i32"),w.addLocal("qq","i32"),w.addLocal("qr","i32"),w.addLocal("newr","i32"),w.addLocal("swp","i32"),w.addLocal("x","i32"),w.addLocal("signt","i32"),w.addLocal("signnewt","i32"),w.addLocal("signx","i32");const _=w.getCodeBuilder(),p=_.i32_const(t.alloc(f)),V=_.i32_const(t.alloc(f)),j=_.i32_const(t.alloc(f)),X=_.i32_const(t.alloc(f)),O=_.i32_const(t.alloc(f)),b=_.i32_const(t.alloc(f)),x=_.i32_const(t.alloc(f*2)),z=_.i32_const(t.alloc(f));w.addCode(_.setLocal("t",p),_.call(a+"_zero",p),_.setLocal("signt",_.i32_const(0))),w.addCode(_.setLocal("r",V),_.call(a+"_copy",_.getLocal("pm"),V)),w.addCode(_.setLocal("newt",j),_.call(a+"_one",j),_.setLocal("signnewt",_.i32_const(0))),w.addCode(_.setLocal("newr",X),_.call(a+"_copy",_.getLocal("px"),X)),w.addCode(_.setLocal("qq",O)),w.addCode(_.setLocal("qr",b)),w.addCode(_.setLocal("x",z)),w.addCode(_.block(_.loop(_.br_if(1,_.call(a+"_isZero",_.getLocal("newr"))),_.call(a+"_div",_.getLocal("r"),_.getLocal("newr"),_.getLocal("qq"),_.getLocal("qr")),_.call(a+"_mul",_.getLocal("qq"),_.getLocal("newt"),x),_.if(_.getLocal("signt"),_.if(_.getLocal("signnewt"),_.if(_.call(a+"_gte",x,_.getLocal("t")),[..._.drop(_.call(a+"_sub",x,_.getLocal("t"),_.getLocal("x"))),..._.setLocal("signx",_.i32_const(0))],[..._.drop(_.call(a+"_sub",_.getLocal("t"),x,_.getLocal("x"))),..._.setLocal("signx",_.i32_const(1))]),[..._.drop(_.call(a+"_add",x,_.getLocal("t"),_.getLocal("x"))),..._.setLocal("signx",_.i32_const(1))]),_.if(_.getLocal("signnewt"),[..._.drop(_.call(a+"_add",x,_.getLocal("t"),_.getLocal("x"))),..._.setLocal("signx",_.i32_const(0))],_.if(_.call(a+"_gte",_.getLocal("t"),x),[..._.drop(_.call(a+"_sub",_.getLocal("t"),x,_.getLocal("x"))),..._.setLocal("signx",_.i32_const(0))],[..._.drop(_.call(a+"_sub",x,_.getLocal("t"),_.getLocal("x"))),..._.setLocal("signx",_.i32_const(1))]))),_.setLocal("swp",_.getLocal("t")),_.setLocal("t",_.getLocal("newt")),_.setLocal("newt",_.getLocal("x")),_.setLocal("x",_.getLocal("swp")),_.setLocal("signt",_.getLocal("signnewt")),_.setLocal("signnewt",_.getLocal("signx")),_.setLocal("swp",_.getLocal("r")),_.setLocal("r",_.getLocal("newr")),_.setLocal("newr",_.getLocal("qr")),_.setLocal("qr",_.getLocal("swp")),_.br(0)))),w.addCode(_.if(_.getLocal("signt"),_.drop(_.call(a+"_sub",_.getLocal("pm"),_.getLocal("t"),_.getLocal("pr"))),_.call(a+"_copy",_.getLocal("t"),_.getLocal("pr"))))}return g(),I(),l(),u(),E(),F(),A(),k(),D(),B(),G(),U(),lt(),t.exportFunction(a+"_copy"),t.exportFunction(a+"_zero"),t.exportFunction(a+"_one"),t.exportFunction(a+"_isZero"),t.exportFunction(a+"_eq"),t.exportFunction(a+"_gte"),t.exportFunction(a+"_add"),t.exportFunction(a+"_sub"),t.exportFunction(a+"_mul"),t.exportFunction(a+"_square"),t.exportFunction(a+"_squareOld"),t.exportFunction(a+"_div"),t.exportFunction(a+"_inverseMod"),a},Co=function(t,n,o,a,s,f,g){const I=t.addFunction(n);I.addParam("base","i32"),I.addParam("scalar","i32"),I.addParam("scalarLength","i32"),I.addParam("r","i32"),I.addLocal("i","i32"),I.addLocal("b","i32");const u=I.getCodeBuilder(),l=u.i32_const(t.alloc(o));I.addCode(u.if(u.i32_eqz(u.getLocal("scalarLength")),[...u.call(g,u.getLocal("r")),...u.ret([])])),I.addCode(u.call(f,u.getLocal("base"),l)),I.addCode(u.call(g,u.getLocal("r"))),I.addCode(u.setLocal("i",u.getLocal("scalarLength"))),I.addCode(u.block(u.loop(u.setLocal("i",u.i32_sub(u.getLocal("i"),u.i32_const(1))),u.setLocal("b",u.i32_load8_u(u.i32_add(u.getLocal("scalar"),u.getLocal("i")))),...E(),u.br_if(1,u.i32_eqz(u.getLocal("i"))),u.br(0))));function E(){const F=[];for(let A=0;A<8;A++)F.push(...u.call(s,u.getLocal("r"),u.getLocal("r")),...u.if(u.i32_ge_u(u.getLocal("b"),u.i32_const(128>>A)),[...u.setLocal("b",u.i32_sub(u.getLocal("b"),u.i32_const(128>>A))),...u.call(a,u.getLocal("r"),l,u.getLocal("r"))]));return F}},mo=ec;function ec(e,t){const n=e.modules[t].n64*8,o=e.addFunction(t+"_batchInverse");o.addParam("pIn","i32"),o.addParam("inStep","i32"),o.addParam("n","i32"),o.addParam("pOut","i32"),o.addParam("outStep","i32"),o.addLocal("itAux","i32"),o.addLocal("itIn","i32"),o.addLocal("itOut","i32"),o.addLocal("i","i32");const a=o.getCodeBuilder(),s=a.i32_const(e.alloc(n));o.addCode(a.setLocal("itAux",a.i32_load(a.i32_const(0))),a.i32_store(a.i32_const(0),a.i32_add(a.getLocal("itAux"),a.i32_mul(a.i32_add(a.getLocal("n"),a.i32_const(1)),a.i32_const(n))))),o.addCode(a.call(t+"_one",a.getLocal("itAux")),a.setLocal("itIn",a.getLocal("pIn")),a.setLocal("itAux",a.i32_add(a.getLocal("itAux"),a.i32_const(n))),a.setLocal("i",a.i32_const(0)),a.block(a.loop(a.br_if(1,a.i32_eq(a.getLocal("i"),a.getLocal("n"))),a.if(a.call(t+"_isZero",a.getLocal("itIn")),a.call(t+"_copy",a.i32_sub(a.getLocal("itAux"),a.i32_const(n)),a.getLocal("itAux")),a.call(t+"_mul",a.getLocal("itIn"),a.i32_sub(a.getLocal("itAux"),a.i32_const(n)),a.getLocal("itAux"))),a.setLocal("itIn",a.i32_add(a.getLocal("itIn"),a.getLocal("inStep"))),a.setLocal("itAux",a.i32_add(a.getLocal("itAux"),a.i32_const(n))),a.setLocal("i",a.i32_add(a.getLocal("i"),a.i32_const(1))),a.br(0))),a.setLocal("itIn",a.i32_sub(a.getLocal("itIn"),a.getLocal("inStep"))),a.setLocal("itAux",a.i32_sub(a.getLocal("itAux"),a.i32_const(n))),a.setLocal("itOut",a.i32_add(a.getLocal("pOut"),a.i32_mul(a.i32_sub(a.getLocal("n"),a.i32_const(1)),a.getLocal("outStep")))),a.call(t+"_inverse",a.getLocal("itAux"),a.getLocal("itAux")),a.block(a.loop(a.br_if(1,a.i32_eqz(a.getLocal("i"))),a.if(a.call(t+"_isZero",a.getLocal("itIn")),[...a.call(t+"_copy",a.getLocal("itAux"),a.i32_sub(a.getLocal("itAux"),a.i32_const(n))),...a.call(t+"_zero",a.getLocal("itOut"))],[...a.call(t+"_copy",a.i32_sub(a.getLocal("itAux"),a.i32_const(n)),s),...a.call(t+"_mul",a.getLocal("itAux"),a.getLocal("itIn"),a.i32_sub(a.getLocal("itAux"),a.i32_const(n))),...a.call(t+"_mul",a.getLocal("itAux"),s,a.getLocal("itOut"))]),a.setLocal("itIn",a.i32_sub(a.getLocal("itIn"),a.getLocal("inStep"))),a.setLocal("itOut",a.i32_sub(a.getLocal("itOut"),a.getLocal("outStep"))),a.setLocal("itAux",a.i32_sub(a.getLocal("itAux"),a.i32_const(n))),a.setLocal("i",a.i32_sub(a.getLocal("i"),a.i32_const(1))),a.br(0)))),o.addCode(a.i32_store(a.i32_const(0),a.getLocal("itAux")))}var wa=cc;function cc(e,t,n,o,a,s){typeof s>"u"&&(o<a?s=!0:s=!1);const f=e.addFunction(t);f.addParam("pIn","i32"),f.addParam("n","i32"),f.addParam("pOut","i32"),f.addLocal("i","i32"),f.addLocal("itIn","i32"),f.addLocal("itOut","i32");const g=f.getCodeBuilder();s?f.addCode(g.setLocal("itIn",g.i32_add(g.getLocal("pIn"),g.i32_mul(g.i32_sub(g.getLocal("n"),g.i32_const(1)),g.i32_const(o)))),g.setLocal("itOut",g.i32_add(g.getLocal("pOut"),g.i32_mul(g.i32_sub(g.getLocal("n"),g.i32_const(1)),g.i32_const(a)))),g.setLocal("i",g.i32_const(0)),g.block(g.loop(g.br_if(1,g.i32_eq(g.getLocal("i"),g.getLocal("n"))),g.call(n,g.getLocal("itIn"),g.getLocal("itOut")),g.setLocal("itIn",g.i32_sub(g.getLocal("itIn"),g.i32_const(o))),g.setLocal("itOut",g.i32_sub(g.getLocal("itOut"),g.i32_const(a))),g.setLocal("i",g.i32_add(g.getLocal("i"),g.i32_const(1))),g.br(0)))):f.addCode(g.setLocal("itIn",g.getLocal("pIn")),g.setLocal("itOut",g.getLocal("pOut")),g.setLocal("i",g.i32_const(0)),g.block(g.loop(g.br_if(1,g.i32_eq(g.getLocal("i"),g.getLocal("n"))),g.call(n,g.getLocal("itIn"),g.getLocal("itOut")),g.setLocal("itIn",g.i32_add(g.getLocal("itIn"),g.i32_const(o))),g.setLocal("itOut",g.i32_add(g.getLocal("itOut"),g.i32_const(a))),g.setLocal("i",g.i32_add(g.getLocal("i"),g.i32_const(1))),g.br(0))))}var sc=lc;function lc(e,t,n,o,a,s){typeof s>"u"&&(o<a?s=!0:s=!1);const f=e.addFunction(t);f.addParam("pIn1","i32"),f.addParam("pIn2","i32"),f.addParam("n","i32"),f.addParam("pOut","i32"),f.addLocal("i","i32"),f.addLocal("itIn1","i32"),f.addLocal("itIn2","i32"),f.addLocal("itOut","i32");const g=f.getCodeBuilder();s?f.addCode(g.setLocal("itIn1",g.i32_add(g.getLocal("pIn1"),g.i32_mul(g.i32_sub(g.getLocal("n"),g.i32_const(1)),g.i32_const(o)))),g.setLocal("itIn2",g.i32_add(g.getLocal("pIn2"),g.i32_mul(g.i32_sub(g.getLocal("n"),g.i32_const(1)),g.i32_const(o)))),g.setLocal("itOut",g.i32_add(g.getLocal("pOut"),g.i32_mul(g.i32_sub(g.getLocal("n"),g.i32_const(1)),g.i32_const(a)))),g.setLocal("i",g.i32_const(0)),g.block(g.loop(g.br_if(1,g.i32_eq(g.getLocal("i"),g.getLocal("n"))),g.call(n,g.getLocal("itIn1"),g.getLocal("itIn2"),g.getLocal("itOut")),g.setLocal("itIn1",g.i32_sub(g.getLocal("itIn1"),g.i32_const(o))),g.setLocal("itIn2",g.i32_sub(g.getLocal("itIn2"),g.i32_const(o))),g.setLocal("itOut",g.i32_sub(g.getLocal("itOut"),g.i32_const(a))),g.setLocal("i",g.i32_add(g.getLocal("i"),g.i32_const(1))),g.br(0)))):f.addCode(g.setLocal("itIn1",g.getLocal("pIn1")),g.setLocal("itIn2",g.getLocal("pIn2")),g.setLocal("itOut",g.getLocal("pOut")),g.setLocal("i",g.i32_const(0)),g.block(g.loop(g.br_if(1,g.i32_eq(g.getLocal("i"),g.getLocal("n"))),g.call(n,g.getLocal("itIn1"),g.getLocal("itIn2"),g.getLocal("itOut")),g.setLocal("itIn1",g.i32_add(g.getLocal("itIn1"),g.i32_const(o))),g.setLocal("itIn2",g.i32_add(g.getLocal("itIn2"),g.i32_const(o))),g.setLocal("itOut",g.i32_add(g.getLocal("itOut"),g.i32_const(a))),g.setLocal("i",g.i32_add(g.getLocal("i"),g.i32_const(1))),g.br(0))))}var Kt={};function Ba(e,t){return e===t?0:e>t?1:-1}function wo(e){return e*e}function Ea(e){return e%2n!==0n}function Bo(e){return e%2n===0n}function oo(e){return e<0n}function rc(e){return e>0n}function Fa(e){return oo(e)?e.toString(2).length-1:e.toString(2).length}function kn(e){return e<0n?-e:e}function En(e){return kn(e)===1n}function Sa(e,t){for(var n=0n,o=1n,a=t,s=kn(e),f,g,I;s!==0n;)f=a/s,g=n,I=a,n=o,a=s,o=g-f*o,s=I-f*s;if(!En(a))throw new Error(e.toString()+" and "+t.toString()+" are not co-prime");return Ba(n,0n)===-1&&(n=n+t),oo(e)?-n:n}function va(e,t,n){if(n===0n)throw new Error("Cannot take modPow with modulus 0");var o=1n,a=e%n;for(oo(t)&&(t=t*-1n,a=Sa(a,n));rc(t);){if(a===0n)return 0n;Ea(t)&&(o=o*a%n),t=t/2n,a=wo(a)%n}return o}function dc(e,t){return e=e>=0n?e:-e,t=t>=0n?t:-t,e===t?0:e>t?1:-1}function xa(e,t){return t===0n?!1:En(t)?!0:dc(t,2n)===0?Bo(e):e%t===0n}function _c(e){var t=kn(e);if(En(t))return!1;if(t===2n||t===3n||t===5n)return!0;if(Bo(t)||xa(t,3n)||xa(t,5n))return!1;if(t<49n)return!0}function gc(e){return e-1n}function Pa(e,t){for(var n=gc(e),o=n,a=0,s,f,g;Bo(o);)o=o/2n,a++;t:for(f=0;f<t.length;f++)if(!(e<t[f])&&(g=va(BigInt(t[f]),o,e),!(En(g)||g===n))){for(s=a-1;s!=0;s--){if(g=wo(g)%e,En(g))return!1;if(g===n)continue t}return!1}return!0}function uc(e){var t=_c(e);if(t!==void 0)return t;var n=kn(e),o=Fa(n);if(o<=64)return Pa(n,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var a=Math.log(2)*Number(o),s=Math.ceil(a),f=[],g=0;g<s;g++)f.push(BigInt(g+2));return Pa(n,f)}Kt.bitLength=Fa,Kt.isOdd=Ea,Kt.isNegative=oo,Kt.abs=kn,Kt.isUnit=En,Kt.compare=Ba,Kt.modInv=Sa,Kt.modPow=va,Kt.isPrime=uc,Kt.square=wo;const hc=ic,an=_n,fc=Co,Lc=mo,Eo=wa,Fo=sc,{bitLength:pc,modInv:So,modPow:Oa,isPrime:Qa,isOdd:Ac,square:bc}=Kt;var vo=function(t,n,o,a){const s=BigInt(n),f=Math.floor((pc(s-1n)-1)/64)+1,g=f*2,I=f*8,u=o||"f1m";if(t.modules[u])return u;const l=hc(t,f,a),E=t.alloc(I,an.bigInt2BytesLE(s,I)),F=t.alloc(an.bigInt2BytesLE(bc(1n<<BigInt(f*64))%s,I)),A=t.alloc(an.bigInt2BytesLE((1n<<BigInt(f*64))%s,I)),k=t.alloc(an.bigInt2BytesLE(0n,I)),D=s-1n,B=D>>1n,G=t.alloc(I,an.bigInt2BytesLE(B,I)),S=B+1n,st=t.alloc(I,an.bigInt2BytesLE(S,I));t.modules[u]={pq:E,pR2:F,n64:f,q:s,pOne:A,pZero:k,pePlusOne:st};function U(){const y=t.addFunction(u+"_one");y.addParam("pr","i32");const h=y.getCodeBuilder();y.addCode(h.call(l+"_copy",h.i32_const(A),h.getLocal("pr")))}function lt(){const y=t.addFunction(u+"_add");y.addParam("x","i32"),y.addParam("y","i32"),y.addParam("r","i32");const h=y.getCodeBuilder();y.addCode(h.if(h.call(l+"_add",h.getLocal("x"),h.getLocal("y"),h.getLocal("r")),h.drop(h.call(l+"_sub",h.getLocal("r"),h.i32_const(E),h.getLocal("r"))),h.if(h.call(l+"_gte",h.getLocal("r"),h.i32_const(E)),h.drop(h.call(l+"_sub",h.getLocal("r"),h.i32_const(E),h.getLocal("r"))))))}function w(){const y=t.addFunction(u+"_sub");y.addParam("x","i32"),y.addParam("y","i32"),y.addParam("r","i32");const h=y.getCodeBuilder();y.addCode(h.if(h.call(l+"_sub",h.getLocal("x"),h.getLocal("y"),h.getLocal("r")),h.drop(h.call(l+"_add",h.getLocal("r"),h.i32_const(E),h.getLocal("r")))))}function _(){const y=t.addFunction(u+"_neg");y.addParam("x","i32"),y.addParam("r","i32");const h=y.getCodeBuilder();y.addCode(h.call(u+"_sub",h.i32_const(k),h.getLocal("x"),h.getLocal("r")))}function p(){const y=t.addFunction(u+"_isNegative");y.addParam("x","i32"),y.setReturnType("i32");const h=y.getCodeBuilder(),v=h.i32_const(t.alloc(I));y.addCode(h.call(u+"_fromMontgomery",h.getLocal("x"),v),h.call(l+"_gte",v,h.i32_const(st)))}function V(){const y=t.addFunction(u+"_sign");y.addParam("x","i32"),y.setReturnType("i32");const h=y.getCodeBuilder(),v=h.i32_const(t.alloc(I));y.addCode(h.if(h.call(l+"_isZero",h.getLocal("x")),h.ret(h.i32_const(0))),h.call(u+"_fromMontgomery",h.getLocal("x"),v),h.if(h.call(l+"_gte",v,h.i32_const(st)),h.ret(h.i32_const(-1))),h.ret(h.i32_const(1)))}function j(){const y=t.alloc(g*g*8),h=t.addFunction(u+"_mReduct");h.addParam("t","i32"),h.addParam("r","i32"),h.addLocal("np32","i64"),h.addLocal("c","i64"),h.addLocal("m","i64");const v=h.getCodeBuilder(),W=Number(0x100000000n-So(s,0x100000000n));h.addCode(v.setLocal("np32",v.i64_const(W)));for(let R=0;R<g;R++){h.addCode(v.setLocal("c",v.i64_const(0))),h.addCode(v.setLocal("m",v.i64_and(v.i64_mul(v.i64_load32_u(v.getLocal("t"),R*4),v.getLocal("np32")),v.i64_const("0xFFFFFFFF"))));for(let at=0;at<g;at++)h.addCode(v.setLocal("c",v.i64_add(v.i64_add(v.i64_load32_u(v.getLocal("t"),(R+at)*4),v.i64_shr_u(v.getLocal("c"),v.i64_const(32))),v.i64_mul(v.i64_load32_u(v.i32_const(E),at*4),v.getLocal("m"))))),h.addCode(v.i64_store32(v.getLocal("t"),(R+at)*4,v.getLocal("c")));h.addCode(v.i64_store32(v.i32_const(y),R*4,v.i64_shr_u(v.getLocal("c"),v.i64_const(32))))}h.addCode(v.call(u+"_add",v.i32_const(y),v.i32_add(v.getLocal("t"),v.i32_const(g*4)),v.getLocal("r")))}function X(){const y=t.addFunction(u+"_mul");y.addParam("x","i32"),y.addParam("y","i32"),y.addParam("r","i32"),y.addLocal("c0","i64"),y.addLocal("c1","i64"),y.addLocal("np32","i64");for(let gt=0;gt<g;gt++)y.addLocal("x"+gt,"i64"),y.addLocal("y"+gt,"i64"),y.addLocal("m"+gt,"i64"),y.addLocal("q"+gt,"i64");const h=y.getCodeBuilder(),v=Number(0x100000000n-So(s,0x100000000n));y.addCode(h.setLocal("np32",h.i64_const(v)));const W=[],R=[],at=[];function yt(gt,rt){let bt,xt;return W[gt]?bt=h.getLocal("x"+gt):(bt=h.teeLocal("x"+gt,h.i64_load32_u(h.getLocal("x"),gt*4)),W[gt]=!0),R[rt]?xt=h.getLocal("y"+rt):(xt=h.teeLocal("y"+rt,h.i64_load32_u(h.getLocal("y"),rt*4)),R[rt]=!0),h.i64_mul(bt,xt)}function dt(gt,rt){let bt,xt;return at[gt]?bt=h.getLocal("q"+gt):(bt=h.teeLocal("q"+gt,h.i64_load32_u(h.i32_const(0),E+gt*4)),at[gt]=!0),xt=h.getLocal("m"+rt),h.i64_mul(bt,xt)}let Lt="c0",St="c1";for(let gt=0;gt<g*2-1;gt++){for(let rt=Math.max(0,gt-g+1);rt<=gt&&rt<g;rt++){const bt=gt-rt;y.addCode(h.setLocal(Lt,h.i64_add(h.i64_and(h.getLocal(Lt),h.i64_const(4294967295)),yt(rt,bt)))),y.addCode(h.setLocal(St,h.i64_add(h.getLocal(St),h.i64_shr_u(h.getLocal(Lt),h.i64_const(32)))))}for(let rt=Math.max(1,gt-g+1);rt<=gt&&rt<g;rt++){const bt=gt-rt;y.addCode(h.setLocal(Lt,h.i64_add(h.i64_and(h.getLocal(Lt),h.i64_const(4294967295)),dt(rt,bt)))),y.addCode(h.setLocal(St,h.i64_add(h.getLocal(St),h.i64_shr_u(h.getLocal(Lt),h.i64_const(32)))))}gt<g&&(y.addCode(h.setLocal("m"+gt,h.i64_and(h.i64_mul(h.i64_and(h.getLocal(Lt),h.i64_const(4294967295)),h.getLocal("np32")),h.i64_const("0xFFFFFFFF")))),y.addCode(h.setLocal(Lt,h.i64_add(h.i64_and(h.getLocal(Lt),h.i64_const(4294967295)),dt(0,gt)))),y.addCode(h.setLocal(St,h.i64_add(h.getLocal(St),h.i64_shr_u(h.getLocal(Lt),h.i64_const(32)))))),gt>=g&&y.addCode(h.i64_store32(h.getLocal("r"),(gt-g)*4,h.getLocal(Lt))),[Lt,St]=[St,Lt],y.addCode(h.setLocal(St,h.i64_shr_u(h.getLocal(Lt),h.i64_const(32))))}y.addCode(h.i64_store32(h.getLocal("r"),g*4-4,h.getLocal(Lt))),y.addCode(h.if(h.i32_wrap_i64(h.getLocal(St)),h.drop(h.call(l+"_sub",h.getLocal("r"),h.i32_const(E),h.getLocal("r"))),h.if(h.call(l+"_gte",h.getLocal("r"),h.i32_const(E)),h.drop(h.call(l+"_sub",h.getLocal("r"),h.i32_const(E),h.getLocal("r"))))))}function O(){const y=t.addFunction(u+"_square");y.addParam("x","i32"),y.addParam("r","i32"),y.addLocal("c0","i64"),y.addLocal("c1","i64"),y.addLocal("c0_old","i64"),y.addLocal("c1_old","i64"),y.addLocal("np32","i64");for(let rt=0;rt<g;rt++)y.addLocal("x"+rt,"i64"),y.addLocal("m"+rt,"i64"),y.addLocal("q"+rt,"i64");const h=y.getCodeBuilder(),v=Number(0x100000000n-So(s,0x100000000n));y.addCode(h.setLocal("np32",h.i64_const(v)));const W=[],R=[];function at(rt,bt){let xt,Mt;return W[rt]?xt=h.getLocal("x"+rt):(xt=h.teeLocal("x"+rt,h.i64_load32_u(h.getLocal("x"),rt*4)),W[rt]=!0),W[bt]?Mt=h.getLocal("x"+bt):(Mt=h.teeLocal("x"+bt,h.i64_load32_u(h.getLocal("x"),bt*4)),W[bt]=!0),h.i64_mul(xt,Mt)}function yt(rt,bt){let xt,Mt;return R[rt]?xt=h.getLocal("q"+rt):(xt=h.teeLocal("q"+rt,h.i64_load32_u(h.i32_const(0),E+rt*4)),R[rt]=!0),Mt=h.getLocal("m"+bt),h.i64_mul(xt,Mt)}let dt="c0",Lt="c1",St="c0_old",gt="c1_old";for(let rt=0;rt<g*2-1;rt++){y.addCode(h.setLocal(dt,h.i64_const(0)),h.setLocal(Lt,h.i64_const(0)));for(let bt=Math.max(0,rt-g+1);bt<rt+1>>1&&bt<g;bt++){const xt=rt-bt;y.addCode(h.setLocal(dt,h.i64_add(h.i64_and(h.getLocal(dt),h.i64_const(4294967295)),at(bt,xt)))),y.addCode(h.setLocal(Lt,h.i64_add(h.getLocal(Lt),h.i64_shr_u(h.getLocal(dt),h.i64_const(32)))))}y.addCode(h.setLocal(dt,h.i64_shl(h.i64_and(h.getLocal(dt),h.i64_const(4294967295)),h.i64_const(1)))),y.addCode(h.setLocal(Lt,h.i64_add(h.i64_shl(h.getLocal(Lt),h.i64_const(1)),h.i64_shr_u(h.getLocal(dt),h.i64_const(32))))),rt%2==0&&(y.addCode(h.setLocal(dt,h.i64_add(h.i64_and(h.getLocal(dt),h.i64_const(4294967295)),at(rt>>1,rt>>1)))),y.addCode(h.setLocal(Lt,h.i64_add(h.getLocal(Lt),h.i64_shr_u(h.getLocal(dt),h.i64_const(32)))))),rt>0&&(y.addCode(h.setLocal(dt,h.i64_add(h.i64_and(h.getLocal(dt),h.i64_const(4294967295)),h.i64_and(h.getLocal(St),h.i64_const(4294967295))))),y.addCode(h.setLocal(Lt,h.i64_add(h.i64_add(h.getLocal(Lt),h.i64_shr_u(h.getLocal(dt),h.i64_const(32))),h.getLocal(gt)))));for(let bt=Math.max(1,rt-g+1);bt<=rt&&bt<g;bt++){const xt=rt-bt;y.addCode(h.setLocal(dt,h.i64_add(h.i64_and(h.getLocal(dt),h.i64_const(4294967295)),yt(bt,xt)))),y.addCode(h.setLocal(Lt,h.i64_add(h.getLocal(Lt),h.i64_shr_u(h.getLocal(dt),h.i64_const(32)))))}rt<g&&(y.addCode(h.setLocal("m"+rt,h.i64_and(h.i64_mul(h.i64_and(h.getLocal(dt),h.i64_const(4294967295)),h.getLocal("np32")),h.i64_const("0xFFFFFFFF")))),y.addCode(h.setLocal(dt,h.i64_add(h.i64_and(h.getLocal(dt),h.i64_const(4294967295)),yt(0,rt)))),y.addCode(h.setLocal(Lt,h.i64_add(h.getLocal(Lt),h.i64_shr_u(h.getLocal(dt),h.i64_const(32)))))),rt>=g&&y.addCode(h.i64_store32(h.getLocal("r"),(rt-g)*4,h.getLocal(dt))),y.addCode(h.setLocal(St,h.getLocal(Lt)),h.setLocal(gt,h.i64_shr_u(h.getLocal(St),h.i64_const(32))))}y.addCode(h.i64_store32(h.getLocal("r"),g*4-4,h.getLocal(St))),y.addCode(h.if(h.i32_wrap_i64(h.getLocal(gt)),h.drop(h.call(l+"_sub",h.getLocal("r"),h.i32_const(E),h.getLocal("r"))),h.if(h.call(l+"_gte",h.getLocal("r"),h.i32_const(E)),h.drop(h.call(l+"_sub",h.getLocal("r"),h.i32_const(E),h.getLocal("r"))))))}function b(){const y=t.addFunction(u+"_squareOld");y.addParam("x","i32"),y.addParam("r","i32");const h=y.getCodeBuilder();y.addCode(h.call(u+"_mul",h.getLocal("x"),h.getLocal("x"),h.getLocal("r")))}function x(){const y=t.addFunction(u+"_toMontgomery");y.addParam("x","i32"),y.addParam("r","i32");const h=y.getCodeBuilder();y.addCode(h.call(u+"_mul",h.getLocal("x"),h.i32_const(F),h.getLocal("r")))}function z(){const y=t.alloc(I*2),h=t.addFunction(u+"_fromMontgomery");h.addParam("x","i32"),h.addParam("r","i32");const v=h.getCodeBuilder();h.addCode(v.call(l+"_copy",v.getLocal("x"),v.i32_const(y))),h.addCode(v.call(l+"_zero",v.i32_const(y+I))),h.addCode(v.call(u+"_mReduct",v.i32_const(y),v.getLocal("r")))}function ot(){const y=t.addFunction(u+"_inverse");y.addParam("x","i32"),y.addParam("r","i32");const h=y.getCodeBuilder();y.addCode(h.call(u+"_fromMontgomery",h.getLocal("x"),h.getLocal("r"))),y.addCode(h.call(l+"_inverseMod",h.getLocal("r"),h.i32_const(E),h.getLocal("r"))),y.addCode(h.call(u+"_toMontgomery",h.getLocal("r"),h.getLocal("r")))}let tt=2n;if(Qa(s))for(;Oa(tt,B,s)!==D;)tt=tt+1n;let K=0,it=D;for(;!Ac(it)&&it!==0n;)K++,it=it>>1n;const J=t.alloc(I,an.bigInt2BytesLE(it,I)),et=Oa(tt,it,s),pt=t.alloc(an.bigInt2BytesLE((et<<BigInt(f*64))%s,I)),wt=it+1n>>1n,ft=t.alloc(I,an.bigInt2BytesLE(wt,I));function L(){const y=t.addFunction(u+"_sqrt");y.addParam("n","i32"),y.addParam("r","i32"),y.addLocal("m","i32"),y.addLocal("i","i32"),y.addLocal("j","i32");const h=y.getCodeBuilder(),v=h.i32_const(A),W=h.i32_const(t.alloc(I)),R=h.i32_const(t.alloc(I)),at=h.i32_const(t.alloc(I)),yt=h.i32_const(t.alloc(I)),dt=h.i32_const(t.alloc(I));y.addCode(h.if(h.call(u+"_isZero",h.getLocal("n")),h.ret(h.call(u+"_zero",h.getLocal("r")))),h.setLocal("m",h.i32_const(K)),h.call(u+"_copy",h.i32_const(pt),W),h.call(u+"_exp",h.getLocal("n"),h.i32_const(J),h.i32_const(I),R),h.call(u+"_exp",h.getLocal("n"),h.i32_const(ft),h.i32_const(I),at),h.block(h.loop(h.br_if(1,h.call(u+"_eq",R,v)),h.call(u+"_square",R,yt),h.setLocal("i",h.i32_const(1)),h.block(h.loop(h.br_if(1,h.call(u+"_eq",yt,v)),h.call(u+"_square",yt,yt),h.setLocal("i",h.i32_add(h.getLocal("i"),h.i32_const(1))),h.br(0))),h.call(u+"_copy",W,dt),h.setLocal("j",h.i32_sub(h.i32_sub(h.getLocal("m"),h.getLocal("i")),h.i32_const(1))),h.block(h.loop(h.br_if(1,h.i32_eqz(h.getLocal("j"))),h.call(u+"_square",dt,dt),h.setLocal("j",h.i32_sub(h.getLocal("j"),h.i32_const(1))),h.br(0))),h.setLocal("m",h.getLocal("i")),h.call(u+"_square",dt,W),h.call(u+"_mul",R,W,R),h.call(u+"_mul",at,dt,at),h.br(0))),h.if(h.call(u+"_isNegative",at),h.call(u+"_neg",at,h.getLocal("r")),h.call(u+"_copy",at,h.getLocal("r"))))}function i(){const y=t.addFunction(u+"_isSquare");y.addParam("n","i32"),y.setReturnType("i32");const h=y.getCodeBuilder(),v=h.i32_const(A),W=h.i32_const(t.alloc(I));y.addCode(h.if(h.call(u+"_isZero",h.getLocal("n")),h.ret(h.i32_const(1))),h.call(u+"_exp",h.getLocal("n"),h.i32_const(G),h.i32_const(I),W),h.call(u+"_eq",W,v))}function C(){const y=t.addFunction(u+"_load");y.addParam("scalar","i32"),y.addParam("scalarLen","i32"),y.addParam("r","i32"),y.addLocal("p","i32"),y.addLocal("l","i32"),y.addLocal("i","i32"),y.addLocal("j","i32");const h=y.getCodeBuilder(),v=h.i32_const(t.alloc(I)),W=t.alloc(I),R=h.i32_const(W);y.addCode(h.call(l+"_zero",h.getLocal("r")),h.setLocal("i",h.i32_const(I)),h.setLocal("p",h.getLocal("scalar")),h.block(h.loop(h.br_if(1,h.i32_gt_u(h.getLocal("i"),h.getLocal("scalarLen"))),h.if(h.i32_eq(h.getLocal("i"),h.i32_const(I)),h.call(u+"_one",v),h.call(u+"_mul",v,h.i32_const(F),v)),h.call(u+"_mul",h.getLocal("p"),v,R),h.call(u+"_add",h.getLocal("r"),R,h.getLocal("r")),h.setLocal("p",h.i32_add(h.getLocal("p"),h.i32_const(I))),h.setLocal("i",h.i32_add(h.getLocal("i"),h.i32_const(I))),h.br(0))),h.setLocal("l",h.i32_rem_u(h.getLocal("scalarLen"),h.i32_const(I))),h.if(h.i32_eqz(h.getLocal("l")),h.ret([])),h.call(l+"_zero",R),h.setLocal("j",h.i32_const(0)),h.block(h.loop(h.br_if(1,h.i32_eq(h.getLocal("j"),h.getLocal("l"))),h.i32_store8(h.getLocal("j"),W,h.i32_load8_u(h.getLocal("p"))),h.setLocal("p",h.i32_add(h.getLocal("p"),h.i32_const(1))),h.setLocal("j",h.i32_add(h.getLocal("j"),h.i32_const(1))),h.br(0))),h.if(h.i32_eq(h.getLocal("i"),h.i32_const(I)),h.call(u+"_one",v),h.call(u+"_mul",v,h.i32_const(F),v)),h.call(u+"_mul",R,v,R),h.call(u+"_add",h.getLocal("r"),R,h.getLocal("r")))}function c(){const y=t.addFunction(u+"_timesScalar");y.addParam("x","i32"),y.addParam("scalar","i32"),y.addParam("scalarLen","i32"),y.addParam("r","i32");const h=y.getCodeBuilder(),v=h.i32_const(t.alloc(I));y.addCode(h.call(u+"_load",h.getLocal("scalar"),h.getLocal("scalarLen"),v),h.call(u+"_toMontgomery",v,v),h.call(u+"_mul",h.getLocal("x"),v,h.getLocal("r")))}function m(){const y=t.addFunction(u+"_isOne");y.addParam("x","i32"),y.setReturnType("i32");const h=y.getCodeBuilder();y.addCode(h.ret(h.call(l+"_eq",h.getLocal("x"),h.i32_const(A))))}return t.exportFunction(l+"_copy",u+"_copy"),t.exportFunction(l+"_zero",u+"_zero"),t.exportFunction(l+"_isZero",u+"_isZero"),t.exportFunction(l+"_eq",u+"_eq"),m(),lt(),w(),_(),j(),X(),O(),b(),x(),z(),p(),V(),ot(),U(),C(),c(),Lc(t,u),Eo(t,u+"_batchToMontgomery",u+"_toMontgomery",I,I),Eo(t,u+"_batchFromMontgomery",u+"_fromMontgomery",I,I),Eo(t,u+"_batchNeg",u+"_neg",I,I),Fo(t,u+"_batchAdd",u+"_add",I,I),Fo(t,u+"_batchSub",u+"_sub",I,I),Fo(t,u+"_batchMul",u+"_mul",I,I),t.exportFunction(u+"_add"),t.exportFunction(u+"_sub"),t.exportFunction(u+"_neg"),t.exportFunction(u+"_isNegative"),t.exportFunction(u+"_isOne"),t.exportFunction(u+"_sign"),t.exportFunction(u+"_mReduct"),t.exportFunction(u+"_mul"),t.exportFunction(u+"_square"),t.exportFunction(u+"_squareOld"),t.exportFunction(u+"_fromMontgomery"),t.exportFunction(u+"_toMontgomery"),t.exportFunction(u+"_inverse"),t.exportFunction(u+"_one"),t.exportFunction(u+"_load"),t.exportFunction(u+"_timesScalar"),fc(t,u+"_exp",I,u+"_mul",u+"_square",l+"_copy",u+"_one"),t.exportFunction(u+"_exp"),t.exportFunction(u+"_batchInverse"),Qa(s)&&(L(),i(),t.exportFunction(u+"_sqrt"),t.exportFunction(u+"_isSquare")),t.exportFunction(u+"_batchToMontgomery"),t.exportFunction(u+"_batchFromMontgomery"),u};const yc=vo,{bitLength:Ic}=Kt;var Ma=function(t,n,o,a,s){const f=BigInt(n),g=Math.floor((Ic(f-1n)-1)/64)+1,I=g*8,u=o||"f1";if(t.modules[u])return u;t.modules[u]={n64:g};const l=s||"int",E=yc(t,f,a,l),F=t.modules[E].pR2,A=t.modules[E].pq,k=t.modules[E].pePlusOne;function D(){const st=t.alloc(I),U=t.addFunction(u+"_mul");U.addParam("x","i32"),U.addParam("y","i32"),U.addParam("r","i32");const lt=U.getCodeBuilder();U.addCode(lt.call(E+"_mul",lt.getLocal("x"),lt.getLocal("y"),lt.i32_const(st))),U.addCode(lt.call(E+"_mul",lt.i32_const(st),lt.i32_const(F),lt.getLocal("r")))}function B(){const st=t.addFunction(u+"_square");st.addParam("x","i32"),st.addParam("r","i32");const U=st.getCodeBuilder();st.addCode(U.call(u+"_mul",U.getLocal("x"),U.getLocal("x"),U.getLocal("r")))}function G(){const st=t.addFunction(u+"_inverse");st.addParam("x","i32"),st.addParam("r","i32");const U=st.getCodeBuilder();st.addCode(U.call(l+"_inverseMod",U.getLocal("x"),U.i32_const(A),U.getLocal("r")))}function S(){const st=t.addFunction(u+"_isNegative");st.addParam("x","i32"),st.setReturnType("i32");const U=st.getCodeBuilder();st.addCode(U.call(l+"_gte",U.getLocal("x"),U.i32_const(k)))}return D(),B(),G(),S(),t.exportFunction(E+"_add",u+"_add"),t.exportFunction(E+"_sub",u+"_sub"),t.exportFunction(E+"_neg",u+"_neg"),t.exportFunction(u+"_mul"),t.exportFunction(u+"_square"),t.exportFunction(u+"_inverse"),t.exportFunction(u+"_isNegative"),t.exportFunction(E+"_copy",u+"_copy"),t.exportFunction(E+"_zero",u+"_zero"),t.exportFunction(E+"_one",u+"_one"),t.exportFunction(E+"_isZero",u+"_isZero"),t.exportFunction(E+"_eq",u+"_eq"),u};const Cc=Co,mc=mo,xo=_n;var qa=function(t,n,o,a){if(t.modules[o])return o;const s=t.modules[a].n64*8,f=t.modules[a].q;t.modules[o]={n64:t.modules[a].n64*2};function g(){const O=t.addFunction(o+"_add");O.addParam("x","i32"),O.addParam("y","i32"),O.addParam("r","i32");const b=O.getCodeBuilder(),x=b.getLocal("x"),z=b.i32_add(b.getLocal("x"),b.i32_const(s)),ot=b.getLocal("y"),tt=b.i32_add(b.getLocal("y"),b.i32_const(s)),K=b.getLocal("r"),it=b.i32_add(b.getLocal("r"),b.i32_const(s));O.addCode(b.call(a+"_add",x,ot,K),b.call(a+"_add",z,tt,it))}function I(){const O=t.addFunction(o+"_timesScalar");O.addParam("x","i32"),O.addParam("scalar","i32"),O.addParam("scalarLen","i32"),O.addParam("r","i32");const b=O.getCodeBuilder(),x=b.getLocal("x"),z=b.i32_add(b.getLocal("x"),b.i32_const(s)),ot=b.getLocal("r"),tt=b.i32_add(b.getLocal("r"),b.i32_const(s));O.addCode(b.call(a+"_timesScalar",x,b.getLocal("scalar"),b.getLocal("scalarLen"),ot),b.call(a+"_timesScalar",z,b.getLocal("scalar"),b.getLocal("scalarLen"),tt))}function u(){const O=t.addFunction(o+"_sub");O.addParam("x","i32"),O.addParam("y","i32"),O.addParam("r","i32");const b=O.getCodeBuilder(),x=b.getLocal("x"),z=b.i32_add(b.getLocal("x"),b.i32_const(s)),ot=b.getLocal("y"),tt=b.i32_add(b.getLocal("y"),b.i32_const(s)),K=b.getLocal("r"),it=b.i32_add(b.getLocal("r"),b.i32_const(s));O.addCode(b.call(a+"_sub",x,ot,K),b.call(a+"_sub",z,tt,it))}function l(){const O=t.addFunction(o+"_neg");O.addParam("x","i32"),O.addParam("r","i32");const b=O.getCodeBuilder(),x=b.getLocal("x"),z=b.i32_add(b.getLocal("x"),b.i32_const(s)),ot=b.getLocal("r"),tt=b.i32_add(b.getLocal("r"),b.i32_const(s));O.addCode(b.call(a+"_neg",x,ot),b.call(a+"_neg",z,tt))}function E(){const O=t.addFunction(o+"_conjugate");O.addParam("x","i32"),O.addParam("r","i32");const b=O.getCodeBuilder(),x=b.getLocal("x"),z=b.i32_add(b.getLocal("x"),b.i32_const(s)),ot=b.getLocal("r"),tt=b.i32_add(b.getLocal("r"),b.i32_const(s));O.addCode(b.call(a+"_copy",x,ot),b.call(a+"_neg",z,tt))}function F(){const O=t.addFunction(o+"_isNegative");O.addParam("x","i32"),O.setReturnType("i32");const b=O.getCodeBuilder(),x=b.getLocal("x"),z=b.i32_add(b.getLocal("x"),b.i32_const(s));O.addCode(b.if(b.call(a+"_isZero",z),b.ret(b.call(a+"_isNegative",x))),b.ret(b.call(a+"_isNegative",z)))}function A(){const O=t.addFunction(o+"_mul");O.addParam("x","i32"),O.addParam("y","i32"),O.addParam("r","i32");const b=O.getCodeBuilder(),x=b.getLocal("x"),z=b.i32_add(b.getLocal("x"),b.i32_const(s)),ot=b.getLocal("y"),tt=b.i32_add(b.getLocal("y"),b.i32_const(s)),K=b.getLocal("r"),it=b.i32_add(b.getLocal("r"),b.i32_const(s)),J=b.i32_const(t.alloc(s)),et=b.i32_const(t.alloc(s)),pt=b.i32_const(t.alloc(s)),wt=b.i32_const(t.alloc(s));O.addCode(b.call(a+"_mul",x,ot,J),b.call(a+"_mul",z,tt,et),b.call(a+"_add",x,z,pt),b.call(a+"_add",ot,tt,wt),b.call(a+"_mul",pt,wt,pt),b.call(n,et,K),b.call(a+"_add",J,K,K),b.call(a+"_add",J,et,it),b.call(a+"_sub",pt,it,it))}function k(){const O=t.addFunction(o+"_mul1");O.addParam("x","i32"),O.addParam("y","i32"),O.addParam("r","i32");const b=O.getCodeBuilder(),x=b.getLocal("x"),z=b.i32_add(b.getLocal("x"),b.i32_const(s)),ot=b.getLocal("y"),tt=b.getLocal("r"),K=b.i32_add(b.getLocal("r"),b.i32_const(s));O.addCode(b.call(a+"_mul",x,ot,tt),b.call(a+"_mul",z,ot,K))}function D(){const O=t.addFunction(o+"_square");O.addParam("x","i32"),O.addParam("r","i32");const b=O.getCodeBuilder(),x=b.getLocal("x"),z=b.i32_add(b.getLocal("x"),b.i32_const(s)),ot=b.getLocal("r"),tt=b.i32_add(b.getLocal("r"),b.i32_const(s)),K=b.i32_const(t.alloc(s)),it=b.i32_const(t.alloc(s)),J=b.i32_const(t.alloc(s)),et=b.i32_const(t.alloc(s));O.addCode(b.call(a+"_mul",x,z,K),b.call(a+"_add",x,z,it),b.call(n,z,J),b.call(a+"_add",x,J,J),b.call(n,K,et),b.call(a+"_add",et,K,et),b.call(a+"_mul",it,J,ot),b.call(a+"_sub",ot,et,ot),b.call(a+"_add",K,K,tt))}function B(){const O=t.addFunction(o+"_toMontgomery");O.addParam("x","i32"),O.addParam("r","i32");const b=O.getCodeBuilder(),x=b.getLocal("x"),z=b.i32_add(b.getLocal("x"),b.i32_const(s)),ot=b.getLocal("r"),tt=b.i32_add(b.getLocal("r"),b.i32_const(s));O.addCode(b.call(a+"_toMontgomery",x,ot),b.call(a+"_toMontgomery",z,tt))}function G(){const O=t.addFunction(o+"_fromMontgomery");O.addParam("x","i32"),O.addParam("r","i32");const b=O.getCodeBuilder(),x=b.getLocal("x"),z=b.i32_add(b.getLocal("x"),b.i32_const(s)),ot=b.getLocal("r"),tt=b.i32_add(b.getLocal("r"),b.i32_const(s));O.addCode(b.call(a+"_fromMontgomery",x,ot),b.call(a+"_fromMontgomery",z,tt))}function S(){const O=t.addFunction(o+"_copy");O.addParam("x","i32"),O.addParam("r","i32");const b=O.getCodeBuilder(),x=b.getLocal("x"),z=b.i32_add(b.getLocal("x"),b.i32_const(s)),ot=b.getLocal("r"),tt=b.i32_add(b.getLocal("r"),b.i32_const(s));O.addCode(b.call(a+"_copy",x,ot),b.call(a+"_copy",z,tt))}function st(){const O=t.addFunction(o+"_zero");O.addParam("x","i32");const b=O.getCodeBuilder(),x=b.getLocal("x"),z=b.i32_add(b.getLocal("x"),b.i32_const(s));O.addCode(b.call(a+"_zero",x),b.call(a+"_zero",z))}function U(){const O=t.addFunction(o+"_one");O.addParam("x","i32");const b=O.getCodeBuilder(),x=b.getLocal("x"),z=b.i32_add(b.getLocal("x"),b.i32_const(s));O.addCode(b.call(a+"_one",x),b.call(a+"_zero",z))}function lt(){const O=t.addFunction(o+"_eq");O.addParam("x","i32"),O.addParam("y","i32"),O.setReturnType("i32");const b=O.getCodeBuilder(),x=b.getLocal("x"),z=b.i32_add(b.getLocal("x"),b.i32_const(s)),ot=b.getLocal("y"),tt=b.i32_add(b.getLocal("y"),b.i32_const(s));O.addCode(b.i32_and(b.call(a+"_eq",x,ot),b.call(a+"_eq",z,tt)))}function w(){const O=t.addFunction(o+"_isZero");O.addParam("x","i32"),O.setReturnType("i32");const b=O.getCodeBuilder(),x=b.getLocal("x"),z=b.i32_add(b.getLocal("x"),b.i32_const(s));O.addCode(b.i32_and(b.call(a+"_isZero",x),b.call(a+"_isZero",z)))}function _(){const O=t.addFunction(o+"_inverse");O.addParam("x","i32"),O.addParam("r","i32");const b=O.getCodeBuilder(),x=b.getLocal("x"),z=b.i32_add(b.getLocal("x"),b.i32_const(s)),ot=b.getLocal("r"),tt=b.i32_add(b.getLocal("r"),b.i32_const(s)),K=b.i32_const(t.alloc(s)),it=b.i32_const(t.alloc(s)),J=b.i32_const(t.alloc(s)),et=b.i32_const(t.alloc(s));O.addCode(b.call(a+"_square",x,K),b.call(a+"_square",z,it),b.call(n,it,J),b.call(a+"_sub",K,J,J),b.call(a+"_inverse",J,et),b.call(a+"_mul",x,et,ot),b.call(a+"_mul",z,et,tt),b.call(a+"_neg",tt,tt))}function p(){const O=t.addFunction(o+"_sign");O.addParam("x","i32"),O.addLocal("s","i32"),O.setReturnType("i32");const b=O.getCodeBuilder(),x=b.getLocal("x"),z=b.i32_add(b.getLocal("x"),b.i32_const(s));O.addCode(b.setLocal("s",b.call(a+"_sign",z)),b.if(b.getLocal("s"),b.ret(b.getLocal("s"))),b.ret(b.call(a+"_sign",x)))}function V(){const O=t.addFunction(o+"_isOne");O.addParam("x","i32"),O.setReturnType("i32");const b=O.getCodeBuilder(),x=b.getLocal("x"),z=b.i32_add(b.getLocal("x"),b.i32_const(s));O.addCode(b.ret(b.i32_and(b.call(a+"_isOne",x),b.call(a+"_isZero",z))))}function j(){const O=t.addFunction(o+"_sqrt");O.addParam("a","i32"),O.addParam("pr","i32");const b=O.getCodeBuilder(),x=b.i32_const(t.alloc(xo.bigInt2BytesLE((BigInt(f||0)-3n)/4n,s))),z=b.i32_const(t.alloc(xo.bigInt2BytesLE((BigInt(f||0)-1n)/2n,s))),ot=b.getLocal("a"),tt=b.i32_const(t.alloc(s*2)),K=b.i32_const(t.alloc(s*2)),it=b.i32_const(t.alloc(s*2)),J=t.alloc(s*2),et=b.i32_const(J),pt=b.i32_const(J),wt=b.i32_const(J+s),ft=b.i32_const(t.alloc(s*2)),L=b.i32_const(t.alloc(s*2));O.addCode(b.call(o+"_one",et),b.call(o+"_neg",et,et),b.call(o+"_exp",ot,x,b.i32_const(s),tt),b.call(o+"_square",tt,K),b.call(o+"_mul",ot,K,K),b.call(o+"_conjugate",K,it),b.call(o+"_mul",it,K,it),b.if(b.call(o+"_eq",it,et),b.unreachable()),b.call(o+"_mul",tt,ot,ft),b.if(b.call(o+"_eq",K,et),[...b.call(a+"_zero",pt),...b.call(a+"_one",wt),...b.call(o+"_mul",et,ft,b.getLocal("pr"))],[...b.call(o+"_one",L),...b.call(o+"_add",L,K,L),...b.call(o+"_exp",L,z,b.i32_const(s),L),...b.call(o+"_mul",L,ft,b.getLocal("pr"))]))}function X(){const O=t.addFunction(o+"_isSquare");O.addParam("a","i32"),O.setReturnType("i32");const b=O.getCodeBuilder(),x=b.i32_const(t.alloc(xo.bigInt2BytesLE((BigInt(f||0)-3n)/4n,s))),z=b.getLocal("a"),ot=b.i32_const(t.alloc(s*2)),tt=b.i32_const(t.alloc(s*2)),K=b.i32_const(t.alloc(s*2)),it=t.alloc(s*2),J=b.i32_const(it);O.addCode(b.call(o+"_one",J),b.call(o+"_neg",J,J),b.call(o+"_exp",z,x,b.i32_const(s),ot),b.call(o+"_square",ot,tt),b.call(o+"_mul",z,tt,tt),b.call(o+"_conjugate",tt,K),b.call(o+"_mul",K,tt,K),b.if(b.call(o+"_eq",K,J),b.ret(b.i32_const(0))),b.ret(b.i32_const(1)))}return w(),V(),st(),U(),S(),A(),k(),D(),g(),u(),l(),E(),B(),G(),lt(),_(),I(),p(),F(),t.exportFunction(o+"_isZero"),t.exportFunction(o+"_isOne"),t.exportFunction(o+"_zero"),t.exportFunction(o+"_one"),t.exportFunction(o+"_copy"),t.exportFunction(o+"_mul"),t.exportFunction(o+"_mul1"),t.exportFunction(o+"_square"),t.exportFunction(o+"_add"),t.exportFunction(o+"_sub"),t.exportFunction(o+"_neg"),t.exportFunction(o+"_sign"),t.exportFunction(o+"_conjugate"),t.exportFunction(o+"_fromMontgomery"),t.exportFunction(o+"_toMontgomery"),t.exportFunction(o+"_eq"),t.exportFunction(o+"_inverse"),mc(t,o),Cc(t,o+"_exp",s*2,o+"_mul",o+"_square",o+"_copy",o+"_one"),j(),X(),t.exportFunction(o+"_exp"),t.exportFunction(o+"_timesScalar"),t.exportFunction(o+"_batchInverse"),t.exportFunction(o+"_sqrt"),t.exportFunction(o+"_isSquare"),t.exportFunction(o+"_isNegative"),o};const wc=Co,Bc=mo;var Ua=function(t,n,o,a){if(t.modules[o])return o;const s=t.modules[a].n64*8;t.modules[o]={n64:t.modules[a].n64*3};function f(){const _=t.addFunction(o+"_add");_.addParam("x","i32"),_.addParam("y","i32"),_.addParam("r","i32");const p=_.getCodeBuilder(),V=p.getLocal("x"),j=p.i32_add(p.getLocal("x"),p.i32_const(s)),X=p.i32_add(p.getLocal("x"),p.i32_const(2*s)),O=p.getLocal("y"),b=p.i32_add(p.getLocal("y"),p.i32_const(s)),x=p.i32_add(p.getLocal("y"),p.i32_const(2*s)),z=p.getLocal("r"),ot=p.i32_add(p.getLocal("r"),p.i32_const(s)),tt=p.i32_add(p.getLocal("r"),p.i32_const(2*s));_.addCode(p.call(a+"_add",V,O,z),p.call(a+"_add",j,b,ot),p.call(a+"_add",X,x,tt))}function g(){const _=t.addFunction(o+"_timesScalar");_.addParam("x","i32"),_.addParam("scalar","i32"),_.addParam("scalarLen","i32"),_.addParam("r","i32");const p=_.getCodeBuilder(),V=p.getLocal("x"),j=p.i32_add(p.getLocal("x"),p.i32_const(s)),X=p.i32_add(p.getLocal("x"),p.i32_const(2*s)),O=p.getLocal("r"),b=p.i32_add(p.getLocal("r"),p.i32_const(s)),x=p.i32_add(p.getLocal("r"),p.i32_const(2*s));_.addCode(p.call(a+"_timesScalar",V,p.getLocal("scalar"),p.getLocal("scalarLen"),O),p.call(a+"_timesScalar",j,p.getLocal("scalar"),p.getLocal("scalarLen"),b),p.call(a+"_timesScalar",X,p.getLocal("scalar"),p.getLocal("scalarLen"),x))}function I(){const _=t.addFunction(o+"_sub");_.addParam("x","i32"),_.addParam("y","i32"),_.addParam("r","i32");const p=_.getCodeBuilder(),V=p.getLocal("x"),j=p.i32_add(p.getLocal("x"),p.i32_const(s)),X=p.i32_add(p.getLocal("x"),p.i32_const(2*s)),O=p.getLocal("y"),b=p.i32_add(p.getLocal("y"),p.i32_const(s)),x=p.i32_add(p.getLocal("y"),p.i32_const(2*s)),z=p.getLocal("r"),ot=p.i32_add(p.getLocal("r"),p.i32_const(s)),tt=p.i32_add(p.getLocal("r"),p.i32_const(2*s));_.addCode(p.call(a+"_sub",V,O,z),p.call(a+"_sub",j,b,ot),p.call(a+"_sub",X,x,tt))}function u(){const _=t.addFunction(o+"_neg");_.addParam("x","i32"),_.addParam("r","i32");const p=_.getCodeBuilder(),V=p.getLocal("x"),j=p.i32_add(p.getLocal("x"),p.i32_const(s)),X=p.i32_add(p.getLocal("x"),p.i32_const(2*s)),O=p.getLocal("r"),b=p.i32_add(p.getLocal("r"),p.i32_const(s)),x=p.i32_add(p.getLocal("r"),p.i32_const(2*s));_.addCode(p.call(a+"_neg",V,O),p.call(a+"_neg",j,b),p.call(a+"_neg",X,x))}function l(){const _=t.addFunction(o+"_isNegative");_.addParam("x","i32"),_.setReturnType("i32");const p=_.getCodeBuilder(),V=p.getLocal("x"),j=p.i32_add(p.getLocal("x"),p.i32_const(s)),X=p.i32_add(p.getLocal("x"),p.i32_const(2*s));_.addCode(p.if(p.call(a+"_isZero",X),p.if(p.call(a+"_isZero",j),p.ret(p.call(a+"_isNegative",V)),p.ret(p.call(a+"_isNegative",j)))),p.ret(p.call(a+"_isNegative",X)))}function E(){const _=t.addFunction(o+"_mul");_.addParam("x","i32"),_.addParam("y","i32"),_.addParam("r","i32");const p=_.getCodeBuilder(),V=p.getLocal("x"),j=p.i32_add(p.getLocal("x"),p.i32_const(s)),X=p.i32_add(p.getLocal("x"),p.i32_const(2*s)),O=p.getLocal("y"),b=p.i32_add(p.getLocal("y"),p.i32_const(s)),x=p.i32_add(p.getLocal("y"),p.i32_const(2*s)),z=p.getLocal("r"),ot=p.i32_add(p.getLocal("r"),p.i32_const(s)),tt=p.i32_add(p.getLocal("r"),p.i32_const(2*s)),K=p.i32_const(t.alloc(s)),it=p.i32_const(t.alloc(s)),J=p.i32_const(t.alloc(s)),et=p.i32_const(t.alloc(s)),pt=p.i32_const(t.alloc(s)),wt=p.i32_const(t.alloc(s)),ft=p.i32_const(t.alloc(s)),L=p.i32_const(t.alloc(s)),i=p.i32_const(t.alloc(s)),C=p.i32_const(t.alloc(s)),c=p.i32_const(t.alloc(s)),m=p.i32_const(t.alloc(s)),y=p.i32_const(t.alloc(s));_.addCode(p.call(a+"_mul",V,O,K),p.call(a+"_mul",j,b,it),p.call(a+"_mul",X,x,J),p.call(a+"_add",V,j,et),p.call(a+"_add",O,b,pt),p.call(a+"_add",V,X,wt),p.call(a+"_add",O,x,ft),p.call(a+"_add",j,X,L),p.call(a+"_add",b,x,i),p.call(a+"_add",K,it,C),p.call(a+"_add",K,J,c),p.call(a+"_add",it,J,m),p.call(a+"_mul",L,i,z),p.call(a+"_sub",z,m,z),p.call(n,z,z),p.call(a+"_add",K,z,z),p.call(a+"_mul",et,pt,ot),p.call(a+"_sub",ot,C,ot),p.call(n,J,y),p.call(a+"_add",ot,y,ot),p.call(a+"_mul",wt,ft,tt),p.call(a+"_sub",tt,c,tt),p.call(a+"_add",tt,it,tt))}function F(){const _=t.addFunction(o+"_square");_.addParam("x","i32"),_.addParam("r","i32");const p=_.getCodeBuilder(),V=p.getLocal("x"),j=p.i32_add(p.getLocal("x"),p.i32_const(s)),X=p.i32_add(p.getLocal("x"),p.i32_const(2*s)),O=p.getLocal("r"),b=p.i32_add(p.getLocal("r"),p.i32_const(s)),x=p.i32_add(p.getLocal("r"),p.i32_const(2*s)),z=p.i32_const(t.alloc(s)),ot=p.i32_const(t.alloc(s)),tt=p.i32_const(t.alloc(s)),K=p.i32_const(t.alloc(s)),it=p.i32_const(t.alloc(s)),J=p.i32_const(t.alloc(s)),et=p.i32_const(t.alloc(s));_.addCode(p.call(a+"_square",V,z),p.call(a+"_mul",V,j,ot),p.call(a+"_add",ot,ot,tt),p.call(a+"_sub",V,j,K),p.call(a+"_add",K,X,K),p.call(a+"_square",K,K),p.call(a+"_mul",j,X,it),p.call(a+"_add",it,it,J),p.call(a+"_square",X,et),p.call(n,J,O),p.call(a+"_add",z,O,O),p.call(n,et,b),p.call(a+"_add",tt,b,b),p.call(a+"_add",z,et,x),p.call(a+"_sub",J,x,x),p.call(a+"_add",K,x,x),p.call(a+"_add",tt,x,x))}function A(){const _=t.addFunction(o+"_toMontgomery");_.addParam("x","i32"),_.addParam("r","i32");const p=_.getCodeBuilder(),V=p.getLocal("x"),j=p.i32_add(p.getLocal("x"),p.i32_const(s)),X=p.i32_add(p.getLocal("x"),p.i32_const(2*s)),O=p.getLocal("r"),b=p.i32_add(p.getLocal("r"),p.i32_const(s)),x=p.i32_add(p.getLocal("r"),p.i32_const(2*s));_.addCode(p.call(a+"_toMontgomery",V,O),p.call(a+"_toMontgomery",j,b),p.call(a+"_toMontgomery",X,x))}function k(){const _=t.addFunction(o+"_fromMontgomery");_.addParam("x","i32"),_.addParam("r","i32");const p=_.getCodeBuilder(),V=p.getLocal("x"),j=p.i32_add(p.getLocal("x"),p.i32_const(s)),X=p.i32_add(p.getLocal("x"),p.i32_const(2*s)),O=p.getLocal("r"),b=p.i32_add(p.getLocal("r"),p.i32_const(s)),x=p.i32_add(p.getLocal("r"),p.i32_const(2*s));_.addCode(p.call(a+"_fromMontgomery",V,O),p.call(a+"_fromMontgomery",j,b),p.call(a+"_fromMontgomery",X,x))}function D(){const _=t.addFunction(o+"_copy");_.addParam("x","i32"),_.addParam("r","i32");const p=_.getCodeBuilder(),V=p.getLocal("x"),j=p.i32_add(p.getLocal("x"),p.i32_const(s)),X=p.i32_add(p.getLocal("x"),p.i32_const(2*s)),O=p.getLocal("r"),b=p.i32_add(p.getLocal("r"),p.i32_const(s)),x=p.i32_add(p.getLocal("r"),p.i32_const(2*s));_.addCode(p.call(a+"_copy",V,O),p.call(a+"_copy",j,b),p.call(a+"_copy",X,x))}function B(){const _=t.addFunction(o+"_zero");_.addParam("x","i32");const p=_.getCodeBuilder(),V=p.getLocal("x"),j=p.i32_add(p.getLocal("x"),p.i32_const(s)),X=p.i32_add(p.getLocal("x"),p.i32_const(2*s));_.addCode(p.call(a+"_zero",V),p.call(a+"_zero",j),p.call(a+"_zero",X))}function G(){const _=t.addFunction(o+"_one");_.addParam("x","i32");const p=_.getCodeBuilder(),V=p.getLocal("x"),j=p.i32_add(p.getLocal("x"),p.i32_const(s)),X=p.i32_add(p.getLocal("x"),p.i32_const(2*s));_.addCode(p.call(a+"_one",V),p.call(a+"_zero",j),p.call(a+"_zero",X))}function S(){const _=t.addFunction(o+"_eq");_.addParam("x","i32"),_.addParam("y","i32"),_.setReturnType("i32");const p=_.getCodeBuilder(),V=p.getLocal("x"),j=p.i32_add(p.getLocal("x"),p.i32_const(s)),X=p.i32_add(p.getLocal("x"),p.i32_const(2*s)),O=p.getLocal("y"),b=p.i32_add(p.getLocal("y"),p.i32_const(s)),x=p.i32_add(p.getLocal("y"),p.i32_const(2*s));_.addCode(p.i32_and(p.i32_and(p.call(a+"_eq",V,O),p.call(a+"_eq",j,b)),p.call(a+"_eq",X,x)))}function st(){const _=t.addFunction(o+"_isZero");_.addParam("x","i32"),_.setReturnType("i32");const p=_.getCodeBuilder(),V=p.getLocal("x"),j=p.i32_add(p.getLocal("x"),p.i32_const(s)),X=p.i32_add(p.getLocal("x"),p.i32_const(2*s));_.addCode(p.i32_and(p.i32_and(p.call(a+"_isZero",V),p.call(a+"_isZero",j)),p.call(a+"_isZero",X)))}function U(){const _=t.addFunction(o+"_inverse");_.addParam("x","i32"),_.addParam("r","i32");const p=_.getCodeBuilder(),V=p.getLocal("x"),j=p.i32_add(p.getLocal("x"),p.i32_const(s)),X=p.i32_add(p.getLocal("x"),p.i32_const(2*s)),O=p.getLocal("r"),b=p.i32_add(p.getLocal("r"),p.i32_const(s)),x=p.i32_add(p.getLocal("r"),p.i32_const(2*s)),z=p.i32_const(t.alloc(s)),ot=p.i32_const(t.alloc(s)),tt=p.i32_const(t.alloc(s)),K=p.i32_const(t.alloc(s)),it=p.i32_const(t.alloc(s)),J=p.i32_const(t.alloc(s)),et=p.i32_const(t.alloc(s)),pt=p.i32_const(t.alloc(s)),wt=p.i32_const(t.alloc(s)),ft=p.i32_const(t.alloc(s)),L=p.i32_const(t.alloc(s));_.addCode(p.call(a+"_square",V,z),p.call(a+"_square",j,ot),p.call(a+"_square",X,tt),p.call(a+"_mul",V,j,K),p.call(a+"_mul",V,X,it),p.call(a+"_mul",j,X,J),p.call(n,J,et),p.call(a+"_sub",z,et,et),p.call(n,tt,pt),p.call(a+"_sub",pt,K,pt),p.call(a+"_sub",ot,it,wt),p.call(a+"_mul",X,pt,ft),p.call(a+"_mul",j,wt,L),p.call(a+"_add",ft,L,ft),p.call(n,ft,ft),p.call(a+"_mul",V,et,L),p.call(a+"_add",L,ft,ft),p.call(a+"_inverse",ft,ft),p.call(a+"_mul",ft,et,O),p.call(a+"_mul",ft,pt,b),p.call(a+"_mul",ft,wt,x))}function lt(){const _=t.addFunction(o+"_sign");_.addParam("x","i32"),_.addLocal("s","i32"),_.setReturnType("i32");const p=_.getCodeBuilder(),V=p.getLocal("x"),j=p.i32_add(p.getLocal("x"),p.i32_const(s)),X=p.i32_add(p.getLocal("x"),p.i32_const(2*s));_.addCode(p.setLocal("s",p.call(a+"_sign",X)),p.if(p.getLocal("s"),p.ret(p.getLocal("s"))),p.setLocal("s",p.call(a+"_sign",j)),p.if(p.getLocal("s"),p.ret(p.getLocal("s"))),p.ret(p.call(a+"_sign",V)))}function w(){const _=t.addFunction(o+"_isOne");_.addParam("x","i32"),_.setReturnType("i32");const p=_.getCodeBuilder(),V=p.getLocal("x"),j=p.i32_add(p.getLocal("x"),p.i32_const(s)),X=p.i32_add(p.getLocal("x"),p.i32_const(s*2));_.addCode(p.ret(p.i32_and(p.i32_and(p.call(a+"_isOne",V),p.call(a+"_isZero",j)),p.call(a+"_isZero",X))))}return st(),w(),B(),G(),D(),E(),F(),f(),I(),u(),lt(),A(),k(),S(),U(),g(),l(),t.exportFunction(o+"_isZero"),t.exportFunction(o+"_isOne"),t.exportFunction(o+"_zero"),t.exportFunction(o+"_one"),t.exportFunction(o+"_copy"),t.exportFunction(o+"_mul"),t.exportFunction(o+"_square"),t.exportFunction(o+"_add"),t.exportFunction(o+"_sub"),t.exportFunction(o+"_neg"),t.exportFunction(o+"_sign"),t.exportFunction(o+"_fromMontgomery"),t.exportFunction(o+"_toMontgomery"),t.exportFunction(o+"_eq"),t.exportFunction(o+"_inverse"),Bc(t,o),wc(t,o+"_exp",s*3,o+"_mul",o+"_square",o+"_copy",o+"_one"),t.exportFunction(o+"_exp"),t.exportFunction(o+"_timesScalar"),t.exportFunction(o+"_batchInverse"),t.exportFunction(o+"_isNegative"),o},Ec=function(t,n,o,a,s,f,g,I){const u=t.addFunction(n);u.addParam("base","i32"),u.addParam("scalar","i32"),u.addParam("scalarLength","i32"),u.addParam("r","i32"),u.addLocal("old0","i32"),u.addLocal("nbits","i32"),u.addLocal("i","i32"),u.addLocal("last","i32"),u.addLocal("cur","i32"),u.addLocal("carry","i32"),u.addLocal("p","i32");const l=u.getCodeBuilder(),E=l.i32_const(t.alloc(o));function F(k){return l.i32_and(l.i32_shr_u(l.i32_load(l.i32_add(l.getLocal("scalar"),l.i32_and(l.i32_shr_u(k,l.i32_const(3)),l.i32_const(4294967292)))),l.i32_and(k,l.i32_const(31))),l.i32_const(1))}function A(k){return[...l.i32_store8(l.getLocal("p"),l.i32_const(k)),...l.setLocal("p",l.i32_add(l.getLocal("p"),l.i32_const(1)))]}u.addCode(l.if(l.i32_eqz(l.getLocal("scalarLength")),[...l.call(I,l.getLocal("r")),...l.ret([])]),l.setLocal("nbits",l.i32_shl(l.getLocal("scalarLength"),l.i32_const(3))),l.setLocal("old0",l.i32_load(l.i32_const(0))),l.setLocal("p",l.getLocal("old0")),l.i32_store(l.i32_const(0),l.i32_and(l.i32_add(l.i32_add(l.getLocal("old0"),l.i32_const(32)),l.getLocal("nbits")),l.i32_const(4294967288))),l.setLocal("i",l.i32_const(1)),l.setLocal("last",F(l.i32_const(0))),l.setLocal("carry",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("nbits"))),l.setLocal("cur",F(l.getLocal("i"))),l.if(l.getLocal("last"),l.if(l.getLocal("cur"),l.if(l.getLocal("carry"),[...l.setLocal("last",l.i32_const(0)),...l.setLocal("carry",l.i32_const(1)),...A(1)],[...l.setLocal("last",l.i32_const(0)),...l.setLocal("carry",l.i32_const(1)),...A(255)]),l.if(l.getLocal("carry"),[...l.setLocal("last",l.i32_const(0)),...l.setLocal("carry",l.i32_const(1)),...A(255)],[...l.setLocal("last",l.i32_const(0)),...l.setLocal("carry",l.i32_const(0)),...A(1)])),l.if(l.getLocal("cur"),l.if(l.getLocal("carry"),[...l.setLocal("last",l.i32_const(0)),...l.setLocal("carry",l.i32_const(1)),...A(0)],[...l.setLocal("last",l.i32_const(1)),...l.setLocal("carry",l.i32_const(0)),...A(0)]),l.if(l.getLocal("carry"),[...l.setLocal("last",l.i32_const(1)),...l.setLocal("carry",l.i32_const(0)),...A(0)],[...l.setLocal("last",l.i32_const(0)),...l.setLocal("carry",l.i32_const(0)),...A(0)]))),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0))),l.if(l.getLocal("last"),l.if(l.getLocal("carry"),[...A(255),...A(0),...A(1)],[...A(1)]),l.if(l.getLocal("carry"),[...A(0),...A(1)])),l.setLocal("p",l.i32_sub(l.getLocal("p"),l.i32_const(1))),l.call(g,l.getLocal("base"),E),l.call(I,l.getLocal("r")),l.block(l.loop(l.call(s,l.getLocal("r"),l.getLocal("r")),l.setLocal("cur",l.i32_load8_u(l.getLocal("p"))),l.if(l.getLocal("cur"),l.if(l.i32_eq(l.getLocal("cur"),l.i32_const(1)),l.call(a,l.getLocal("r"),E,l.getLocal("r")),l.call(f,l.getLocal("r"),E,l.getLocal("r")))),l.br_if(1,l.i32_eq(l.getLocal("old0"),l.getLocal("p"))),l.setLocal("p",l.i32_sub(l.getLocal("p"),l.i32_const(1))),l.br(0))),l.i32_store(l.i32_const(0),l.getLocal("old0")))},Fc=function(t,n,o,a,s){const g=t.modules[n].n64*8;function I(){const F=t.addFunction(o+"_getChunk");F.addParam("pScalar","i32"),F.addParam("scalarSize","i32"),F.addParam("startBit","i32"),F.addParam("chunkSize","i32"),F.addLocal("bitsToEnd","i32"),F.addLocal("mask","i32"),F.setReturnType("i32");const A=F.getCodeBuilder();F.addCode(A.setLocal("bitsToEnd",A.i32_sub(A.i32_mul(A.getLocal("scalarSize"),A.i32_const(8)),A.getLocal("startBit"))),A.if(A.i32_gt_s(A.getLocal("chunkSize"),A.getLocal("bitsToEnd")),A.setLocal("mask",A.i32_sub(A.i32_shl(A.i32_const(1),A.getLocal("bitsToEnd")),A.i32_const(1))),A.setLocal("mask",A.i32_sub(A.i32_shl(A.i32_const(1),A.getLocal("chunkSize")),A.i32_const(1)))),A.i32_and(A.i32_shr_u(A.i32_load(A.i32_add(A.getLocal("pScalar"),A.i32_shr_u(A.getLocal("startBit"),A.i32_const(3))),0,0),A.i32_and(A.getLocal("startBit"),A.i32_const(7))),A.getLocal("mask")))}function u(){const F=t.addFunction(o+"_chunk");F.addParam("pBases","i32"),F.addParam("pScalars","i32"),F.addParam("scalarSize","i32"),F.addParam("n","i32"),F.addParam("startBit","i32"),F.addParam("chunkSize","i32"),F.addParam("pr","i32"),F.addLocal("nChunks","i32"),F.addLocal("itScalar","i32"),F.addLocal("endScalar","i32"),F.addLocal("itBase","i32"),F.addLocal("i","i32"),F.addLocal("j","i32"),F.addLocal("nTable","i32"),F.addLocal("pTable","i32"),F.addLocal("idx","i32"),F.addLocal("pIdxTable","i32");const A=F.getCodeBuilder();F.addCode(A.if(A.i32_eqz(A.getLocal("n")),[...A.call(n+"_zero",A.getLocal("pr")),...A.ret([])]),A.setLocal("nTable",A.i32_shl(A.i32_const(1),A.getLocal("chunkSize"))),A.setLocal("pTable",A.i32_load(A.i32_const(0))),A.i32_store(A.i32_const(0),A.i32_add(A.getLocal("pTable"),A.i32_mul(A.getLocal("nTable"),A.i32_const(g)))),A.setLocal("j",A.i32_const(0)),A.block(A.loop(A.br_if(1,A.i32_eq(A.getLocal("j"),A.getLocal("nTable"))),A.call(n+"_zero",A.i32_add(A.getLocal("pTable"),A.i32_mul(A.getLocal("j"),A.i32_const(g)))),A.setLocal("j",A.i32_add(A.getLocal("j"),A.i32_const(1))),A.br(0))),A.setLocal("itBase",A.getLocal("pBases")),A.setLocal("itScalar",A.getLocal("pScalars")),A.setLocal("endScalar",A.i32_add(A.getLocal("pScalars"),A.i32_mul(A.getLocal("n"),A.getLocal("scalarSize")))),A.block(A.loop(A.br_if(1,A.i32_eq(A.getLocal("itScalar"),A.getLocal("endScalar"))),A.setLocal("idx",A.call(o+"_getChunk",A.getLocal("itScalar"),A.getLocal("scalarSize"),A.getLocal("startBit"),A.getLocal("chunkSize"))),A.if(A.getLocal("idx"),[...A.setLocal("pIdxTable",A.i32_add(A.getLocal("pTable"),A.i32_mul(A.i32_sub(A.getLocal("idx"),A.i32_const(1)),A.i32_const(g)))),...A.call(a,A.getLocal("pIdxTable"),A.getLocal("itBase"),A.getLocal("pIdxTable"))]),A.setLocal("itScalar",A.i32_add(A.getLocal("itScalar"),A.getLocal("scalarSize"))),A.setLocal("itBase",A.i32_add(A.getLocal("itBase"),A.i32_const(s))),A.br(0))),A.call(o+"_reduceTable",A.getLocal("pTable"),A.getLocal("chunkSize")),A.call(n+"_copy",A.getLocal("pTable"),A.getLocal("pr")),A.i32_store(A.i32_const(0),A.getLocal("pTable")))}function l(){const F=t.addFunction(o);F.addParam("pBases","i32"),F.addParam("pScalars","i32"),F.addParam("scalarSize","i32"),F.addParam("n","i32"),F.addParam("pr","i32"),F.addLocal("chunkSize","i32"),F.addLocal("nChunks","i32"),F.addLocal("itScalar","i32"),F.addLocal("endScalar","i32"),F.addLocal("itBase","i32"),F.addLocal("itBit","i32"),F.addLocal("i","i32"),F.addLocal("j","i32"),F.addLocal("nTable","i32"),F.addLocal("pTable","i32"),F.addLocal("idx","i32"),F.addLocal("pIdxTable","i32");const A=F.getCodeBuilder(),k=A.i32_const(t.alloc(g)),D=t.alloc([17,17,17,17,17,17,17,17,17,17,16,16,15,14,13,13,12,11,10,9,8,7,7,6,5,4,3,2,1,1,1,1]);F.addCode(A.call(n+"_zero",A.getLocal("pr")),A.if(A.i32_eqz(A.getLocal("n")),A.ret([])),A.setLocal("chunkSize",A.i32_load8_u(A.i32_clz(A.getLocal("n")),D)),A.setLocal("nChunks",A.i32_add(A.i32_div_u(A.i32_sub(A.i32_shl(A.getLocal("scalarSize"),A.i32_const(3)),A.i32_const(1)),A.getLocal("chunkSize")),A.i32_const(1))),A.setLocal("itBit",A.i32_mul(A.i32_sub(A.getLocal("nChunks"),A.i32_const(1)),A.getLocal("chunkSize"))),A.block(A.loop(A.br_if(1,A.i32_lt_s(A.getLocal("itBit"),A.i32_const(0))),A.if(A.i32_eqz(A.call(n+"_isZero",A.getLocal("pr"))),[...A.setLocal("j",A.i32_const(0)),...A.block(A.loop(A.br_if(1,A.i32_eq(A.getLocal("j"),A.getLocal("chunkSize"))),A.call(n+"_double",A.getLocal("pr"),A.getLocal("pr")),A.setLocal("j",A.i32_add(A.getLocal("j"),A.i32_const(1))),A.br(0)))]),A.call(o+"_chunk",A.getLocal("pBases"),A.getLocal("pScalars"),A.getLocal("scalarSize"),A.getLocal("n"),A.getLocal("itBit"),A.getLocal("chunkSize"),k),A.call(n+"_add",A.getLocal("pr"),k,A.getLocal("pr")),A.setLocal("itBit",A.i32_sub(A.getLocal("itBit"),A.getLocal("chunkSize"))),A.br(0))))}function E(){const F=t.addFunction(o+"_reduceTable");F.addParam("pTable","i32"),F.addParam("p","i32"),F.addLocal("half","i32"),F.addLocal("it1","i32"),F.addLocal("it2","i32"),F.addLocal("pAcc","i32");const A=F.getCodeBuilder();F.addCode(A.if(A.i32_eq(A.getLocal("p"),A.i32_const(1)),A.ret([])),A.setLocal("half",A.i32_shl(A.i32_const(1),A.i32_sub(A.getLocal("p"),A.i32_const(1)))),A.setLocal("it1",A.getLocal("pTable")),A.setLocal("it2",A.i32_add(A.getLocal("pTable"),A.i32_mul(A.getLocal("half"),A.i32_const(g)))),A.setLocal("pAcc",A.i32_sub(A.getLocal("it2"),A.i32_const(g))),A.block(A.loop(A.br_if(1,A.i32_eq(A.getLocal("it1"),A.getLocal("pAcc"))),A.call(n+"_add",A.getLocal("it1"),A.getLocal("it2"),A.getLocal("it1")),A.call(n+"_add",A.getLocal("pAcc"),A.getLocal("it2"),A.getLocal("pAcc")),A.setLocal("it1",A.i32_add(A.getLocal("it1"),A.i32_const(g))),A.setLocal("it2",A.i32_add(A.getLocal("it2"),A.i32_const(g))),A.br(0))),A.call(o+"_reduceTable",A.getLocal("pTable"),A.i32_sub(A.getLocal("p"),A.i32_const(1))),A.setLocal("p",A.i32_sub(A.getLocal("p"),A.i32_const(1))),A.block(A.loop(A.br_if(1,A.i32_eqz(A.getLocal("p"))),A.call(n+"_double",A.getLocal("pAcc"),A.getLocal("pAcc")),A.setLocal("p",A.i32_sub(A.getLocal("p"),A.i32_const(1))),A.br(0))),A.call(n+"_add",A.getLocal("pTable"),A.getLocal("pAcc"),A.getLocal("pTable")))}I(),E(),u(),l(),t.exportFunction(o),t.exportFunction(o+"_chunk")};const za=Ec,Dn=wa,ka=Fc;var Da=function(t,n,o,a){const s=t.modules[o].n64,f=s*8;if(t.modules[n])return n;t.modules[n]={n64:s*3};function g(){const L=t.addFunction(n+"_isZero");L.addParam("p1","i32"),L.setReturnType("i32");const i=L.getCodeBuilder();L.addCode(i.call(o+"_isZero",i.i32_add(i.getLocal("p1"),i.i32_const(f*2))))}function I(){const L=t.addFunction(n+"_isZeroAffine");L.addParam("p1","i32"),L.setReturnType("i32");const i=L.getCodeBuilder();L.addCode(i.i32_and(i.call(o+"_isZero",i.getLocal("p1")),i.call(o+"_isZero",i.i32_add(i.getLocal("p1"),i.i32_const(f)))))}function u(){const L=t.addFunction(n+"_copy");L.addParam("ps","i32"),L.addParam("pd","i32");const i=L.getCodeBuilder();for(let C=0;C<s*3;C++)L.addCode(i.i64_store(i.getLocal("pd"),C*8,i.i64_load(i.getLocal("ps"),C*8)))}function l(){const L=t.addFunction(n+"_copyAffine");L.addParam("ps","i32"),L.addParam("pd","i32");const i=L.getCodeBuilder();for(let C=0;C<s*2;C++)L.addCode(i.i64_store(i.getLocal("pd"),C*8,i.i64_load(i.getLocal("ps"),C*8)))}function E(){const L=t.addFunction(n+"_zero");L.addParam("pr","i32");const i=L.getCodeBuilder();L.addCode(i.call(o+"_zero",i.getLocal("pr"))),L.addCode(i.call(o+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(f)))),L.addCode(i.call(o+"_zero",i.i32_add(i.getLocal("pr"),i.i32_const(f*2))))}function F(){const L=t.addFunction(n+"_zeroAffine");L.addParam("pr","i32");const i=L.getCodeBuilder();L.addCode(i.call(o+"_zero",i.getLocal("pr"))),L.addCode(i.call(o+"_zero",i.i32_add(i.getLocal("pr"),i.i32_const(f))))}function A(){const L=t.addFunction(n+"_eq");L.addParam("p1","i32"),L.addParam("p2","i32"),L.setReturnType("i32"),L.addLocal("z1","i32"),L.addLocal("z2","i32");const i=L.getCodeBuilder(),C=i.getLocal("p1"),c=i.i32_add(i.getLocal("p1"),i.i32_const(f));L.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(f*2))));const m=i.getLocal("z1"),y=i.getLocal("p2"),h=i.i32_add(i.getLocal("p2"),i.i32_const(f));L.addCode(i.setLocal("z2",i.i32_add(i.getLocal("p2"),i.i32_const(f*2))));const v=i.getLocal("z2"),W=i.i32_const(t.alloc(f)),R=i.i32_const(t.alloc(f)),at=i.i32_const(t.alloc(f)),yt=i.i32_const(t.alloc(f)),dt=i.i32_const(t.alloc(f)),Lt=i.i32_const(t.alloc(f)),St=i.i32_const(t.alloc(f)),gt=i.i32_const(t.alloc(f));L.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),i.ret(i.call(n+"_isZero",i.getLocal("p2")))),i.if(i.call(n+"_isZero",i.getLocal("p2")),i.ret(i.i32_const(0))),i.if(i.call(o+"_isOne",m),i.ret(i.call(n+"_eqMixed",i.getLocal("p2"),i.getLocal("p1")))),i.if(i.call(o+"_isOne",v),i.ret(i.call(n+"_eqMixed",i.getLocal("p1"),i.getLocal("p2")))),i.call(o+"_square",m,W),i.call(o+"_square",v,R),i.call(o+"_mul",C,R,at),i.call(o+"_mul",y,W,yt),i.call(o+"_mul",m,W,dt),i.call(o+"_mul",v,R,Lt),i.call(o+"_mul",c,Lt,St),i.call(o+"_mul",h,dt,gt),i.if(i.call(o+"_eq",at,yt),i.if(i.call(o+"_eq",St,gt),i.ret(i.i32_const(1)))),i.ret(i.i32_const(0)))}function k(){const L=t.addFunction(n+"_eqMixed");L.addParam("p1","i32"),L.addParam("p2","i32"),L.setReturnType("i32"),L.addLocal("z1","i32");const i=L.getCodeBuilder(),C=i.getLocal("p1"),c=i.i32_add(i.getLocal("p1"),i.i32_const(f));L.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(f*2))));const m=i.getLocal("z1"),y=i.getLocal("p2"),h=i.i32_add(i.getLocal("p2"),i.i32_const(f)),v=i.i32_const(t.alloc(f)),W=i.i32_const(t.alloc(f)),R=i.i32_const(t.alloc(f)),at=i.i32_const(t.alloc(f));L.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),i.ret(i.call(n+"_isZeroAffine",i.getLocal("p2")))),i.if(i.call(n+"_isZeroAffine",i.getLocal("p2")),i.ret(i.i32_const(0))),i.if(i.call(o+"_isOne",m),i.ret(i.call(n+"_eqAffine",i.getLocal("p1"),i.getLocal("p2")))),i.call(o+"_square",m,v),i.call(o+"_mul",y,v,W),i.call(o+"_mul",m,v,R),i.call(o+"_mul",h,R,at),i.if(i.call(o+"_eq",C,W),i.if(i.call(o+"_eq",c,at),i.ret(i.i32_const(1)))),i.ret(i.i32_const(0)))}function D(){const L=t.addFunction(n+"_double");L.addParam("p1","i32"),L.addParam("pr","i32");const i=L.getCodeBuilder(),C=i.getLocal("p1"),c=i.i32_add(i.getLocal("p1"),i.i32_const(f)),m=i.i32_add(i.getLocal("p1"),i.i32_const(f*2)),y=i.getLocal("pr"),h=i.i32_add(i.getLocal("pr"),i.i32_const(f)),v=i.i32_add(i.getLocal("pr"),i.i32_const(f*2)),W=i.i32_const(t.alloc(f)),R=i.i32_const(t.alloc(f)),at=i.i32_const(t.alloc(f)),yt=i.i32_const(t.alloc(f)),dt=i.i32_const(t.alloc(f)),Lt=i.i32_const(t.alloc(f)),St=i.i32_const(t.alloc(f)),gt=i.i32_const(t.alloc(f));L.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),[...i.call(n+"_copy",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(o+"_isOne",m),[...i.ret(i.call(n+"_doubleAffine",i.getLocal("p1"),i.getLocal("pr"))),...i.ret([])]),i.call(o+"_square",C,W),i.call(o+"_square",c,R),i.call(o+"_square",R,at),i.call(o+"_add",C,R,yt),i.call(o+"_square",yt,yt),i.call(o+"_sub",yt,W,yt),i.call(o+"_sub",yt,at,yt),i.call(o+"_add",yt,yt,yt),i.call(o+"_add",W,W,dt),i.call(o+"_add",dt,W,dt),i.call(o+"_square",dt,Lt),i.call(o+"_mul",c,m,St),i.call(o+"_add",yt,yt,y),i.call(o+"_sub",Lt,y,y),i.call(o+"_add",at,at,gt),i.call(o+"_add",gt,gt,gt),i.call(o+"_add",gt,gt,gt),i.call(o+"_sub",yt,y,h),i.call(o+"_mul",h,dt,h),i.call(o+"_sub",h,gt,h),i.call(o+"_add",St,St,v))}function B(){const L=t.addFunction(n+"_doubleAffine");L.addParam("p1","i32"),L.addParam("pr","i32");const i=L.getCodeBuilder(),C=i.getLocal("p1"),c=i.i32_add(i.getLocal("p1"),i.i32_const(f)),m=i.getLocal("pr"),y=i.i32_add(i.getLocal("pr"),i.i32_const(f)),h=i.i32_add(i.getLocal("pr"),i.i32_const(f*2)),v=i.i32_const(t.alloc(f)),W=i.i32_const(t.alloc(f)),R=i.i32_const(t.alloc(f)),at=i.i32_const(t.alloc(f)),yt=i.i32_const(t.alloc(f)),dt=i.i32_const(t.alloc(f));L.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("p1")),[...i.call(n+"_toJacobian",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.call(o+"_square",C,v),i.call(o+"_square",c,W),i.call(o+"_square",W,R),i.call(o+"_add",C,W,at),i.call(o+"_square",at,at),i.call(o+"_sub",at,v,at),i.call(o+"_sub",at,R,at),i.call(o+"_add",at,at,at),i.call(o+"_add",v,v,yt),i.call(o+"_add",yt,v,yt),i.call(o+"_add",c,c,h),i.call(o+"_square",yt,m),i.call(o+"_sub",m,at,m),i.call(o+"_sub",m,at,m),i.call(o+"_add",R,R,dt),i.call(o+"_add",dt,dt,dt),i.call(o+"_add",dt,dt,dt),i.call(o+"_sub",at,m,y),i.call(o+"_mul",y,yt,y),i.call(o+"_sub",y,dt,y))}function G(){const L=t.addFunction(n+"_eqAffine");L.addParam("p1","i32"),L.addParam("p2","i32"),L.setReturnType("i32"),L.addLocal("z1","i32");const i=L.getCodeBuilder();L.addCode(i.ret(i.i32_and(i.call(o+"_eq",i.getLocal("p1"),i.getLocal("p2")),i.call(o+"_eq",i.i32_add(i.getLocal("p1"),i.i32_const(f)),i.i32_add(i.getLocal("p2"),i.i32_const(f))))))}function S(){const L=t.addFunction(n+"_toMontgomery");L.addParam("p1","i32"),L.addParam("pr","i32");const i=L.getCodeBuilder();L.addCode(i.call(o+"_toMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let C=1;C<3;C++)L.addCode(i.call(o+"_toMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(C*f)),i.i32_add(i.getLocal("pr"),i.i32_const(C*f))))}function st(){const L=t.addFunction(n+"_toMontgomeryAffine");L.addParam("p1","i32"),L.addParam("pr","i32");const i=L.getCodeBuilder();L.addCode(i.call(o+"_toMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let C=1;C<2;C++)L.addCode(i.call(o+"_toMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(C*f)),i.i32_add(i.getLocal("pr"),i.i32_const(C*f))))}function U(){const L=t.addFunction(n+"_fromMontgomery");L.addParam("p1","i32"),L.addParam("pr","i32");const i=L.getCodeBuilder();L.addCode(i.call(o+"_fromMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let C=1;C<3;C++)L.addCode(i.call(o+"_fromMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(C*f)),i.i32_add(i.getLocal("pr"),i.i32_const(C*f))))}function lt(){const L=t.addFunction(n+"_fromMontgomeryAffine");L.addParam("p1","i32"),L.addParam("pr","i32");const i=L.getCodeBuilder();L.addCode(i.call(o+"_fromMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let C=1;C<2;C++)L.addCode(i.call(o+"_fromMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(C*f)),i.i32_add(i.getLocal("pr"),i.i32_const(C*f))))}function w(){const L=t.addFunction(n+"_add");L.addParam("p1","i32"),L.addParam("p2","i32"),L.addParam("pr","i32"),L.addLocal("z1","i32"),L.addLocal("z2","i32");const i=L.getCodeBuilder(),C=i.getLocal("p1"),c=i.i32_add(i.getLocal("p1"),i.i32_const(f));L.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(f*2))));const m=i.getLocal("z1"),y=i.getLocal("p2"),h=i.i32_add(i.getLocal("p2"),i.i32_const(f));L.addCode(i.setLocal("z2",i.i32_add(i.getLocal("p2"),i.i32_const(f*2))));const v=i.getLocal("z2"),W=i.getLocal("pr"),R=i.i32_add(i.getLocal("pr"),i.i32_const(f)),at=i.i32_add(i.getLocal("pr"),i.i32_const(f*2)),yt=i.i32_const(t.alloc(f)),dt=i.i32_const(t.alloc(f)),Lt=i.i32_const(t.alloc(f)),St=i.i32_const(t.alloc(f)),gt=i.i32_const(t.alloc(f)),rt=i.i32_const(t.alloc(f)),bt=i.i32_const(t.alloc(f)),xt=i.i32_const(t.alloc(f)),Mt=i.i32_const(t.alloc(f)),Vt=i.i32_const(t.alloc(f)),Dt=i.i32_const(t.alloc(f)),$t=i.i32_const(t.alloc(f)),qt=i.i32_const(t.alloc(f)),Tt=i.i32_const(t.alloc(f)),Rt=i.i32_const(t.alloc(f)),Xt=i.i32_const(t.alloc(f)),Yt=i.i32_const(t.alloc(f));L.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),[...i.call(n+"_copy",i.getLocal("p2"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(n+"_isZero",i.getLocal("p2")),[...i.call(n+"_copy",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(o+"_isOne",m),[...i.call(n+"_addMixed",y,C,W),...i.ret([])]),i.if(i.call(o+"_isOne",v),[...i.call(n+"_addMixed",C,y,W),...i.ret([])]),i.call(o+"_square",m,yt),i.call(o+"_square",v,dt),i.call(o+"_mul",C,dt,Lt),i.call(o+"_mul",y,yt,St),i.call(o+"_mul",m,yt,gt),i.call(o+"_mul",v,dt,rt),i.call(o+"_mul",c,rt,bt),i.call(o+"_mul",h,gt,xt),i.if(i.call(o+"_eq",Lt,St),i.if(i.call(o+"_eq",bt,xt),[...i.call(n+"_double",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])])),i.call(o+"_sub",St,Lt,Mt),i.call(o+"_sub",xt,bt,Vt),i.call(o+"_add",Mt,Mt,Dt),i.call(o+"_square",Dt,Dt),i.call(o+"_mul",Mt,Dt,$t),i.call(o+"_add",Vt,Vt,qt),i.call(o+"_mul",Lt,Dt,Rt),i.call(o+"_square",qt,Tt),i.call(o+"_add",Rt,Rt,Xt),i.call(o+"_sub",Tt,$t,W),i.call(o+"_sub",W,Xt,W),i.call(o+"_mul",bt,$t,Yt),i.call(o+"_add",Yt,Yt,Yt),i.call(o+"_sub",Rt,W,R),i.call(o+"_mul",R,qt,R),i.call(o+"_sub",R,Yt,R),i.call(o+"_add",m,v,at),i.call(o+"_square",at,at),i.call(o+"_sub",at,yt,at),i.call(o+"_sub",at,dt,at),i.call(o+"_mul",at,Mt,at))}function _(){const L=t.addFunction(n+"_addMixed");L.addParam("p1","i32"),L.addParam("p2","i32"),L.addParam("pr","i32"),L.addLocal("z1","i32");const i=L.getCodeBuilder(),C=i.getLocal("p1"),c=i.i32_add(i.getLocal("p1"),i.i32_const(f));L.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(f*2))));const m=i.getLocal("z1"),y=i.getLocal("p2"),h=i.i32_add(i.getLocal("p2"),i.i32_const(f)),v=i.getLocal("pr"),W=i.i32_add(i.getLocal("pr"),i.i32_const(f)),R=i.i32_add(i.getLocal("pr"),i.i32_const(f*2)),at=i.i32_const(t.alloc(f)),yt=i.i32_const(t.alloc(f)),dt=i.i32_const(t.alloc(f)),Lt=i.i32_const(t.alloc(f)),St=i.i32_const(t.alloc(f)),gt=i.i32_const(t.alloc(f)),rt=i.i32_const(t.alloc(f)),bt=i.i32_const(t.alloc(f)),xt=i.i32_const(t.alloc(f)),Mt=i.i32_const(t.alloc(f)),Vt=i.i32_const(t.alloc(f)),Dt=i.i32_const(t.alloc(f)),$t=i.i32_const(t.alloc(f)),qt=i.i32_const(t.alloc(f));L.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),[...i.call(n+"_copyAffine",i.getLocal("p2"),i.getLocal("pr")),...i.call(o+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(f*2))),...i.ret([])]),i.if(i.call(n+"_isZeroAffine",i.getLocal("p2")),[...i.call(n+"_copy",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(o+"_isOne",m),[...i.call(n+"_addAffine",C,y,v),...i.ret([])]),i.call(o+"_square",m,at),i.call(o+"_mul",y,at,yt),i.call(o+"_mul",m,at,dt),i.call(o+"_mul",h,dt,Lt),i.if(i.call(o+"_eq",C,yt),i.if(i.call(o+"_eq",c,Lt),[...i.call(n+"_doubleAffine",i.getLocal("p2"),i.getLocal("pr")),...i.ret([])])),i.call(o+"_sub",yt,C,St),i.call(o+"_sub",Lt,c,rt),i.call(o+"_square",St,gt),i.call(o+"_add",gt,gt,bt),i.call(o+"_add",bt,bt,bt),i.call(o+"_mul",St,bt,xt),i.call(o+"_add",rt,rt,Mt),i.call(o+"_mul",C,bt,Dt),i.call(o+"_square",Mt,Vt),i.call(o+"_add",Dt,Dt,$t),i.call(o+"_sub",Vt,xt,v),i.call(o+"_sub",v,$t,v),i.call(o+"_mul",c,xt,qt),i.call(o+"_add",qt,qt,qt),i.call(o+"_sub",Dt,v,W),i.call(o+"_mul",W,Mt,W),i.call(o+"_sub",W,qt,W),i.call(o+"_add",m,St,R),i.call(o+"_square",R,R),i.call(o+"_sub",R,at,R),i.call(o+"_sub",R,gt,R))}function p(){const L=t.addFunction(n+"_addAffine");L.addParam("p1","i32"),L.addParam("p2","i32"),L.addParam("pr","i32"),L.addLocal("z1","i32");const i=L.getCodeBuilder(),C=i.getLocal("p1"),c=i.i32_add(i.getLocal("p1"),i.i32_const(f));L.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(f*2))));const m=i.getLocal("p2"),y=i.i32_add(i.getLocal("p2"),i.i32_const(f)),h=i.getLocal("pr"),v=i.i32_add(i.getLocal("pr"),i.i32_const(f)),W=i.i32_add(i.getLocal("pr"),i.i32_const(f*2)),R=i.i32_const(t.alloc(f)),at=i.i32_const(t.alloc(f)),yt=i.i32_const(t.alloc(f)),dt=i.i32_const(t.alloc(f)),Lt=i.i32_const(t.alloc(f)),St=i.i32_const(t.alloc(f)),gt=i.i32_const(t.alloc(f)),rt=i.i32_const(t.alloc(f)),bt=i.i32_const(t.alloc(f)),xt=i.i32_const(t.alloc(f));L.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("p1")),[...i.call(n+"_copyAffine",i.getLocal("p2"),i.getLocal("pr")),...i.call(o+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(f*2))),...i.ret([])]),i.if(i.call(n+"_isZeroAffine",i.getLocal("p2")),[...i.call(n+"_copyAffine",i.getLocal("p1"),i.getLocal("pr")),...i.call(o+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(f*2))),...i.ret([])]),i.if(i.call(o+"_eq",C,m),i.if(i.call(o+"_eq",c,y),[...i.call(n+"_doubleAffine",i.getLocal("p2"),i.getLocal("pr")),...i.ret([])])),i.call(o+"_sub",m,C,R),i.call(o+"_sub",y,c,yt),i.call(o+"_square",R,at),i.call(o+"_add",at,at,dt),i.call(o+"_add",dt,dt,dt),i.call(o+"_mul",R,dt,Lt),i.call(o+"_add",yt,yt,St),i.call(o+"_mul",C,dt,rt),i.call(o+"_square",St,gt),i.call(o+"_add",rt,rt,bt),i.call(o+"_sub",gt,Lt,h),i.call(o+"_sub",h,bt,h),i.call(o+"_mul",c,Lt,xt),i.call(o+"_add",xt,xt,xt),i.call(o+"_sub",rt,h,v),i.call(o+"_mul",v,St,v),i.call(o+"_sub",v,xt,v),i.call(o+"_add",R,R,W))}function V(){const L=t.addFunction(n+"_neg");L.addParam("p1","i32"),L.addParam("pr","i32");const i=L.getCodeBuilder(),C=i.getLocal("p1"),c=i.i32_add(i.getLocal("p1"),i.i32_const(f)),m=i.i32_add(i.getLocal("p1"),i.i32_const(f*2)),y=i.getLocal("pr"),h=i.i32_add(i.getLocal("pr"),i.i32_const(f)),v=i.i32_add(i.getLocal("pr"),i.i32_const(f*2));L.addCode(i.call(o+"_copy",C,y),i.call(o+"_neg",c,h),i.call(o+"_copy",m,v))}function j(){const L=t.addFunction(n+"_negAffine");L.addParam("p1","i32"),L.addParam("pr","i32");const i=L.getCodeBuilder(),C=i.getLocal("p1"),c=i.i32_add(i.getLocal("p1"),i.i32_const(f)),m=i.getLocal("pr"),y=i.i32_add(i.getLocal("pr"),i.i32_const(f));L.addCode(i.call(o+"_copy",C,m),i.call(o+"_neg",c,y))}function X(){const L=t.addFunction(n+"_sub");L.addParam("p1","i32"),L.addParam("p2","i32"),L.addParam("pr","i32");const i=L.getCodeBuilder(),C=i.i32_const(t.alloc(f*3));L.addCode(i.call(n+"_neg",i.getLocal("p2"),C),i.call(n+"_add",i.getLocal("p1"),C,i.getLocal("pr")))}function O(){const L=t.addFunction(n+"_subMixed");L.addParam("p1","i32"),L.addParam("p2","i32"),L.addParam("pr","i32");const i=L.getCodeBuilder(),C=i.i32_const(t.alloc(f*3));L.addCode(i.call(n+"_negAffine",i.getLocal("p2"),C),i.call(n+"_addMixed",i.getLocal("p1"),C,i.getLocal("pr")))}function b(){const L=t.addFunction(n+"_subAffine");L.addParam("p1","i32"),L.addParam("p2","i32"),L.addParam("pr","i32");const i=L.getCodeBuilder(),C=i.i32_const(t.alloc(f*3));L.addCode(i.call(n+"_negAffine",i.getLocal("p2"),C),i.call(n+"_addAffine",i.getLocal("p1"),C,i.getLocal("pr")))}function x(){const L=t.addFunction(n+"_normalize");L.addParam("p1","i32"),L.addParam("pr","i32");const i=L.getCodeBuilder(),C=i.getLocal("p1"),c=i.i32_add(i.getLocal("p1"),i.i32_const(f)),m=i.i32_add(i.getLocal("p1"),i.i32_const(f*2)),y=i.getLocal("pr"),h=i.i32_add(i.getLocal("pr"),i.i32_const(f)),v=i.i32_add(i.getLocal("pr"),i.i32_const(f*2)),W=i.i32_const(t.alloc(f)),R=i.i32_const(t.alloc(f)),at=i.i32_const(t.alloc(f));L.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),i.call(n+"_zero",i.getLocal("pr")),[...i.call(o+"_inverse",m,W),...i.call(o+"_square",W,R),...i.call(o+"_mul",W,R,at),...i.call(o+"_mul",C,R,y),...i.call(o+"_mul",c,at,h),...i.call(o+"_one",v)]))}function z(){const L=t.addFunction(n+"_toAffine");L.addParam("p1","i32"),L.addParam("pr","i32");const i=L.getCodeBuilder(),C=i.getLocal("p1"),c=i.i32_add(i.getLocal("p1"),i.i32_const(f)),m=i.i32_add(i.getLocal("p1"),i.i32_const(f*2)),y=i.getLocal("pr"),h=i.i32_add(i.getLocal("pr"),i.i32_const(f)),v=i.i32_const(t.alloc(f)),W=i.i32_const(t.alloc(f)),R=i.i32_const(t.alloc(f));L.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),[...i.call(o+"_zero",y),...i.call(o+"_zero",h)],[...i.call(o+"_inverse",m,v),...i.call(o+"_square",v,W),...i.call(o+"_mul",v,W,R),...i.call(o+"_mul",C,W,y),...i.call(o+"_mul",c,R,h)]))}function ot(){const L=t.addFunction(n+"_toJacobian");L.addParam("p1","i32"),L.addParam("pr","i32");const i=L.getCodeBuilder(),C=i.getLocal("p1"),c=i.i32_add(i.getLocal("p1"),i.i32_const(f)),m=i.getLocal("pr"),y=i.i32_add(i.getLocal("pr"),i.i32_const(f)),h=i.i32_add(i.getLocal("pr"),i.i32_const(f*2));L.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("p1")),i.call(n+"_zero",i.getLocal("pr")),[...i.call(o+"_one",h),...i.call(o+"_copy",c,y),...i.call(o+"_copy",C,m)]))}function tt(){const L=t.addFunction(n+"_batchToAffine");L.addParam("pIn","i32"),L.addParam("n","i32"),L.addParam("pOut","i32"),L.addLocal("pAux","i32"),L.addLocal("itIn","i32"),L.addLocal("itAux","i32"),L.addLocal("itOut","i32"),L.addLocal("i","i32");const i=L.getCodeBuilder(),C=i.i32_const(t.alloc(f));L.addCode(i.setLocal("pAux",i.i32_load(i.i32_const(0))),i.i32_store(i.i32_const(0),i.i32_add(i.getLocal("pAux"),i.i32_mul(i.getLocal("n"),i.i32_const(f)))),i.call(o+"_batchInverse",i.i32_add(i.getLocal("pIn"),i.i32_const(f*2)),i.i32_const(f*3),i.getLocal("n"),i.getLocal("pAux"),i.i32_const(f)),i.setLocal("itIn",i.getLocal("pIn")),i.setLocal("itAux",i.getLocal("pAux")),i.setLocal("itOut",i.getLocal("pOut")),i.setLocal("i",i.i32_const(0)),i.block(i.loop(i.br_if(1,i.i32_eq(i.getLocal("i"),i.getLocal("n"))),i.if(i.call(o+"_isZero",i.getLocal("itAux")),[...i.call(o+"_zero",i.getLocal("itOut")),...i.call(o+"_zero",i.i32_add(i.getLocal("itOut"),i.i32_const(f)))],[...i.call(o+"_mul",i.getLocal("itAux"),i.i32_add(i.getLocal("itIn"),i.i32_const(f)),C),...i.call(o+"_square",i.getLocal("itAux"),i.getLocal("itAux")),...i.call(o+"_mul",i.getLocal("itAux"),i.getLocal("itIn"),i.getLocal("itOut")),...i.call(o+"_mul",i.getLocal("itAux"),C,i.i32_add(i.getLocal("itOut"),i.i32_const(f)))]),i.setLocal("itIn",i.i32_add(i.getLocal("itIn"),i.i32_const(f*3))),i.setLocal("itOut",i.i32_add(i.getLocal("itOut"),i.i32_const(f*2))),i.setLocal("itAux",i.i32_add(i.getLocal("itAux"),i.i32_const(f))),i.setLocal("i",i.i32_add(i.getLocal("i"),i.i32_const(1))),i.br(0))),i.i32_store(i.i32_const(0),i.getLocal("pAux")))}function K(){const L=t.addFunction(n+"__reverseBytes");L.addParam("pIn","i32"),L.addParam("n","i32"),L.addParam("pOut","i32"),L.addLocal("itOut","i32"),L.addLocal("itIn","i32");const i=L.getCodeBuilder();L.addCode(i.setLocal("itOut",i.i32_sub(i.i32_add(i.getLocal("pOut"),i.getLocal("n")),i.i32_const(1))),i.setLocal("itIn",i.getLocal("pIn")),i.block(i.loop(i.br_if(1,i.i32_lt_s(i.getLocal("itOut"),i.getLocal("pOut"))),i.i32_store8(i.getLocal("itOut"),i.i32_load8_u(i.getLocal("itIn"))),i.setLocal("itOut",i.i32_sub(i.getLocal("itOut"),i.i32_const(1))),i.setLocal("itIn",i.i32_add(i.getLocal("itIn"),i.i32_const(1))),i.br(0))))}function it(){const L=t.addFunction(n+"_LEMtoC");L.addParam("pIn","i32"),L.addParam("pOut","i32");const i=L.getCodeBuilder(),C=i.i32_const(t.alloc(f));L.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("pIn")),[...i.call(o+"_zero",i.getLocal("pOut")),...i.i32_store8(i.getLocal("pOut"),i.i32_const(64)),...i.ret([])]),i.call(o+"_fromMontgomery",i.getLocal("pIn"),C),i.call(n+"__reverseBytes",C,i.i32_const(f),i.getLocal("pOut")),i.if(i.i32_eq(i.call(o+"_sign",i.i32_add(i.getLocal("pIn"),i.i32_const(f))),i.i32_const(-1)),i.i32_store8(i.getLocal("pOut"),i.i32_or(i.i32_load8_u(i.getLocal("pOut")),i.i32_const(128)))))}function J(){const L=t.addFunction(n+"_LEMtoU");L.addParam("pIn","i32"),L.addParam("pOut","i32");const i=L.getCodeBuilder(),C=t.alloc(f*2),c=i.i32_const(C),m=i.i32_const(C),y=i.i32_const(C+f);L.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("pIn")),[...i.call(n+"_zeroAffine",i.getLocal("pOut")),...i.ret([])]),i.call(n+"_fromMontgomeryAffine",i.getLocal("pIn"),c),i.call(n+"__reverseBytes",m,i.i32_const(f),i.getLocal("pOut")),i.call(n+"__reverseBytes",y,i.i32_const(f),i.i32_add(i.getLocal("pOut"),i.i32_const(f))))}function et(){const L=t.addFunction(n+"_UtoLEM");L.addParam("pIn","i32"),L.addParam("pOut","i32");const i=L.getCodeBuilder(),C=t.alloc(f*2),c=i.i32_const(C),m=i.i32_const(C),y=i.i32_const(C+f);L.addCode(i.if(i.i32_and(i.i32_load8_u(i.getLocal("pIn")),i.i32_const(64)),[...i.call(n+"_zeroAffine",i.getLocal("pOut")),...i.ret([])]),i.call(n+"__reverseBytes",i.getLocal("pIn"),i.i32_const(f),m),i.call(n+"__reverseBytes",i.i32_add(i.getLocal("pIn"),i.i32_const(f)),i.i32_const(f),y),i.call(n+"_toMontgomeryAffine",c,i.getLocal("pOut")))}function pt(){const L=t.addFunction(n+"_CtoLEM");L.addParam("pIn","i32"),L.addParam("pOut","i32"),L.addLocal("firstByte","i32"),L.addLocal("greatest","i32");const i=L.getCodeBuilder(),C=t.alloc(f*2),c=i.i32_const(C),m=i.i32_const(C+f);L.addCode(i.setLocal("firstByte",i.i32_load8_u(i.getLocal("pIn"))),i.if(i.i32_and(i.getLocal("firstByte"),i.i32_const(64)),[...i.call(n+"_zeroAffine",i.getLocal("pOut")),...i.ret([])]),i.setLocal("greatest",i.i32_and(i.getLocal("firstByte"),i.i32_const(128))),i.call(o+"_copy",i.getLocal("pIn"),m),i.i32_store8(m,i.i32_and(i.getLocal("firstByte"),i.i32_const(63))),i.call(n+"__reverseBytes",m,i.i32_const(f),c),i.call(o+"_toMontgomery",c,i.getLocal("pOut")),i.call(o+"_square",i.getLocal("pOut"),m),i.call(o+"_mul",i.getLocal("pOut"),m,m),i.call(o+"_add",m,i.i32_const(a),m),i.call(o+"_sqrt",m,m),i.call(o+"_neg",m,c),i.if(i.i32_eq(i.call(o+"_sign",m),i.i32_const(-1)),i.if(i.getLocal("greatest"),i.call(o+"_copy",m,i.i32_add(i.getLocal("pOut"),i.i32_const(f))),i.call(o+"_neg",m,i.i32_add(i.getLocal("pOut"),i.i32_const(f)))),i.if(i.getLocal("greatest"),i.call(o+"_neg",m,i.i32_add(i.getLocal("pOut"),i.i32_const(f))),i.call(o+"_copy",m,i.i32_add(i.getLocal("pOut"),i.i32_const(f))))))}function wt(){const L=t.addFunction(n+"_inCurveAffine");L.addParam("pIn","i32"),L.setReturnType("i32");const i=L.getCodeBuilder(),C=i.getLocal("pIn"),c=i.i32_add(i.getLocal("pIn"),i.i32_const(f)),m=i.i32_const(t.alloc(f)),y=i.i32_const(t.alloc(f));L.addCode(i.call(o+"_square",c,m),i.call(o+"_square",C,y),i.call(o+"_mul",C,y,y),i.call(o+"_add",y,i.i32_const(a),y),i.ret(i.call(o+"_eq",m,y)))}function ft(){const L=t.addFunction(n+"_inCurve");L.addParam("pIn","i32"),L.setReturnType("i32");const i=L.getCodeBuilder(),C=i.i32_const(t.alloc(f*2));L.addCode(i.call(n+"_toAffine",i.getLocal("pIn"),C),i.ret(i.call(n+"_inCurveAffine",C)))}return I(),g(),F(),E(),l(),u(),ot(),G(),k(),A(),B(),D(),p(),_(),w(),j(),V(),b(),O(),X(),lt(),U(),st(),S(),z(),wt(),ft(),tt(),x(),K(),J(),it(),et(),pt(),Dn(t,n+"_batchLEMtoU",n+"_LEMtoU",f*2,f*2),Dn(t,n+"_batchLEMtoC",n+"_LEMtoC",f*2,f),Dn(t,n+"_batchUtoLEM",n+"_UtoLEM",f*2,f*2),Dn(t,n+"_batchCtoLEM",n+"_CtoLEM",f,f*2,!0),Dn(t,n+"_batchToJacobian",n+"_toJacobian",f*2,f*3,!0),ka(t,n,n+"_multiexp",n+"_add",f*3),ka(t,n,n+"_multiexpAffine",n+"_addMixed",f*2),za(t,n+"_timesScalar",f*3,n+"_add",n+"_double",n+"_sub",n+"_copy",n+"_zero"),za(t,n+"_timesScalarAffine",f*2,n+"_addMixed",n+"_double",n+"_subMixed",n+"_copyAffine",n+"_zero"),t.exportFunction(n+"_isZero"),t.exportFunction(n+"_isZeroAffine"),t.exportFunction(n+"_eq"),t.exportFunction(n+"_eqMixed"),t.exportFunction(n+"_eqAffine"),t.exportFunction(n+"_copy"),t.exportFunction(n+"_copyAffine"),t.exportFunction(n+"_zero"),t.exportFunction(n+"_zeroAffine"),t.exportFunction(n+"_double"),t.exportFunction(n+"_doubleAffine"),t.exportFunction(n+"_add"),t.exportFunction(n+"_addMixed"),t.exportFunction(n+"_addAffine"),t.exportFunction(n+"_neg"),t.exportFunction(n+"_negAffine"),t.exportFunction(n+"_sub"),t.exportFunction(n+"_subMixed"),t.exportFunction(n+"_subAffine"),t.exportFunction(n+"_fromMontgomery"),t.exportFunction(n+"_fromMontgomeryAffine"),t.exportFunction(n+"_toMontgomery"),t.exportFunction(n+"_toMontgomeryAffine"),t.exportFunction(n+"_timesScalar"),t.exportFunction(n+"_timesScalarAffine"),t.exportFunction(n+"_normalize"),t.exportFunction(n+"_LEMtoU"),t.exportFunction(n+"_LEMtoC"),t.exportFunction(n+"_UtoLEM"),t.exportFunction(n+"_CtoLEM"),t.exportFunction(n+"_batchLEMtoU"),t.exportFunction(n+"_batchLEMtoC"),t.exportFunction(n+"_batchUtoLEM"),t.exportFunction(n+"_batchCtoLEM"),t.exportFunction(n+"_toAffine"),t.exportFunction(n+"_toJacobian"),t.exportFunction(n+"_batchToAffine"),t.exportFunction(n+"_batchToJacobian"),t.exportFunction(n+"_inCurve"),t.exportFunction(n+"_inCurveAffine"),n};const{isOdd:Sc,modInv:Ta,modPow:Tn}=Kt,ao=_n;var Ga=function(t,n,o,a,s){const g=t.modules[a].n64*8,u=t.modules[o].n64*8,l=t.modules[a].q;let E=l-1n,F=0;for(;!Sc(E);)F++,E=E>>1n;let A=2n;for(;Tn(A,l>>1n,l)===1n;)A=A+1n;const k=new Array(F+1);k[F]=Tn(A,E,l);let D=F-1;for(;D>=0;)k[D]=Tn(k[D+1],2n,l),D--;const B=[],G=(1n<<BigInt(g*8))%l;for(let C=0;C<k.length;C++){const c=k[C]*G%l;B.push(...ao.bigInt2BytesLE(c,g))}const S=t.alloc(B),st=new Array(F+1);st[0]=1n;for(let C=1;C<=F;C++)st[C]=st[C-1]*2n;const U=[];for(let C=0;C<=F;C++){const c=Ta(st[C],l)*G%l;U.push(...ao.bigInt2BytesLE(c,g))}const lt=t.alloc(U),w=Tn(A,2n,l),_=[],p=[];for(let C=0;C<=F;C++){const c=Tn(w,2n**BigInt(C),l),m=Ta(l+1n-c,l);_.push(...ao.bigInt2BytesLE(c*G%l,g)),p.push(...ao.bigInt2BytesLE(m*G%l,g))}const V=t.alloc(_),j=t.alloc(p);function X(C){let c=0;for(let m=0;m<8;m++)C&1<<m&&(c=c|128>>m);return c}const O=Array(256);for(let C=0;C<256;C++)O[C]=X(C);const b=t.alloc(O);function x(){const C=t.addFunction(n+"__log2");C.addParam("n","i32"),C.setReturnType("i32"),C.addLocal("bits","i32"),C.addLocal("aux","i32");const c=C.getCodeBuilder();C.addCode(c.setLocal("aux",c.i32_shr_u(c.getLocal("n"),c.i32_const(1)))),C.addCode(c.setLocal("bits",c.i32_const(0))),C.addCode(c.block(c.loop(c.br_if(1,c.i32_eqz(c.getLocal("aux"))),c.setLocal("aux",c.i32_shr_u(c.getLocal("aux"),c.i32_const(1))),c.setLocal("bits",c.i32_add(c.getLocal("bits"),c.i32_const(1))),c.br(0)))),C.addCode(c.if(c.i32_ne(c.getLocal("n"),c.i32_shl(c.i32_const(1),c.getLocal("bits"))),c.unreachable())),C.addCode(c.if(c.i32_gt_u(c.getLocal("bits"),c.i32_const(F)),c.unreachable())),C.addCode(c.getLocal("bits"))}function z(){const C=t.addFunction(n+"_fft");C.addParam("px","i32"),C.addParam("n","i32"),C.addLocal("bits","i32");const c=C.getCodeBuilder(),m=c.i32_const(t.alloc(g));C.addCode(c.setLocal("bits",c.call(n+"__log2",c.getLocal("n"))),c.call(a+"_one",m),c.call(n+"_rawfft",c.getLocal("px"),c.getLocal("bits"),c.i32_const(0),m))}function ot(){const C=t.addFunction(n+"_ifft");C.addParam("px","i32"),C.addParam("n","i32"),C.addLocal("bits","i32"),C.addLocal("pInv2","i32");const c=C.getCodeBuilder();C.addCode(c.setLocal("bits",c.call(n+"__log2",c.getLocal("n"))),c.setLocal("pInv2",c.i32_add(c.i32_const(lt),c.i32_mul(c.getLocal("bits"),c.i32_const(g)))),c.call(n+"_rawfft",c.getLocal("px"),c.getLocal("bits"),c.i32_const(1),c.getLocal("pInv2")))}function tt(){const C=t.addFunction(n+"_rawfft");C.addParam("px","i32"),C.addParam("bits","i32"),C.addParam("reverse","i32"),C.addParam("mulFactor","i32"),C.addLocal("s","i32"),C.addLocal("k","i32"),C.addLocal("j","i32"),C.addLocal("m","i32"),C.addLocal("mdiv2","i32"),C.addLocal("n","i32"),C.addLocal("pwm","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32");const c=C.getCodeBuilder(),m=c.i32_const(t.alloc(g)),y=c.i32_const(t.alloc(u)),h=c.i32_const(t.alloc(u));C.addCode(c.call(n+"__reversePermutation",c.getLocal("px"),c.getLocal("bits")),c.setLocal("n",c.i32_shl(c.i32_const(1),c.getLocal("bits"))),c.setLocal("s",c.i32_const(1)),c.block(c.loop(c.br_if(1,c.i32_gt_u(c.getLocal("s"),c.getLocal("bits"))),c.setLocal("m",c.i32_shl(c.i32_const(1),c.getLocal("s"))),c.setLocal("pwm",c.i32_add(c.i32_const(S),c.i32_mul(c.getLocal("s"),c.i32_const(g)))),c.setLocal("k",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_ge_u(c.getLocal("k"),c.getLocal("n"))),c.call(a+"_one",m),c.setLocal("mdiv2",c.i32_shr_u(c.getLocal("m"),c.i32_const(1))),c.setLocal("j",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_ge_u(c.getLocal("j"),c.getLocal("mdiv2"))),c.setLocal("idx1",c.i32_add(c.getLocal("px"),c.i32_mul(c.i32_add(c.getLocal("k"),c.getLocal("j")),c.i32_const(u)))),c.setLocal("idx2",c.i32_add(c.getLocal("idx1"),c.i32_mul(c.getLocal("mdiv2"),c.i32_const(u)))),c.call(s,c.getLocal("idx2"),m,y),c.call(o+"_copy",c.getLocal("idx1"),h),c.call(o+"_add",h,y,c.getLocal("idx1")),c.call(o+"_sub",h,y,c.getLocal("idx2")),c.call(a+"_mul",m,c.getLocal("pwm"),m),c.setLocal("j",c.i32_add(c.getLocal("j"),c.i32_const(1))),c.br(0))),c.setLocal("k",c.i32_add(c.getLocal("k"),c.getLocal("m"))),c.br(0))),c.setLocal("s",c.i32_add(c.getLocal("s"),c.i32_const(1))),c.br(0))),c.call(n+"__fftFinal",c.getLocal("px"),c.getLocal("bits"),c.getLocal("reverse"),c.getLocal("mulFactor")))}function K(){const C=t.addFunction(n+"__fftFinal");C.addParam("px","i32"),C.addParam("bits","i32"),C.addParam("reverse","i32"),C.addParam("mulFactor","i32"),C.addLocal("n","i32"),C.addLocal("ndiv2","i32"),C.addLocal("pInv2","i32"),C.addLocal("i","i32"),C.addLocal("mask","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32");const c=C.getCodeBuilder(),m=c.i32_const(t.alloc(u));C.addCode(c.if(c.i32_and(c.i32_eqz(c.getLocal("reverse")),c.call(a+"_isOne",c.getLocal("mulFactor"))),c.ret([])),c.setLocal("n",c.i32_shl(c.i32_const(1),c.getLocal("bits"))),c.setLocal("mask",c.i32_sub(c.getLocal("n"),c.i32_const(1))),c.setLocal("i",c.i32_const(1)),c.setLocal("ndiv2",c.i32_shr_u(c.getLocal("n"),c.i32_const(1))),c.block(c.loop(c.br_if(1,c.i32_ge_u(c.getLocal("i"),c.getLocal("ndiv2"))),c.setLocal("idx1",c.i32_add(c.getLocal("px"),c.i32_mul(c.getLocal("i"),c.i32_const(u)))),c.setLocal("idx2",c.i32_add(c.getLocal("px"),c.i32_mul(c.i32_sub(c.getLocal("n"),c.getLocal("i")),c.i32_const(u)))),c.if(c.getLocal("reverse"),c.if(c.call(a+"_isOne",c.getLocal("mulFactor")),[...c.call(o+"_copy",c.getLocal("idx1"),m),...c.call(o+"_copy",c.getLocal("idx2"),c.getLocal("idx1")),...c.call(o+"_copy",m,c.getLocal("idx2"))],[...c.call(o+"_copy",c.getLocal("idx1"),m),...c.call(s,c.getLocal("idx2"),c.getLocal("mulFactor"),c.getLocal("idx1")),...c.call(s,m,c.getLocal("mulFactor"),c.getLocal("idx2"))]),c.if(c.call(a+"_isOne",c.getLocal("mulFactor")),[],[...c.call(s,c.getLocal("idx1"),c.getLocal("mulFactor"),c.getLocal("idx1")),...c.call(s,c.getLocal("idx2"),c.getLocal("mulFactor"),c.getLocal("idx2"))])),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))),c.if(c.call(a+"_isOne",c.getLocal("mulFactor")),[],[...c.call(s,c.getLocal("px"),c.getLocal("mulFactor"),c.getLocal("px")),...c.setLocal("idx2",c.i32_add(c.getLocal("px"),c.i32_mul(c.getLocal("ndiv2"),c.i32_const(u)))),...c.call(s,c.getLocal("idx2"),c.getLocal("mulFactor"),c.getLocal("idx2"))]))}function it(){const C=t.addFunction(n+"__reversePermutation");C.addParam("px","i32"),C.addParam("bits","i32"),C.addLocal("n","i32"),C.addLocal("i","i32"),C.addLocal("ri","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32");const c=C.getCodeBuilder(),m=c.i32_const(t.alloc(u));C.addCode(c.setLocal("n",c.i32_shl(c.i32_const(1),c.getLocal("bits"))),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("n"))),c.setLocal("idx1",c.i32_add(c.getLocal("px"),c.i32_mul(c.getLocal("i"),c.i32_const(u)))),c.setLocal("ri",c.call(n+"__rev",c.getLocal("i"),c.getLocal("bits"))),c.setLocal("idx2",c.i32_add(c.getLocal("px"),c.i32_mul(c.getLocal("ri"),c.i32_const(u)))),c.if(c.i32_lt_u(c.getLocal("i"),c.getLocal("ri")),[...c.call(o+"_copy",c.getLocal("idx1"),m),...c.call(o+"_copy",c.getLocal("idx2"),c.getLocal("idx1")),...c.call(o+"_copy",m,c.getLocal("idx2"))]),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}function J(){const C=t.addFunction(n+"__rev");C.addParam("x","i32"),C.addParam("bits","i32"),C.setReturnType("i32");const c=C.getCodeBuilder();C.addCode(c.i32_rotl(c.i32_add(c.i32_add(c.i32_shl(c.i32_load8_u(c.i32_and(c.getLocal("x"),c.i32_const(255)),b,0),c.i32_const(24)),c.i32_shl(c.i32_load8_u(c.i32_and(c.i32_shr_u(c.getLocal("x"),c.i32_const(8)),c.i32_const(255)),b,0),c.i32_const(16))),c.i32_add(c.i32_shl(c.i32_load8_u(c.i32_and(c.i32_shr_u(c.getLocal("x"),c.i32_const(16)),c.i32_const(255)),b,0),c.i32_const(8)),c.i32_load8_u(c.i32_and(c.i32_shr_u(c.getLocal("x"),c.i32_const(24)),c.i32_const(255)),b,0))),c.getLocal("bits")))}function et(){const C=t.addFunction(n+"_fftJoin");C.addParam("pBuff1","i32"),C.addParam("pBuff2","i32"),C.addParam("n","i32"),C.addParam("first","i32"),C.addParam("inc","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32");const c=C.getCodeBuilder(),m=c.i32_const(t.alloc(g)),y=c.i32_const(t.alloc(u)),h=c.i32_const(t.alloc(u));C.addCode(c.call(a+"_copy",c.getLocal("first"),m),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("n"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff1"),c.i32_mul(c.getLocal("i"),c.i32_const(u)))),c.setLocal("idx2",c.i32_add(c.getLocal("pBuff2"),c.i32_mul(c.getLocal("i"),c.i32_const(u)))),c.call(s,c.getLocal("idx2"),m,y),c.call(o+"_copy",c.getLocal("idx1"),h),c.call(o+"_add",h,y,c.getLocal("idx1")),c.call(o+"_sub",h,y,c.getLocal("idx2")),c.call(a+"_mul",m,c.getLocal("inc"),m),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}function pt(){const C=t.addFunction(n+"_fftJoinExt");C.addParam("pBuff1","i32"),C.addParam("pBuff2","i32"),C.addParam("n","i32"),C.addParam("first","i32"),C.addParam("inc","i32"),C.addParam("totalBits","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("pShiftToM","i32");const c=C.getCodeBuilder(),m=c.i32_const(t.alloc(g)),y=c.i32_const(t.alloc(u));C.addCode(c.setLocal("pShiftToM",c.i32_add(c.i32_const(V),c.i32_mul(c.getLocal("totalBits"),c.i32_const(g)))),c.call(a+"_copy",c.getLocal("first"),m),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("n"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff1"),c.i32_mul(c.getLocal("i"),c.i32_const(u)))),c.setLocal("idx2",c.i32_add(c.getLocal("pBuff2"),c.i32_mul(c.getLocal("i"),c.i32_const(u)))),c.call(o+"_add",c.getLocal("idx1"),c.getLocal("idx2"),y),c.call(s,c.getLocal("idx2"),c.getLocal("pShiftToM"),c.getLocal("idx2")),c.call(o+"_add",c.getLocal("idx1"),c.getLocal("idx2"),c.getLocal("idx2")),c.call(s,c.getLocal("idx2"),m,c.getLocal("idx2")),c.call(o+"_copy",y,c.getLocal("idx1")),c.call(a+"_mul",m,c.getLocal("inc"),m),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}function wt(){const C=t.addFunction(n+"_fftJoinExtInv");C.addParam("pBuff1","i32"),C.addParam("pBuff2","i32"),C.addParam("n","i32"),C.addParam("first","i32"),C.addParam("inc","i32"),C.addParam("totalBits","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("pShiftToM","i32"),C.addLocal("pSConst","i32");const c=C.getCodeBuilder(),m=c.i32_const(t.alloc(g)),y=c.i32_const(t.alloc(u));C.addCode(c.setLocal("pShiftToM",c.i32_add(c.i32_const(V),c.i32_mul(c.getLocal("totalBits"),c.i32_const(g)))),c.setLocal("pSConst",c.i32_add(c.i32_const(j),c.i32_mul(c.getLocal("totalBits"),c.i32_const(g)))),c.call(a+"_copy",c.getLocal("first"),m),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("n"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff1"),c.i32_mul(c.getLocal("i"),c.i32_const(u)))),c.setLocal("idx2",c.i32_add(c.getLocal("pBuff2"),c.i32_mul(c.getLocal("i"),c.i32_const(u)))),c.call(s,c.getLocal("idx2"),m,y),c.call(o+"_sub",c.getLocal("idx1"),y,c.getLocal("idx2")),c.call(s,c.getLocal("idx2"),c.getLocal("pSConst"),c.getLocal("idx2")),c.call(s,c.getLocal("idx1"),c.getLocal("pShiftToM"),c.getLocal("idx1")),c.call(o+"_sub",y,c.getLocal("idx1"),c.getLocal("idx1")),c.call(s,c.getLocal("idx1"),c.getLocal("pSConst"),c.getLocal("idx1")),c.call(a+"_mul",m,c.getLocal("inc"),m),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}function ft(){const C=t.addFunction(n+"_prepareLagrangeEvaluation");C.addParam("pBuff1","i32"),C.addParam("pBuff2","i32"),C.addParam("n","i32"),C.addParam("first","i32"),C.addParam("inc","i32"),C.addParam("totalBits","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("pShiftToM","i32"),C.addLocal("pSConst","i32");const c=C.getCodeBuilder(),m=c.i32_const(t.alloc(g)),y=c.i32_const(t.alloc(u));C.addCode(c.setLocal("pShiftToM",c.i32_add(c.i32_const(V),c.i32_mul(c.getLocal("totalBits"),c.i32_const(g)))),c.setLocal("pSConst",c.i32_add(c.i32_const(j),c.i32_mul(c.getLocal("totalBits"),c.i32_const(g)))),c.call(a+"_copy",c.getLocal("first"),m),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("n"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff1"),c.i32_mul(c.getLocal("i"),c.i32_const(u)))),c.setLocal("idx2",c.i32_add(c.getLocal("pBuff2"),c.i32_mul(c.getLocal("i"),c.i32_const(u)))),c.call(s,c.getLocal("idx1"),c.getLocal("pShiftToM"),y),c.call(o+"_sub",c.getLocal("idx2"),y,y),c.call(o+"_sub",c.getLocal("idx1"),c.getLocal("idx2"),c.getLocal("idx2")),c.call(s,y,c.getLocal("pSConst"),c.getLocal("idx1")),c.call(s,c.getLocal("idx2"),m,c.getLocal("idx2")),c.call(a+"_mul",m,c.getLocal("inc"),m),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}function L(){const C=t.addFunction(n+"_fftMix");C.addParam("pBuff","i32"),C.addParam("n","i32"),C.addParam("exp","i32"),C.addLocal("nGroups","i32"),C.addLocal("nPerGroup","i32"),C.addLocal("nPerGroupDiv2","i32"),C.addLocal("pairOffset","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("j","i32"),C.addLocal("pwm","i32");const c=C.getCodeBuilder(),m=c.i32_const(t.alloc(g)),y=c.i32_const(t.alloc(u)),h=c.i32_const(t.alloc(u));C.addCode(c.setLocal("nPerGroup",c.i32_shl(c.i32_const(1),c.getLocal("exp"))),c.setLocal("nPerGroupDiv2",c.i32_shr_u(c.getLocal("nPerGroup"),c.i32_const(1))),c.setLocal("nGroups",c.i32_shr_u(c.getLocal("n"),c.getLocal("exp"))),c.setLocal("pairOffset",c.i32_mul(c.getLocal("nPerGroupDiv2"),c.i32_const(u))),c.setLocal("pwm",c.i32_add(c.i32_const(S),c.i32_mul(c.getLocal("exp"),c.i32_const(g)))),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("i"),c.getLocal("nGroups"))),c.call(a+"_one",m),c.setLocal("j",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_eq(c.getLocal("j"),c.getLocal("nPerGroupDiv2"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff"),c.i32_mul(c.i32_add(c.i32_mul(c.getLocal("i"),c.getLocal("nPerGroup")),c.getLocal("j")),c.i32_const(u)))),c.setLocal("idx2",c.i32_add(c.getLocal("idx1"),c.getLocal("pairOffset"))),c.call(s,c.getLocal("idx2"),m,y),c.call(o+"_copy",c.getLocal("idx1"),h),c.call(o+"_add",h,y,c.getLocal("idx1")),c.call(o+"_sub",h,y,c.getLocal("idx2")),c.call(a+"_mul",m,c.getLocal("pwm"),m),c.setLocal("j",c.i32_add(c.getLocal("j"),c.i32_const(1))),c.br(0))),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}function i(){const C=t.addFunction(n+"_fftFinal");C.addParam("pBuff","i32"),C.addParam("n","i32"),C.addParam("factor","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("ndiv2","i32");const c=C.getCodeBuilder(),m=c.i32_const(t.alloc(u));C.addCode(c.setLocal("ndiv2",c.i32_shr_u(c.getLocal("n"),c.i32_const(1))),c.if(c.i32_and(c.getLocal("n"),c.i32_const(1)),c.call(s,c.i32_add(c.getLocal("pBuff"),c.i32_mul(c.getLocal("ndiv2"),c.i32_const(u))),c.getLocal("factor"),c.i32_add(c.getLocal("pBuff"),c.i32_mul(c.getLocal("ndiv2"),c.i32_const(u))))),c.setLocal("i",c.i32_const(0)),c.block(c.loop(c.br_if(1,c.i32_ge_u(c.getLocal("i"),c.getLocal("ndiv2"))),c.setLocal("idx1",c.i32_add(c.getLocal("pBuff"),c.i32_mul(c.getLocal("i"),c.i32_const(u)))),c.setLocal("idx2",c.i32_add(c.getLocal("pBuff"),c.i32_mul(c.i32_sub(c.i32_sub(c.getLocal("n"),c.i32_const(1)),c.getLocal("i")),c.i32_const(u)))),c.call(s,c.getLocal("idx2"),c.getLocal("factor"),m),c.call(s,c.getLocal("idx1"),c.getLocal("factor"),c.getLocal("idx2")),c.call(o+"_copy",m,c.getLocal("idx1")),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))))}J(),it(),K(),tt(),x(),z(),ot(),et(),pt(),wt(),L(),i(),ft(),t.exportFunction(n+"_fft"),t.exportFunction(n+"_ifft"),t.exportFunction(n+"_rawfft"),t.exportFunction(n+"_fftJoin"),t.exportFunction(n+"_fftJoinExt"),t.exportFunction(n+"_fftJoinExtInv"),t.exportFunction(n+"_fftMix"),t.exportFunction(n+"_fftFinal"),t.exportFunction(n+"_prepareLagrangeEvaluation")},Ra=function(t,n,o){const s=t.modules[o].n64*8;function f(){const I=t.addFunction(n+"_zero");I.addParam("px","i32"),I.addParam("n","i32"),I.addLocal("lastp","i32"),I.addLocal("p","i32");const u=I.getCodeBuilder();I.addCode(u.setLocal("p",u.getLocal("px")),u.setLocal("lastp",u.i32_add(u.getLocal("px"),u.i32_mul(u.getLocal("n"),u.i32_const(s)))),u.block(u.loop(u.br_if(1,u.i32_eq(u.getLocal("p"),u.getLocal("lastp"))),u.call(o+"_zero",u.getLocal("p")),u.setLocal("p",u.i32_add(u.getLocal("p"),u.i32_const(s))),u.br(0))))}function g(){const I=t.addFunction(n+"_constructLC");I.addParam("ppolynomials","i32"),I.addParam("psignals","i32"),I.addParam("nSignals","i32"),I.addParam("pres","i32"),I.addLocal("i","i32"),I.addLocal("j","i32"),I.addLocal("pp","i32"),I.addLocal("ps","i32"),I.addLocal("pd","i32"),I.addLocal("ncoefs","i32");const u=I.getCodeBuilder(),l=u.i32_const(t.alloc(s));I.addCode(u.setLocal("i",u.i32_const(0)),u.setLocal("pp",u.getLocal("ppolynomials")),u.setLocal("ps",u.getLocal("psignals")),u.block(u.loop(u.br_if(1,u.i32_eq(u.getLocal("i"),u.getLocal("nSignals"))),u.setLocal("ncoefs",u.i32_load(u.getLocal("pp"))),u.setLocal("pp",u.i32_add(u.getLocal("pp"),u.i32_const(4))),u.setLocal("j",u.i32_const(0)),u.block(u.loop(u.br_if(1,u.i32_eq(u.getLocal("j"),u.getLocal("ncoefs"))),u.setLocal("pd",u.i32_add(u.getLocal("pres"),u.i32_mul(u.i32_load(u.getLocal("pp")),u.i32_const(s)))),u.setLocal("pp",u.i32_add(u.getLocal("pp"),u.i32_const(4))),u.call(o+"_mul",u.getLocal("ps"),u.getLocal("pp"),l),u.call(o+"_add",l,u.getLocal("pd"),u.getLocal("pd")),u.setLocal("pp",u.i32_add(u.getLocal("pp"),u.i32_const(s))),u.setLocal("j",u.i32_add(u.getLocal("j"),u.i32_const(1))),u.br(0))),u.setLocal("ps",u.i32_add(u.getLocal("ps"),u.i32_const(s))),u.setLocal("i",u.i32_add(u.getLocal("i"),u.i32_const(1))),u.br(0))))}return f(),g(),t.exportFunction(n+"_zero"),t.exportFunction(n+"_constructLC"),n},Na=function(t,n,o){const s=t.modules[o].n64*8;function f(){const u=t.addFunction(n+"_buildABC");u.addParam("pCoefs","i32"),u.addParam("nCoefs","i32"),u.addParam("pWitness","i32"),u.addParam("pA","i32"),u.addParam("pB","i32"),u.addParam("pC","i32"),u.addParam("offsetOut","i32"),u.addParam("nOut","i32"),u.addParam("offsetWitness","i32"),u.addParam("nWitness","i32"),u.addLocal("it","i32"),u.addLocal("ita","i32"),u.addLocal("itb","i32"),u.addLocal("last","i32"),u.addLocal("m","i32"),u.addLocal("c","i32"),u.addLocal("s","i32"),u.addLocal("pOut","i32");const l=u.getCodeBuilder(),E=l.i32_const(t.alloc(s));u.addCode(l.setLocal("ita",l.getLocal("pA")),l.setLocal("itb",l.getLocal("pB")),l.setLocal("last",l.i32_add(l.getLocal("pA"),l.i32_mul(l.getLocal("nOut"),l.i32_const(s)))),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("ita"),l.getLocal("last"))),l.call(o+"_zero",l.getLocal("ita")),l.call(o+"_zero",l.getLocal("itb")),l.setLocal("ita",l.i32_add(l.getLocal("ita"),l.i32_const(s))),l.setLocal("itb",l.i32_add(l.getLocal("itb"),l.i32_const(s))),l.br(0))),l.setLocal("it",l.getLocal("pCoefs")),l.setLocal("last",l.i32_add(l.getLocal("pCoefs"),l.i32_mul(l.getLocal("nCoefs"),l.i32_const(s+12)))),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("it"),l.getLocal("last"))),l.setLocal("s",l.i32_load(l.getLocal("it"),8)),l.if(l.i32_or(l.i32_lt_u(l.getLocal("s"),l.getLocal("offsetWitness")),l.i32_ge_u(l.getLocal("s"),l.i32_add(l.getLocal("offsetWitness"),l.getLocal("nWitness")))),[...l.setLocal("it",l.i32_add(l.getLocal("it"),l.i32_const(s+12))),...l.br(1)]),l.setLocal("m",l.i32_load(l.getLocal("it"))),l.if(l.i32_eq(l.getLocal("m"),l.i32_const(0)),l.setLocal("pOut",l.getLocal("pA")),l.if(l.i32_eq(l.getLocal("m"),l.i32_const(1)),l.setLocal("pOut",l.getLocal("pB")),[...l.setLocal("it",l.i32_add(l.getLocal("it"),l.i32_const(s+12))),...l.br(1)])),l.setLocal("c",l.i32_load(l.getLocal("it"),4)),l.if(l.i32_or(l.i32_lt_u(l.getLocal("c"),l.getLocal("offsetOut")),l.i32_ge_u(l.getLocal("c"),l.i32_add(l.getLocal("offsetOut"),l.getLocal("nOut")))),[...l.setLocal("it",l.i32_add(l.getLocal("it"),l.i32_const(s+12))),...l.br(1)]),l.setLocal("pOut",l.i32_add(l.getLocal("pOut"),l.i32_mul(l.i32_sub(l.getLocal("c"),l.getLocal("offsetOut")),l.i32_const(s)))),l.call(o+"_mul",l.i32_add(l.getLocal("pWitness"),l.i32_mul(l.i32_sub(l.getLocal("s"),l.getLocal("offsetWitness")),l.i32_const(s))),l.i32_add(l.getLocal("it"),l.i32_const(12)),E),l.call(o+"_add",l.getLocal("pOut"),E,l.getLocal("pOut")),l.setLocal("it",l.i32_add(l.getLocal("it"),l.i32_const(s+12))),l.br(0))),l.setLocal("ita",l.getLocal("pA")),l.setLocal("itb",l.getLocal("pB")),l.setLocal("it",l.getLocal("pC")),l.setLocal("last",l.i32_add(l.getLocal("pA"),l.i32_mul(l.getLocal("nOut"),l.i32_const(s)))),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("ita"),l.getLocal("last"))),l.call(o+"_mul",l.getLocal("ita"),l.getLocal("itb"),l.getLocal("it")),l.setLocal("ita",l.i32_add(l.getLocal("ita"),l.i32_const(s))),l.setLocal("itb",l.i32_add(l.getLocal("itb"),l.i32_const(s))),l.setLocal("it",l.i32_add(l.getLocal("it"),l.i32_const(s))),l.br(0))))}function g(){const u=t.addFunction(n+"_joinABC");u.addParam("pA","i32"),u.addParam("pB","i32"),u.addParam("pC","i32"),u.addParam("n","i32"),u.addParam("pP","i32"),u.addLocal("ita","i32"),u.addLocal("itb","i32"),u.addLocal("itc","i32"),u.addLocal("itp","i32"),u.addLocal("last","i32");const l=u.getCodeBuilder(),E=l.i32_const(t.alloc(s));u.addCode(l.setLocal("ita",l.getLocal("pA")),l.setLocal("itb",l.getLocal("pB")),l.setLocal("itc",l.getLocal("pC")),l.setLocal("itp",l.getLocal("pP")),l.setLocal("last",l.i32_add(l.getLocal("pA"),l.i32_mul(l.getLocal("n"),l.i32_const(s)))),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("ita"),l.getLocal("last"))),l.call(o+"_mul",l.getLocal("ita"),l.getLocal("itb"),E),l.call(o+"_sub",E,l.getLocal("itc"),l.getLocal("itp")),l.setLocal("ita",l.i32_add(l.getLocal("ita"),l.i32_const(s))),l.setLocal("itb",l.i32_add(l.getLocal("itb"),l.i32_const(s))),l.setLocal("itc",l.i32_add(l.getLocal("itc"),l.i32_const(s))),l.setLocal("itp",l.i32_add(l.getLocal("itp"),l.i32_const(s))),l.br(0))))}function I(){const u=t.addFunction(n+"_batchAdd");u.addParam("pa","i32"),u.addParam("pb","i32"),u.addParam("n","i32"),u.addParam("pr","i32"),u.addLocal("ita","i32"),u.addLocal("itb","i32"),u.addLocal("itr","i32"),u.addLocal("last","i32");const l=u.getCodeBuilder();u.addCode(l.setLocal("ita",l.getLocal("pa")),l.setLocal("itb",l.getLocal("pb")),l.setLocal("itr",l.getLocal("pr")),l.setLocal("last",l.i32_add(l.getLocal("pa"),l.i32_mul(l.getLocal("n"),l.i32_const(s)))),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("ita"),l.getLocal("last"))),l.call(o+"_add",l.getLocal("ita"),l.getLocal("itb"),l.getLocal("itr")),l.setLocal("ita",l.i32_add(l.getLocal("ita"),l.i32_const(s))),l.setLocal("itb",l.i32_add(l.getLocal("itb"),l.i32_const(s))),l.setLocal("itr",l.i32_add(l.getLocal("itr"),l.i32_const(s))),l.br(0))))}return f(),g(),I(),t.exportFunction(n+"_buildABC"),t.exportFunction(n+"_joinABC"),t.exportFunction(n+"_batchAdd"),n},Ka=function(t,n,o,a,s,f,g,I){const u=t.addFunction(n);u.addParam("pIn","i32"),u.addParam("n","i32"),u.addParam("pFirst","i32"),u.addParam("pInc","i32"),u.addParam("pOut","i32"),u.addLocal("pOldFree","i32"),u.addLocal("i","i32"),u.addLocal("pFrom","i32"),u.addLocal("pTo","i32");const l=u.getCodeBuilder(),E=l.i32_const(t.alloc(g));u.addCode(l.setLocal("pFrom",l.getLocal("pIn")),l.setLocal("pTo",l.getLocal("pOut"))),u.addCode(l.call(a+"_copy",l.getLocal("pFirst"),E)),u.addCode(l.setLocal("i",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("n"))),l.call(I,l.getLocal("pFrom"),E,l.getLocal("pTo")),l.setLocal("pFrom",l.i32_add(l.getLocal("pFrom"),l.i32_const(s))),l.setLocal("pTo",l.i32_add(l.getLocal("pTo"),l.i32_const(f))),l.call(a+"_mul",E,l.getLocal("pInc"),E),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0)))),t.exportFunction(n)};const Ft=_n,vc=vo,xc=Ma,Ha=qa,Pc=Ua,Va=Da,Po=Ga,Oc=Ra,Qc=Na,Gn=Ka,{bitLength:Mc,modInv:qc,isOdd:$a,isNegative:Uc}=Kt;var zc=function(t,n){const o=n||"bn128";if(t.modules[o])return o;const a=21888242871839275222246405745257275088696311157297823662689037894645226208583n,s=21888242871839275222246405745257275088548364400416034343698204186575808495617n,f=Math.floor((Mc(a-1n)-1)/64)+1,g=f*8,I=g,u=g,l=u*2,E=u*12,F=t.alloc(Ft.bigInt2BytesLE(s,I)),A=vc(t,a,"f1m");xc(t,s,"fr","frm");const k=t.alloc(Ft.bigInt2BytesLE(U(3n),u)),D=Va(t,"g1m","f1m",k);Po(t,"frm","frm","frm","frm_mul"),Oc(t,"pol","frm"),Qc(t,"qap","frm");const B=Ha(t,"f1m_neg","f2m","f1m"),G=t.alloc([...Ft.bigInt2BytesLE(U(19485874751759354771024239261021720505790618469301721065564631296452457478373n),u),...Ft.bigInt2BytesLE(U(266929791119991161246907387137283842545076965332900288569378510910307636690n),u)]),S=Va(t,"g2m","f2m",G);function st(N,r){const d=t.addFunction(N);d.addParam("pG","i32"),d.addParam("pFr","i32"),d.addParam("pr","i32");const Q=d.getCodeBuilder(),q=Q.i32_const(t.alloc(g));d.addCode(Q.call("frm_fromMontgomery",Q.getLocal("pFr"),q),Q.call(r,Q.getLocal("pG"),q,Q.i32_const(g),Q.getLocal("pr"))),t.exportFunction(N)}st("g1m_timesFr","g1m_timesScalar"),Po(t,"g1m","g1m","frm","g1m_timesFr"),st("g2m_timesFr","g2m_timesScalar"),Po(t,"g2m","g2m","frm","g2m_timesFr"),st("g1m_timesFrAffine","g1m_timesScalarAffine"),st("g2m_timesFrAffine","g2m_timesScalarAffine"),Gn(t,"frm_batchApplyKey","fmr","frm",g,g,g,"frm_mul"),Gn(t,"g1m_batchApplyKey","g1m","frm",g*3,g*3,g,"g1m_timesFr"),Gn(t,"g1m_batchApplyKeyMixed","g1m","frm",g*2,g*3,g,"g1m_timesFrAffine"),Gn(t,"g2m_batchApplyKey","g2m","frm",g*2*3,g*3*2,g,"g2m_timesFr"),Gn(t,"g2m_batchApplyKeyMixed","g2m","frm",g*2*2,g*3*2,g,"g2m_timesFrAffine");function U(N){return BigInt(N)*(1n<<BigInt(u*8))%a}const lt=[1n,2n,1n],w=t.alloc([...Ft.bigInt2BytesLE(U(lt[0]),u),...Ft.bigInt2BytesLE(U(lt[1]),u),...Ft.bigInt2BytesLE(U(lt[2]),u)]),_=[0n,1n,0n],p=t.alloc([...Ft.bigInt2BytesLE(U(_[0]),u),...Ft.bigInt2BytesLE(U(_[1]),u),...Ft.bigInt2BytesLE(U(_[2]),u)]),V=[[10857046999023057135944570762232829481370756359578518086990519993285655852781n,11559732032986387107991004021392285783925812861821192530917403151452391805634n],[8495653923123431417604973247489272438418190587263600148770280649306958101930n,4082367875863433681332203403145435568316851327593401208105741076214120093531n],[1n,0n]],j=t.alloc([...Ft.bigInt2BytesLE(U(V[0][0]),u),...Ft.bigInt2BytesLE(U(V[0][1]),u),...Ft.bigInt2BytesLE(U(V[1][0]),u),...Ft.bigInt2BytesLE(U(V[1][1]),u),...Ft.bigInt2BytesLE(U(V[2][0]),u),...Ft.bigInt2BytesLE(U(V[2][1]),u)]),X=[[0n,0n],[1n,0n],[0n,0n]],O=t.alloc([...Ft.bigInt2BytesLE(U(X[0][0]),u),...Ft.bigInt2BytesLE(U(X[0][1]),u),...Ft.bigInt2BytesLE(U(X[1][0]),u),...Ft.bigInt2BytesLE(U(X[1][1]),u),...Ft.bigInt2BytesLE(U(X[2][0]),u),...Ft.bigInt2BytesLE(U(X[2][1]),u)]),b=t.alloc([...Ft.bigInt2BytesLE(U(1),u),...Ft.bigInt2BytesLE(U(0),u),...Ft.bigInt2BytesLE(U(0),u),...Ft.bigInt2BytesLE(U(0),u),...Ft.bigInt2BytesLE(U(0),u),...Ft.bigInt2BytesLE(U(0),u),...Ft.bigInt2BytesLE(U(0),u),...Ft.bigInt2BytesLE(U(0),u),...Ft.bigInt2BytesLE(U(0),u),...Ft.bigInt2BytesLE(U(0),u),...Ft.bigInt2BytesLE(U(0),u),...Ft.bigInt2BytesLE(U(0),u)]),x=t.alloc([...Ft.bigInt2BytesLE(U(9),u),...Ft.bigInt2BytesLE(U(1),u)]),z=t.alloc([...Ft.bigInt2BytesLE(U(qc(2n,a)),u),...Ft.bigInt2BytesLE(0n,u)]),ot=x,tt=t.alloc([...Ft.bigInt2BytesLE(U(19485874751759354771024239261021720505790618469301721065564631296452457478373n),u),...Ft.bigInt2BytesLE(U(266929791119991161246907387137283842545076965332900288569378510910307636690n),u)]);function K(){const N=t.addFunction(o+"_mulNR6");N.addParam("x","i32"),N.addParam("pr","i32");const r=N.getCodeBuilder();N.addCode(r.call(B+"_mul",r.i32_const(x),r.getLocal("x"),r.getLocal("pr")))}K();const it=Pc(t,o+"_mulNR6","f6m","f2m");function J(){const N=t.addFunction(o+"_mulNR12");N.addParam("x","i32"),N.addParam("pr","i32");const r=N.getCodeBuilder();N.addCode(r.call(B+"_mul",r.i32_const(x),r.i32_add(r.getLocal("x"),r.i32_const(g*4)),r.getLocal("pr")),r.call(B+"_copy",r.getLocal("x"),r.i32_add(r.getLocal("pr"),r.i32_const(g*2))),r.call(B+"_copy",r.i32_add(r.getLocal("x"),r.i32_const(g*2)),r.i32_add(r.getLocal("pr"),r.i32_const(g*4))))}J();const et=Ha(t,o+"_mulNR12","ftm",it),wt=W(29793968203157093288n),ft=t.alloc(wt),L=3*l,i=wt.length-1,c=wt.reduce((N,r)=>N+(r!=0?1:0),0)+i+1,m=6*g,y=3*g*2+c*L;t.modules[o]={n64:f,pG1gen:w,pG1zero:p,pG1b:k,pG2gen:j,pG2zero:O,pG2b:G,pq:t.modules.f1m.pq,pr:F,pOneT:b,prePSize:m,preQSize:y,r:s.toString(),q:a.toString()};const h=4965661367192848881n;function v(N){let r=N;const d=[];for(;r>0n;){if($a(r)){const Q=2-Number(r%4n);d.push(Q),r=r-BigInt(Q)}else d.push(0);r=r>>1n}return d}function W(N){let r=N;const d=[];for(;r>0n;)$a(r)?d.push(1):d.push(0),r=r>>1n;return d}function R(){const N=t.addFunction(o+"_prepareG1");N.addParam("pP","i32"),N.addParam("ppreP","i32");const r=N.getCodeBuilder();N.addCode(r.call(D+"_normalize",r.getLocal("pP"),r.getLocal("ppreP")))}function at(){const N=t.addFunction(o+"_prepAddStep");N.addParam("pQ","i32"),N.addParam("pR","i32"),N.addParam("pCoef","i32");const r=N.getCodeBuilder(),d=r.getLocal("pQ"),Q=r.i32_add(r.getLocal("pQ"),r.i32_const(l)),q=r.getLocal("pR"),P=r.i32_add(r.getLocal("pR"),r.i32_const(l)),T=r.i32_add(r.getLocal("pR"),r.i32_const(2*l)),M=r.getLocal("pCoef"),$=r.i32_add(r.getLocal("pCoef"),r.i32_const(l)),Y=r.i32_add(r.getLocal("pCoef"),r.i32_const(2*l)),Z=$,H=r.i32_const(t.alloc(l)),nt=r.i32_const(t.alloc(l)),ut=r.i32_const(t.alloc(l)),_t=r.i32_const(t.alloc(l)),ct=r.i32_const(t.alloc(l)),At=r.i32_const(t.alloc(l)),Ct=r.i32_const(t.alloc(l));N.addCode(r.call(B+"_mul",d,T,Z),r.call(B+"_sub",q,Z,Z),r.call(B+"_mul",Q,T,H),r.call(B+"_sub",P,H,H),r.call(B+"_square",Z,nt),r.call(B+"_square",H,ut),r.call(B+"_mul",Z,nt,_t),r.call(B+"_mul",q,nt,ct),r.call(B+"_add",ct,ct,Ct),r.call(B+"_mul",T,ut,At),r.call(B+"_add",_t,At,At),r.call(B+"_sub",At,Ct,At),r.call(B+"_mul",Z,At,q),r.call(B+"_mul",_t,P,P),r.call(B+"_sub",ct,At,Ct),r.call(B+"_mul",H,Ct,Ct),r.call(B+"_sub",Ct,P,P),r.call(B+"_mul",T,_t,T),r.call(B+"_mul",Z,Q,Ct),r.call(B+"_mul",H,d,M),r.call(B+"_sub",M,Ct,M),r.call(B+"_mul",M,r.i32_const(ot),M),r.call(B+"_neg",H,Y))}function yt(){const N=t.addFunction(o+"_prepDblStep");N.addParam("pR","i32"),N.addParam("pCoef","i32");const r=N.getCodeBuilder(),d=r.getLocal("pR"),Q=r.i32_add(r.getLocal("pR"),r.i32_const(l)),q=r.i32_add(r.getLocal("pR"),r.i32_const(2*l)),P=r.getLocal("pCoef"),T=r.i32_add(r.getLocal("pCoef"),r.i32_const(l)),M=r.i32_add(r.getLocal("pCoef"),r.i32_const(2*l)),$=r.i32_const(t.alloc(l)),Y=r.i32_const(t.alloc(l)),Z=r.i32_const(t.alloc(l)),H=r.i32_const(t.alloc(l)),nt=r.i32_const(t.alloc(l)),ut=r.i32_const(t.alloc(l)),_t=r.i32_const(t.alloc(l)),ct=r.i32_const(t.alloc(l)),At=r.i32_const(t.alloc(l)),Ct=r.i32_const(t.alloc(l)),vt=r.i32_const(t.alloc(l)),It=r.i32_const(t.alloc(l));N.addCode(r.call(B+"_mul",Q,r.i32_const(z),$),r.call(B+"_mul",d,$,$),r.call(B+"_square",Q,Y),r.call(B+"_square",q,Z),r.call(B+"_add",Z,Z,H),r.call(B+"_add",H,Z,H),r.call(B+"_mul",r.i32_const(tt),H,nt),r.call(B+"_add",nt,nt,ut),r.call(B+"_add",nt,ut,ut),r.call(B+"_add",Y,ut,_t),r.call(B+"_mul",_t,r.i32_const(z),_t),r.call(B+"_add",Y,Z,It),r.call(B+"_add",Q,q,ct),r.call(B+"_square",ct,ct),r.call(B+"_sub",ct,It,ct),r.call(B+"_sub",nt,Y,At),r.call(B+"_square",d,Ct),r.call(B+"_square",nt,vt),r.call(B+"_sub",Y,ut,It),r.call(B+"_mul",$,It,d),r.call(B+"_add",vt,vt,It),r.call(B+"_add",vt,It,It),r.call(B+"_square",_t,Q),r.call(B+"_sub",Q,It,Q),r.call(B+"_mul",Y,ct,q),r.call(B+"_mul",r.i32_const(ot),At,P),r.call(B+"_neg",ct,T),r.call(B+"_add",Ct,Ct,M),r.call(B+"_add",Ct,M,M))}function dt(){const N=t.addFunction(o+"_mulByQ");N.addParam("p1","i32"),N.addParam("pr","i32");const r=N.getCodeBuilder(),d=r.getLocal("p1"),Q=r.i32_add(r.getLocal("p1"),r.i32_const(l)),q=r.i32_add(r.getLocal("p1"),r.i32_const(l*2)),P=r.getLocal("pr"),T=r.i32_add(r.getLocal("pr"),r.i32_const(l)),M=r.i32_add(r.getLocal("pr"),r.i32_const(l*2)),$=r.i32_const(t.alloc([...Ft.bigInt2BytesLE(U("21575463638280843010398324269430826099269044274347216827212613867836435027261"),u),...Ft.bigInt2BytesLE(U("10307601595873709700152284273816112264069230130616436755625194854815875713954"),u)])),Y=r.i32_const(t.alloc([...Ft.bigInt2BytesLE(U("2821565182194536844548159561693502659359617185244120367078079554186484126554"),u),...Ft.bigInt2BytesLE(U("3505843767911556378687030309984248845540243509899259641013678093033130930403"),u)]));N.addCode(r.call(B+"_conjugate",d,P),r.call(B+"_mul",$,P,P),r.call(B+"_conjugate",Q,T),r.call(B+"_mul",Y,T,T),r.call(B+"_conjugate",q,M))}function Lt(){dt();const N=t.addFunction(o+"_prepareG2");N.addParam("pQ","i32"),N.addParam("ppreQ","i32"),N.addLocal("pCoef","i32"),N.addLocal("i","i32");const r=N.getCodeBuilder(),d=r.getLocal("pQ"),Q=t.alloc(l*3),q=r.i32_const(Q),P=r.i32_const(Q),T=r.i32_const(Q+l),M=r.i32_const(Q+2*l),$=r.i32_add(r.getLocal("ppreQ"),r.i32_const(0)),Y=r.i32_add(r.getLocal("ppreQ"),r.i32_const(l)),Z=t.alloc(l*3),H=r.i32_const(Z),nt=t.alloc(l*3),ut=r.i32_const(nt),_t=r.i32_const(nt+l);N.addCode(r.call(S+"_normalize",d,$),r.call(B+"_copy",$,P),r.call(B+"_copy",Y,T),r.call(B+"_one",M)),N.addCode(r.setLocal("pCoef",r.i32_add(r.getLocal("ppreQ"),r.i32_const(l*3))),r.setLocal("i",r.i32_const(wt.length-2)),r.block(r.loop(r.call(o+"_prepDblStep",q,r.getLocal("pCoef")),r.setLocal("pCoef",r.i32_add(r.getLocal("pCoef"),r.i32_const(L))),r.if(r.i32_load8_s(r.getLocal("i"),ft),[...r.call(o+"_prepAddStep",$,q,r.getLocal("pCoef")),...r.setLocal("pCoef",r.i32_add(r.getLocal("pCoef"),r.i32_const(L)))]),r.br_if(1,r.i32_eqz(r.getLocal("i"))),r.setLocal("i",r.i32_sub(r.getLocal("i"),r.i32_const(1))),r.br(0)))),N.addCode(r.call(o+"_mulByQ",$,H),r.call(o+"_mulByQ",H,ut)),N.addCode(r.call(B+"_neg",_t,_t),r.call(o+"_prepAddStep",H,q,r.getLocal("pCoef")),r.setLocal("pCoef",r.i32_add(r.getLocal("pCoef"),r.i32_const(L))),r.call(o+"_prepAddStep",ut,q,r.getLocal("pCoef")),r.setLocal("pCoef",r.i32_add(r.getLocal("pCoef"),r.i32_const(L))))}function St(){const N=t.addFunction(o+"__mulBy024Old");N.addParam("pEll0","i32"),N.addParam("pEllVW","i32"),N.addParam("pEllVV","i32"),N.addParam("pR","i32");const r=N.getCodeBuilder(),d=r.getLocal("pEll0"),Q=r.getLocal("pEllVV"),q=r.getLocal("pEllVW"),P=r.getLocal("pR"),T=t.alloc(E),M=r.i32_const(T),$=r.i32_const(T),Y=r.i32_const(T+l),Z=r.i32_const(T+l*2),H=r.i32_const(T+l*3),nt=r.i32_const(T+l*4),ut=r.i32_const(T+l*5);N.addCode(r.call(B+"_copy",d,$),r.call(B+"_zero",Y),r.call(B+"_copy",Q,Z),r.call(B+"_zero",H),r.call(B+"_copy",q,nt),r.call(B+"_zero",ut),r.call(et+"_mul",M,P,P))}function gt(){const N=t.addFunction(o+"__mulBy024");N.addParam("pEll0","i32"),N.addParam("pEllVW","i32"),N.addParam("pEllVV","i32"),N.addParam("pR","i32");const r=N.getCodeBuilder(),d=r.getLocal("pEll0"),Q=r.getLocal("pEllVV"),q=r.getLocal("pEllVW"),P=r.getLocal("pR"),T=r.i32_add(r.getLocal("pR"),r.i32_const(2*g)),M=r.i32_add(r.getLocal("pR"),r.i32_const(4*g)),$=r.i32_add(r.getLocal("pR"),r.i32_const(6*g)),Y=r.i32_add(r.getLocal("pR"),r.i32_const(8*g)),Z=r.i32_add(r.getLocal("pR"),r.i32_const(10*g)),H=r.i32_const(t.alloc(l)),nt=r.i32_const(t.alloc(l)),ut=r.i32_const(t.alloc(l)),_t=r.i32_const(t.alloc(l)),ct=r.i32_const(t.alloc(l)),At=r.i32_const(t.alloc(l)),Ct=r.i32_const(t.alloc(l)),vt=r.i32_const(t.alloc(l)),It=r.i32_const(t.alloc(l)),mt=r.i32_const(t.alloc(l)),ht=r.i32_const(t.alloc(l));N.addCode(r.call(B+"_mul",P,d,Ct),r.call(B+"_mul",M,Q,vt),r.call(B+"_mul",Y,q,It),r.call(B+"_add",P,Y,ut),r.call(B+"_add",P,M,nt),r.call(B+"_add",T,$,_t),r.call(B+"_add",_t,Z,_t),r.call(B+"_mul",T,Q,mt),r.call(B+"_add",mt,It,ct),r.call(B+"_mul",r.i32_const(x),ct,At),r.call(B+"_add",At,Ct,P),r.call(B+"_mul",Z,q,ct),r.call(B+"_add",mt,ct,mt),r.call(B+"_add",ct,vt,ct),r.call(B+"_mul",r.i32_const(x),ct,At),r.call(B+"_mul",T,d,ct),r.call(B+"_add",mt,ct,mt),r.call(B+"_add",At,ct,T),r.call(B+"_add",d,Q,H),r.call(B+"_mul",nt,H,ct),r.call(B+"_add",Ct,vt,ht),r.call(B+"_sub",ct,ht,ct),r.call(B+"_mul",$,q,At),r.call(B+"_add",mt,At,mt),r.call(B+"_add",M,Y,H),r.call(B+"_add",ct,At,M),r.call(B+"_add",Q,q,nt),r.call(B+"_mul",nt,H,ct),r.call(B+"_add",vt,It,ht),r.call(B+"_sub",ct,ht,ct),r.call(B+"_mul",r.i32_const(x),ct,At),r.call(B+"_mul",$,d,ct),r.call(B+"_add",mt,ct,mt),r.call(B+"_add",At,ct,$),r.call(B+"_mul",Z,Q,ct),r.call(B+"_add",mt,ct,mt),r.call(B+"_mul",r.i32_const(x),ct,At),r.call(B+"_add",d,q,H),r.call(B+"_mul",ut,H,ct),r.call(B+"_add",Ct,It,ht),r.call(B+"_sub",ct,ht,ct),r.call(B+"_add",At,ct,Y),r.call(B+"_add",d,Q,H),r.call(B+"_add",H,q,H),r.call(B+"_mul",_t,H,ct),r.call(B+"_sub",ct,mt,Z))}function rt(){const N=t.addFunction(o+"_millerLoop");N.addParam("ppreP","i32"),N.addParam("ppreQ","i32"),N.addParam("r","i32"),N.addLocal("pCoef","i32"),N.addLocal("i","i32");const r=N.getCodeBuilder(),d=r.getLocal("ppreP"),Q=r.i32_add(r.getLocal("ppreP"),r.i32_const(u)),q=r.getLocal("pCoef"),P=r.i32_add(r.getLocal("pCoef"),r.i32_const(l)),T=r.i32_add(r.getLocal("pCoef"),r.i32_const(2*l)),M=t.alloc(l),$=r.i32_const(M),Y=t.alloc(l),Z=r.i32_const(Y),H=r.getLocal("r");N.addCode(r.call(et+"_one",H),r.setLocal("pCoef",r.i32_add(r.getLocal("ppreQ"),r.i32_const(l*3))),r.setLocal("i",r.i32_const(wt.length-2)),r.block(r.loop(r.call(et+"_square",H,H),r.call(B+"_mul1",P,Q,$),r.call(B+"_mul1",T,d,Z),r.call(o+"__mulBy024",q,$,Z,H),r.setLocal("pCoef",r.i32_add(r.getLocal("pCoef"),r.i32_const(L))),r.if(r.i32_load8_s(r.getLocal("i"),ft),[...r.call(B+"_mul1",P,Q,$),...r.call(B+"_mul1",T,d,Z),...r.call(o+"__mulBy024",q,$,Z,H),...r.setLocal("pCoef",r.i32_add(r.getLocal("pCoef"),r.i32_const(L)))]),r.br_if(1,r.i32_eqz(r.getLocal("i"))),r.setLocal("i",r.i32_sub(r.getLocal("i"),r.i32_const(1))),r.br(0)))),N.addCode(r.call(B+"_mul1",P,Q,$),r.call(B+"_mul1",T,d,Z),r.call(o+"__mulBy024",q,$,Z,H),r.setLocal("pCoef",r.i32_add(r.getLocal("pCoef"),r.i32_const(L))),r.call(B+"_mul1",P,Q,$),r.call(B+"_mul1",T,d,Z),r.call(o+"__mulBy024",q,$,Z,H),r.setLocal("pCoef",r.i32_add(r.getLocal("pCoef"),r.i32_const(L))))}function bt(N){const r=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[8376118865763821496583973867626364092589906065868298776909617916018768340080n,16469823323077808223889137241176536799009286646108169935659301613961712198316n],[21888242871839275220042445260109153167277707414472061641714758635765020556617n,0n],[11697423496358154304825782922584725312912383441159505038794027105778954184319n,303847389135065887422783454877609941456349188919719272345083954437860409601n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[3321304630594332808241809054958361220322477375291206261884409189760185844239n,5722266937896532885780051958958348231143373700109372999374820235121374419868n],[21888242871839275222246405745257275088696311157297823662689037894645226208582n,0n],[13512124006075453725662431877630910996106405091429524885779419978626457868503n,5418419548761466998357268504080738289687024511189653727029736280683514010267n],[2203960485148121921418603742825762020974279258880205651966n,0n],[10190819375481120917420622822672549775783927716138318623895010788866272024264n,21584395482704209334823622290379665147239961968378104390343953940207365798982n],[2203960485148121921418603742825762020974279258880205651967n,0n],[18566938241244942414004596690298913868373833782006617400804628704885040364344n,16165975933942742336466353786298926857552937457188450663314217659523851788715n]]],d=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[21575463638280843010398324269430826099269044274347216827212613867836435027261n,10307601595873709700152284273816112264069230130616436755625194854815875713954n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[3772000881919853776433695186713858239009073593817195771773381919316419345261n,2236595495967245188281701248203181795121068902605861227855261137820944008926n],[2203960485148121921418603742825762020974279258880205651966n,0n],[18429021223477853657660792034369865839114504446431234726392080002137598044644n,9344045779998320333812420223237981029506012124075525679208581902008406485703n]],[[1n,0n],[2581911344467009335267311115468803099551665605076196740867805258568234346338n,19937756971775647987995932169929341994314640652964949448313374472400716661030n],[2203960485148121921418603742825762020974279258880205651966n,0n],[5324479202449903542726783395506214481928257762400643279780343368557297135718n,16208900380737693084919495127334387981393726419856888799917914180988844123039n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[13981852324922362344252311234282257507216387789820983642040889267519694726527n,7629828391165209371577384193250820201684255241773809077146787135900891633097n]]],Q=t.addFunction(o+"__frobeniusMap"+N);Q.addParam("x","i32"),Q.addParam("r","i32");const q=Q.getCodeBuilder();for(let T=0;T<6;T++){const M=T==0?q.getLocal("x"):q.i32_add(q.getLocal("x"),q.i32_const(T*l)),$=M,Y=q.i32_add(q.getLocal("x"),q.i32_const(T*l+u)),Z=T==0?q.getLocal("r"):q.i32_add(q.getLocal("r"),q.i32_const(T*l)),H=Z,nt=q.i32_add(q.getLocal("r"),q.i32_const(T*l+u)),ut=P(r[Math.floor(T/3)][N%12],d[T%3][N%6]),_t=t.alloc([...Ft.bigInt2BytesLE(U(ut[0]),32),...Ft.bigInt2BytesLE(U(ut[1]),32)]);N%2==1?Q.addCode(q.call(A+"_copy",$,H),q.call(A+"_neg",Y,nt),q.call(B+"_mul",Z,q.i32_const(_t),Z)):Q.addCode(q.call(B+"_mul",M,q.i32_const(_t),Z))}function P(T,M){const $=BigInt(T[0]),Y=BigInt(T[1]),Z=BigInt(M[0]),H=BigInt(M[1]),nt=[($*Z-Y*H)%a,($*H+Y*Z)%a];return Uc(nt[0])&&(nt[0]=nt[0]+a),nt}}function xt(){const N=t.addFunction(o+"__finalExponentiationFirstChunk");N.addParam("x","i32"),N.addParam("r","i32");const r=N.getCodeBuilder(),d=r.getLocal("x"),Q=d,q=r.i32_add(d,r.i32_const(g*6)),P=r.getLocal("r"),T=t.alloc(E),M=r.i32_const(T),$=M,Y=r.i32_const(T+g*6),Z=r.i32_const(t.alloc(E)),H=r.i32_const(t.alloc(E)),nt=r.i32_const(t.alloc(E));N.addCode(r.call(it+"_copy",Q,$),r.call(it+"_neg",q,Y),r.call(et+"_inverse",d,Z),r.call(et+"_mul",M,Z,H),r.call(o+"__frobeniusMap2",H,nt),r.call(et+"_mul",H,nt,P))}function Mt(){const N=t.addFunction(o+"__cyclotomicSquare");N.addParam("x","i32"),N.addParam("r","i32");const r=N.getCodeBuilder(),d=r.getLocal("x"),Q=r.i32_add(r.getLocal("x"),r.i32_const(l)),q=r.i32_add(r.getLocal("x"),r.i32_const(2*l)),P=r.i32_add(r.getLocal("x"),r.i32_const(3*l)),T=r.i32_add(r.getLocal("x"),r.i32_const(4*l)),M=r.i32_add(r.getLocal("x"),r.i32_const(5*l)),$=r.getLocal("r"),Y=r.i32_add(r.getLocal("r"),r.i32_const(l)),Z=r.i32_add(r.getLocal("r"),r.i32_const(2*l)),H=r.i32_add(r.getLocal("r"),r.i32_const(3*l)),nt=r.i32_add(r.getLocal("r"),r.i32_const(4*l)),ut=r.i32_add(r.getLocal("r"),r.i32_const(5*l)),_t=r.i32_const(t.alloc(l)),ct=r.i32_const(t.alloc(l)),At=r.i32_const(t.alloc(l)),Ct=r.i32_const(t.alloc(l)),vt=r.i32_const(t.alloc(l)),It=r.i32_const(t.alloc(l)),mt=r.i32_const(t.alloc(l)),ht=r.i32_const(t.alloc(l));N.addCode(r.call(B+"_mul",d,T,mt),r.call(B+"_mul",T,r.i32_const(x),_t),r.call(B+"_add",d,_t,_t),r.call(B+"_add",d,T,ht),r.call(B+"_mul",ht,_t,_t),r.call(B+"_mul",r.i32_const(x),mt,ht),r.call(B+"_add",mt,ht,ht),r.call(B+"_sub",_t,ht,_t),r.call(B+"_add",mt,mt,ct),r.call(B+"_mul",P,q,mt),r.call(B+"_mul",q,r.i32_const(x),At),r.call(B+"_add",P,At,At),r.call(B+"_add",P,q,ht),r.call(B+"_mul",ht,At,At),r.call(B+"_mul",r.i32_const(x),mt,ht),r.call(B+"_add",mt,ht,ht),r.call(B+"_sub",At,ht,At),r.call(B+"_add",mt,mt,Ct),r.call(B+"_mul",Q,M,mt),r.call(B+"_mul",M,r.i32_const(x),vt),r.call(B+"_add",Q,vt,vt),r.call(B+"_add",Q,M,ht),r.call(B+"_mul",ht,vt,vt),r.call(B+"_mul",r.i32_const(x),mt,ht),r.call(B+"_add",mt,ht,ht),r.call(B+"_sub",vt,ht,vt),r.call(B+"_add",mt,mt,It),r.call(B+"_sub",_t,d,$),r.call(B+"_add",$,$,$),r.call(B+"_add",_t,$,$),r.call(B+"_add",ct,T,nt),r.call(B+"_add",nt,nt,nt),r.call(B+"_add",ct,nt,nt),r.call(B+"_mul",It,r.i32_const(ot),ht),r.call(B+"_add",ht,P,H),r.call(B+"_add",H,H,H),r.call(B+"_add",ht,H,H),r.call(B+"_sub",vt,q,Z),r.call(B+"_add",Z,Z,Z),r.call(B+"_add",vt,Z,Z),r.call(B+"_sub",At,Q,Y),r.call(B+"_add",Y,Y,Y),r.call(B+"_add",At,Y,Y),r.call(B+"_add",Ct,M,ut),r.call(B+"_add",ut,ut,ut),r.call(B+"_add",Ct,ut,ut))}function Vt(N,r){const d=v(N).map(Y=>Y==-1?255:Y),Q=t.alloc(d),q=t.addFunction(o+"__cyclotomicExp_"+r);q.addParam("x","i32"),q.addParam("r","i32"),q.addLocal("bit","i32"),q.addLocal("i","i32");const P=q.getCodeBuilder(),T=P.getLocal("x"),M=P.getLocal("r"),$=P.i32_const(t.alloc(E));q.addCode(P.call(et+"_conjugate",T,$),P.call(et+"_one",M),P.if(P.teeLocal("bit",P.i32_load8_s(P.i32_const(d.length-1),Q)),P.if(P.i32_eq(P.getLocal("bit"),P.i32_const(1)),P.call(et+"_mul",M,T,M),P.call(et+"_mul",M,$,M))),P.setLocal("i",P.i32_const(d.length-2)),P.block(P.loop(P.call(o+"__cyclotomicSquare",M,M),P.if(P.teeLocal("bit",P.i32_load8_s(P.getLocal("i"),Q)),P.if(P.i32_eq(P.getLocal("bit"),P.i32_const(1)),P.call(et+"_mul",M,T,M),P.call(et+"_mul",M,$,M))),P.br_if(1,P.i32_eqz(P.getLocal("i"))),P.setLocal("i",P.i32_sub(P.getLocal("i"),P.i32_const(1))),P.br(0))))}function Dt(){Mt(),Vt(h,"w0");const N=t.addFunction(o+"__finalExponentiationLastChunk");N.addParam("x","i32"),N.addParam("r","i32");const r=N.getCodeBuilder(),d=r.getLocal("x"),Q=r.getLocal("r"),q=r.i32_const(t.alloc(E)),P=r.i32_const(t.alloc(E)),T=r.i32_const(t.alloc(E)),M=r.i32_const(t.alloc(E)),$=r.i32_const(t.alloc(E)),Y=r.i32_const(t.alloc(E)),Z=r.i32_const(t.alloc(E)),H=r.i32_const(t.alloc(E)),nt=r.i32_const(t.alloc(E)),ut=r.i32_const(t.alloc(E)),_t=r.i32_const(t.alloc(E)),ct=r.i32_const(t.alloc(E)),At=r.i32_const(t.alloc(E)),Ct=r.i32_const(t.alloc(E)),vt=r.i32_const(t.alloc(E)),It=r.i32_const(t.alloc(E)),mt=r.i32_const(t.alloc(E)),ht=r.i32_const(t.alloc(E)),Pt=r.i32_const(t.alloc(E)),Nt=r.i32_const(t.alloc(E)),Jt=r.i32_const(t.alloc(E));N.addCode(r.call(o+"__cyclotomicExp_w0",d,q),r.call(et+"_conjugate",q,q),r.call(o+"__cyclotomicSquare",q,P),r.call(o+"__cyclotomicSquare",P,T),r.call(et+"_mul",T,P,M),r.call(o+"__cyclotomicExp_w0",M,$),r.call(et+"_conjugate",$,$),r.call(o+"__cyclotomicSquare",$,Y),r.call(o+"__cyclotomicExp_w0",Y,Z),r.call(et+"_conjugate",Z,Z),r.call(et+"_conjugate",M,H),r.call(et+"_conjugate",Z,nt),r.call(et+"_mul",nt,$,ut),r.call(et+"_mul",ut,H,_t),r.call(et+"_mul",_t,P,ct),r.call(et+"_mul",_t,$,At),r.call(et+"_mul",At,d,Ct),r.call(o+"__frobeniusMap1",ct,vt),r.call(et+"_mul",vt,Ct,It),r.call(o+"__frobeniusMap2",_t,mt),r.call(et+"_mul",mt,It,ht),r.call(et+"_conjugate",d,Pt),r.call(et+"_mul",Pt,ct,Nt),r.call(o+"__frobeniusMap3",Nt,Jt),r.call(et+"_mul",Jt,ht,Q))}function $t(){xt(),Dt();const N=t.addFunction(o+"_finalExponentiation");N.addParam("x","i32"),N.addParam("r","i32");const r=N.getCodeBuilder(),d=r.getLocal("x"),Q=r.getLocal("r"),q=r.i32_const(t.alloc(E));N.addCode(r.call(o+"__finalExponentiationFirstChunk",d,q),r.call(o+"__finalExponentiationLastChunk",q,Q))}function qt(){const N=t.addFunction(o+"_finalExponentiationOld");N.addParam("x","i32"),N.addParam("r","i32");const d=t.alloc(Ft.bigInt2BytesLE(552484233613224096312617126783173147097382103762957654188882734314196910839907541213974502761540629817009608548654680343627701153829446747810907373256841551006201639677726139946029199968412598804882391702273019083653272047566316584365559776493027495458238373902875937659943504873220554161550525926302303331747463515644711876653177129578303191095900909191624817826566688241804408081892785725967931714097716709526092261278071952560171111444072049229123565057483750161460024353346284167282452756217662335528813519139808291170539072125381230815729071544861602750936964829313608137325426383735122175229541155376346436093930287402089517426973178917569713384748081827255472576937471496195752727188261435633271238710131736096299798168852925540549342330775279877006784354801422249722573783561685179618816480037695005515426162362431072245638324744480n,352)),Q=N.getCodeBuilder();N.addCode(Q.call(et+"_exp",Q.getLocal("x"),Q.i32_const(d),Q.i32_const(352),Q.getLocal("r")))}const Tt=t.alloc(m),Rt=t.alloc(y);function Xt(N){const r=t.addFunction(o+"_pairingEq"+N);for(let P=0;P<N;P++)r.addParam("p_"+P,"i32"),r.addParam("q_"+P,"i32");r.addParam("c","i32"),r.setReturnType("i32");const d=r.getCodeBuilder(),Q=d.i32_const(t.alloc(E)),q=d.i32_const(t.alloc(E));r.addCode(d.call(et+"_one",Q));for(let P=0;P<N;P++)r.addCode(d.call(o+"_prepareG1",d.getLocal("p_"+P),d.i32_const(Tt))),r.addCode(d.call(o+"_prepareG2",d.getLocal("q_"+P),d.i32_const(Rt))),r.addCode(d.call(o+"_millerLoop",d.i32_const(Tt),d.i32_const(Rt),q)),r.addCode(d.call(et+"_mul",Q,q,Q));r.addCode(d.call(o+"_finalExponentiation",Q,Q)),r.addCode(d.call(et+"_eq",Q,d.getLocal("c")))}function Yt(){const N=t.addFunction(o+"_pairing");N.addParam("p","i32"),N.addParam("q","i32"),N.addParam("r","i32");const r=N.getCodeBuilder(),d=r.i32_const(t.alloc(E));N.addCode(r.call(o+"_prepareG1",r.getLocal("p"),r.i32_const(Tt))),N.addCode(r.call(o+"_prepareG2",r.getLocal("q"),r.i32_const(Rt))),N.addCode(r.call(o+"_millerLoop",r.i32_const(Tt),r.i32_const(Rt),d)),N.addCode(r.call(o+"_finalExponentiation",d,r.getLocal("r")))}at(),yt(),R(),Lt(),gt(),St(),rt();for(let N=0;N<10;N++)bt(N),t.exportFunction(o+"__frobeniusMap"+N);qt(),$t();for(let N=1;N<=5;N++)Xt(N),t.exportFunction(o+"_pairingEq"+N);Yt(),t.exportFunction(o+"_pairing"),t.exportFunction(o+"_prepareG1"),t.exportFunction(o+"_prepareG2"),t.exportFunction(o+"_millerLoop"),t.exportFunction(o+"_finalExponentiation"),t.exportFunction(o+"_finalExponentiationOld"),t.exportFunction(o+"__mulBy024"),t.exportFunction(o+"__mulBy024Old"),t.exportFunction(o+"__cyclotomicSquare"),t.exportFunction(o+"__cyclotomicExp_w0")};const Bt=_n,kc=vo,Dc=Ma,ja=qa,Tc=Ua,Ya=Da,Oo=Ga,Gc=Ra,Rc=Na,Rn=Ka,{bitLength:Za,isOdd:Ja,isNegative:Nc}=Kt;var Kc=function(t,n){const o=n||"bls12381";if(t.modules[o])return o;const a=0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn,s=0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n,f=Math.floor((Za(a-1n)-1)/64)+1,g=f*8,I=g,u=I*2,l=I*12,E=Math.floor((Za(s-1n)-1)/64)+1,F=E*8,A=F,k=t.alloc(Bt.bigInt2BytesLE(s,A)),D=kc(t,a,"f1m","intq");Dc(t,s,"fr","frm","intr");const B=t.alloc(Bt.bigInt2BytesLE(w(4n),I)),G=Ya(t,"g1m","f1m",B);Oo(t,"frm","frm","frm","frm_mul"),Gc(t,"pol","frm"),Rc(t,"qap","frm");const S=ja(t,"f1m_neg","f2m","f1m"),st=t.alloc([...Bt.bigInt2BytesLE(w(4n),I),...Bt.bigInt2BytesLE(w(4n),I)]),U=Ya(t,"g2m","f2m",st);function lt(r,d){const Q=t.addFunction(r);Q.addParam("pG","i32"),Q.addParam("pFr","i32"),Q.addParam("pr","i32");const q=Q.getCodeBuilder(),P=q.i32_const(t.alloc(F));Q.addCode(q.call("frm_fromMontgomery",q.getLocal("pFr"),P),q.call(d,q.getLocal("pG"),P,q.i32_const(F),q.getLocal("pr"))),t.exportFunction(r)}lt("g1m_timesFr","g1m_timesScalar"),Oo(t,"g1m","g1m","frm","g1m_timesFr"),lt("g2m_timesFr","g2m_timesScalar"),Oo(t,"g2m","g2m","frm","g2m_timesFr"),lt("g1m_timesFrAffine","g1m_timesScalarAffine"),lt("g2m_timesFrAffine","g2m_timesScalarAffine"),Rn(t,"frm_batchApplyKey","fmr","frm",F,F,F,"frm_mul"),Rn(t,"g1m_batchApplyKey","g1m","frm",g*3,g*3,F,"g1m_timesFr"),Rn(t,"g1m_batchApplyKeyMixed","g1m","frm",g*2,g*3,F,"g1m_timesFrAffine"),Rn(t,"g2m_batchApplyKey","g2m","frm",g*2*3,g*3*2,F,"g2m_timesFr"),Rn(t,"g2m_batchApplyKeyMixed","g2m","frm",g*2*2,g*3*2,F,"g2m_timesFrAffine");function w(r){return BigInt(r)*(1n<<BigInt(I*8))%a}const _=[3685416753713387016781088315183077757961620795782546409894578378688607592378376318836054947676345821548104185464507n,1339506544944476473020471379941921221584933875938349620426543736416511423956333506472724655353366534992391756441569n,1n],p=t.alloc([...Bt.bigInt2BytesLE(w(_[0]),I),...Bt.bigInt2BytesLE(w(_[1]),I),...Bt.bigInt2BytesLE(w(_[2]),I)]),V=[0n,1n,0n],j=t.alloc([...Bt.bigInt2BytesLE(w(V[0]),I),...Bt.bigInt2BytesLE(w(V[1]),I),...Bt.bigInt2BytesLE(w(V[2]),I)]),X=[[352701069587466618187139116011060144890029952792775240219908644239793785735715026873347600343865175952761926303160n,3059144344244213709971259814753781636986470325476647558659373206291635324768958432433509563104347017837885763365758n],[1985150602287291935568054521177171638300868978215655730859378665066344726373823718423869104263333984641494340347905n,927553665492332455747201965776037880757740193453592970025027978793976877002675564980949289727957565575433344219582n],[1n,0n]],O=t.alloc([...Bt.bigInt2BytesLE(w(X[0][0]),I),...Bt.bigInt2BytesLE(w(X[0][1]),I),...Bt.bigInt2BytesLE(w(X[1][0]),I),...Bt.bigInt2BytesLE(w(X[1][1]),I),...Bt.bigInt2BytesLE(w(X[2][0]),I),...Bt.bigInt2BytesLE(w(X[2][1]),I)]),b=[[0n,0n],[1n,0n],[0n,0n]],x=t.alloc([...Bt.bigInt2BytesLE(w(b[0][0]),I),...Bt.bigInt2BytesLE(w(b[0][1]),I),...Bt.bigInt2BytesLE(w(b[1][0]),I),...Bt.bigInt2BytesLE(w(b[1][1]),I),...Bt.bigInt2BytesLE(w(b[2][0]),I),...Bt.bigInt2BytesLE(w(b[2][1]),I)]),z=t.alloc([...Bt.bigInt2BytesLE(w(1n),I),...Bt.bigInt2BytesLE(w(0n),I),...Bt.bigInt2BytesLE(w(0n),I),...Bt.bigInt2BytesLE(w(0n),I),...Bt.bigInt2BytesLE(w(0n),I),...Bt.bigInt2BytesLE(w(0n),I),...Bt.bigInt2BytesLE(w(0n),I),...Bt.bigInt2BytesLE(w(0n),I),...Bt.bigInt2BytesLE(w(0n),I),...Bt.bigInt2BytesLE(w(0n),I),...Bt.bigInt2BytesLE(w(0n),I),...Bt.bigInt2BytesLE(w(0n),I)]),ot=t.alloc([...Bt.bigInt2BytesLE(w(1n),I),...Bt.bigInt2BytesLE(w(1n),I)]);function tt(){const r=t.addFunction(S+"_mulNR");r.addParam("x","i32"),r.addParam("pr","i32");const d=r.getCodeBuilder(),Q=d.i32_const(t.alloc(I)),q=d.getLocal("x"),P=d.i32_add(d.getLocal("x"),d.i32_const(I)),T=d.getLocal("pr"),M=d.i32_add(d.getLocal("pr"),d.i32_const(I));r.addCode(d.call(D+"_copy",q,Q),d.call(D+"_sub",q,P,T),d.call(D+"_add",Q,P,M))}tt();const K=Tc(t,S+"_mulNR","f6m","f2m");function it(){const r=t.addFunction(K+"_mulNR");r.addParam("x","i32"),r.addParam("pr","i32");const d=r.getCodeBuilder(),Q=d.i32_const(t.alloc(I*2));r.addCode(d.call(S+"_copy",d.getLocal("x"),Q),d.call(S+"_mulNR",d.i32_add(d.getLocal("x"),d.i32_const(g*4)),d.getLocal("pr")),d.call(S+"_copy",d.i32_add(d.getLocal("x"),d.i32_const(g*2)),d.i32_add(d.getLocal("pr"),d.i32_const(g*4))),d.call(S+"_copy",Q,d.i32_add(d.getLocal("pr"),d.i32_const(g*2))))}it();const J=ja(t,K+"_mulNR","ftm",K),pt=W(0xd201000000010000n),wt=t.alloc(pt),ft=3*u,L=pt.length-1,C=pt.reduce((r,d)=>r+(d!=0?1:0),0)+L+1,c=6*g,m=3*g*2+C*ft,y=!0,h=15132376222941642752n;t.modules[o]={n64q:f,n64r:E,n8q:g,n8r:F,pG1gen:p,pG1zero:j,pG1b:B,pG2gen:O,pG2zero:x,pG2b:st,pq:t.modules.f1m.pq,pr:k,pOneT:z,r:s,q:a,prePSize:c,preQSize:m};function v(r){let d=r;const Q=[];for(;d>0n;){if(Ja(d)){const q=2-Number(d%4n);Q.push(q),d=d-BigInt(q)}else Q.push(0);d=d>>1n}return Q}function W(r){let d=r;const Q=[];for(;d>0n;)Ja(d)?Q.push(1):Q.push(0),d=d>>1n;return Q}function R(){const r=t.addFunction(o+"_prepareG1");r.addParam("pP","i32"),r.addParam("ppreP","i32");const d=r.getCodeBuilder();r.addCode(d.call(G+"_normalize",d.getLocal("pP"),d.getLocal("ppreP")))}function at(){const r=t.addFunction(o+"_prepDblStep");r.addParam("R","i32"),r.addParam("r","i32");const d=r.getCodeBuilder(),Q=d.getLocal("R"),q=d.i32_add(d.getLocal("R"),d.i32_const(2*g)),P=d.i32_add(d.getLocal("R"),d.i32_const(4*g)),T=d.getLocal("r"),M=d.i32_add(d.getLocal("r"),d.i32_const(2*g)),$=d.i32_add(d.getLocal("r"),d.i32_const(4*g)),Y=d.i32_const(t.alloc(u)),Z=d.i32_const(t.alloc(u)),H=d.i32_const(t.alloc(u)),nt=d.i32_const(t.alloc(u)),ut=d.i32_const(t.alloc(u));r.addCode(d.call(S+"_square",Q,T),d.call(S+"_square",q,Z),d.call(S+"_square",Z,H),d.call(S+"_add",Z,Q,M),d.call(S+"_square",M,M),d.call(S+"_sub",M,T,M),d.call(S+"_sub",M,H,M),d.call(S+"_add",M,M,M),d.call(S+"_add",T,T,nt),d.call(S+"_add",nt,T,nt),d.call(S+"_add",Q,nt,$),d.call(S+"_square",nt,ut),d.call(S+"_square",P,Y),d.call(S+"_sub",ut,M,Q),d.call(S+"_sub",Q,M,Q),d.call(S+"_add",P,q,P),d.call(S+"_square",P,P),d.call(S+"_sub",P,Z,P),d.call(S+"_sub",P,Y,P),d.call(S+"_sub",M,Q,q),d.call(S+"_mul",q,nt,q),d.call(S+"_add",H,H,H),d.call(S+"_add",H,H,H),d.call(S+"_add",H,H,H),d.call(S+"_sub",q,H,q),d.call(S+"_mul",nt,Y,M),d.call(S+"_add",M,M,M),d.call(S+"_neg",M,M),d.call(S+"_square",$,$),d.call(S+"_sub",$,T,$),d.call(S+"_sub",$,ut,$),d.call(S+"_add",Z,Z,Z),d.call(S+"_add",Z,Z,Z),d.call(S+"_sub",$,Z,$),d.call(S+"_mul",P,Y,T),d.call(S+"_add",T,T,T))}function yt(){const r=t.addFunction(o+"_prepAddStep");r.addParam("R","i32"),r.addParam("Q","i32"),r.addParam("r","i32");const d=r.getCodeBuilder(),Q=d.getLocal("R"),q=d.i32_add(d.getLocal("R"),d.i32_const(2*g)),P=d.i32_add(d.getLocal("R"),d.i32_const(4*g)),T=d.getLocal("Q"),M=d.i32_add(d.getLocal("Q"),d.i32_const(2*g)),$=d.getLocal("r"),Y=d.i32_add(d.getLocal("r"),d.i32_const(2*g)),Z=d.i32_add(d.getLocal("r"),d.i32_const(4*g)),H=d.i32_const(t.alloc(u)),nt=d.i32_const(t.alloc(u)),ut=d.i32_const(t.alloc(u)),_t=d.i32_const(t.alloc(u)),ct=d.i32_const(t.alloc(u)),At=d.i32_const(t.alloc(u)),Ct=d.i32_const(t.alloc(u)),vt=d.i32_const(t.alloc(u)),It=d.i32_const(t.alloc(u)),mt=d.i32_const(t.alloc(u)),ht=d.i32_const(t.alloc(u));r.addCode(d.call(S+"_square",P,H),d.call(S+"_square",M,nt),d.call(S+"_mul",H,T,_t),d.call(S+"_add",M,P,Y),d.call(S+"_square",Y,Y),d.call(S+"_sub",Y,nt,Y),d.call(S+"_sub",Y,H,Y),d.call(S+"_mul",Y,H,Y),d.call(S+"_sub",_t,Q,ct),d.call(S+"_square",ct,At),d.call(S+"_add",At,At,Ct),d.call(S+"_add",Ct,Ct,Ct),d.call(S+"_mul",Ct,ct,vt),d.call(S+"_sub",Y,q,It),d.call(S+"_sub",It,q,It),d.call(S+"_mul",It,T,Z),d.call(S+"_mul",Ct,Q,mt),d.call(S+"_square",It,Q),d.call(S+"_sub",Q,vt,Q),d.call(S+"_sub",Q,mt,Q),d.call(S+"_sub",Q,mt,Q),d.call(S+"_add",P,ct,P),d.call(S+"_square",P,P),d.call(S+"_sub",P,H,P),d.call(S+"_sub",P,At,P),d.call(S+"_add",M,P,$),d.call(S+"_sub",mt,Q,ht),d.call(S+"_mul",ht,It,ht),d.call(S+"_mul",q,vt,_t),d.call(S+"_add",_t,_t,_t),d.call(S+"_sub",ht,_t,q),d.call(S+"_square",$,$),d.call(S+"_sub",$,nt,$),d.call(S+"_square",P,ut),d.call(S+"_sub",$,ut,$),d.call(S+"_add",Z,Z,Z),d.call(S+"_sub",Z,$,Z),d.call(S+"_add",P,P,$),d.call(S+"_neg",It,It),d.call(S+"_add",It,It,Y))}function dt(){const r=t.addFunction(o+"_prepareG2");r.addParam("pQ","i32"),r.addParam("ppreQ","i32"),r.addLocal("pCoef","i32"),r.addLocal("i","i32");const d=r.getCodeBuilder(),Q=d.getLocal("pQ"),q=t.alloc(u*3),P=d.i32_const(q),T=d.getLocal("ppreQ");r.addCode(d.call(U+"_normalize",Q,T),d.if(d.call(U+"_isZero",T),d.ret([])),d.call(U+"_copy",T,P),d.setLocal("pCoef",d.i32_add(d.getLocal("ppreQ"),d.i32_const(u*3)))),r.addCode(d.setLocal("i",d.i32_const(pt.length-2)),d.block(d.loop(d.call(o+"_prepDblStep",P,d.getLocal("pCoef")),d.setLocal("pCoef",d.i32_add(d.getLocal("pCoef"),d.i32_const(ft))),d.if(d.i32_load8_s(d.getLocal("i"),wt),[...d.call(o+"_prepAddStep",P,T,d.getLocal("pCoef")),...d.setLocal("pCoef",d.i32_add(d.getLocal("pCoef"),d.i32_const(ft)))]),d.br_if(1,d.i32_eqz(d.getLocal("i"))),d.setLocal("i",d.i32_sub(d.getLocal("i"),d.i32_const(1))),d.br(0))))}function Lt(){const r=t.addFunction(K+"_mul1");r.addParam("pA","i32"),r.addParam("pC1","i32"),r.addParam("pR","i32");const d=r.getCodeBuilder(),Q=d.getLocal("pA"),q=d.i32_add(d.getLocal("pA"),d.i32_const(I*2)),P=d.i32_add(d.getLocal("pA"),d.i32_const(I*4)),T=d.getLocal("pC1"),M=d.getLocal("pR"),$=d.i32_add(d.getLocal("pR"),d.i32_const(I*2)),Y=d.i32_add(d.getLocal("pR"),d.i32_const(I*4)),Z=d.i32_const(t.alloc(I*2)),H=d.i32_const(t.alloc(I*2));r.addCode(d.call(S+"_add",Q,q,Z),d.call(S+"_add",q,P,H),d.call(S+"_mul",q,T,Y),d.call(S+"_mul",H,T,M),d.call(S+"_sub",M,Y,M),d.call(S+"_mulNR",M,M),d.call(S+"_mul",Z,T,$),d.call(S+"_sub",$,Y,$))}Lt();function St(){const r=t.addFunction(K+"_mul01");r.addParam("pA","i32"),r.addParam("pC0","i32"),r.addParam("pC1","i32"),r.addParam("pR","i32");const d=r.getCodeBuilder(),Q=d.getLocal("pA"),q=d.i32_add(d.getLocal("pA"),d.i32_const(I*2)),P=d.i32_add(d.getLocal("pA"),d.i32_const(I*4)),T=d.getLocal("pC0"),M=d.getLocal("pC1"),$=d.getLocal("pR"),Y=d.i32_add(d.getLocal("pR"),d.i32_const(I*2)),Z=d.i32_add(d.getLocal("pR"),d.i32_const(I*4)),H=d.i32_const(t.alloc(I*2)),nt=d.i32_const(t.alloc(I*2)),ut=d.i32_const(t.alloc(I*2)),_t=d.i32_const(t.alloc(I*2));r.addCode(d.call(S+"_mul",Q,T,H),d.call(S+"_mul",q,M,nt),d.call(S+"_add",Q,q,ut),d.call(S+"_add",Q,P,_t),d.call(S+"_add",q,P,$),d.call(S+"_mul",$,M,$),d.call(S+"_sub",$,nt,$),d.call(S+"_mulNR",$,$),d.call(S+"_add",$,H,$),d.call(S+"_add",T,M,Y),d.call(S+"_mul",Y,ut,Y),d.call(S+"_sub",Y,H,Y),d.call(S+"_sub",Y,nt,Y),d.call(S+"_mul",_t,T,Z),d.call(S+"_sub",Z,H,Z),d.call(S+"_add",Z,nt,Z))}St();function gt(){const r=t.addFunction(J+"_mul014");r.addParam("pA","i32"),r.addParam("pC0","i32"),r.addParam("pC1","i32"),r.addParam("pC4","i32"),r.addParam("pR","i32");const d=r.getCodeBuilder(),Q=d.getLocal("pA"),q=d.i32_add(d.getLocal("pA"),d.i32_const(I*6)),P=d.getLocal("pC0"),T=d.getLocal("pC1"),M=d.getLocal("pC4"),$=d.i32_const(t.alloc(I*6)),Y=d.i32_const(t.alloc(I*6)),Z=d.i32_const(t.alloc(I*2)),H=d.getLocal("pR"),nt=d.i32_add(d.getLocal("pR"),d.i32_const(I*6));r.addCode(d.call(K+"_mul01",Q,P,T,$),d.call(K+"_mul1",q,M,Y),d.call(S+"_add",T,M,Z),d.call(K+"_add",q,Q,nt),d.call(K+"_mul01",nt,P,Z,nt),d.call(K+"_sub",nt,$,nt),d.call(K+"_sub",nt,Y,nt),d.call(K+"_copy",Y,H),d.call(K+"_mulNR",H,H),d.call(K+"_add",H,$,H))}gt();function rt(){const r=t.addFunction(o+"_ell");r.addParam("pP","i32"),r.addParam("pCoefs","i32"),r.addParam("pF","i32");const d=r.getCodeBuilder(),Q=d.getLocal("pP"),q=d.i32_add(d.getLocal("pP"),d.i32_const(g)),P=d.getLocal("pF"),T=d.getLocal("pCoefs"),M=d.i32_add(d.getLocal("pCoefs"),d.i32_const(I)),$=d.i32_add(d.getLocal("pCoefs"),d.i32_const(I*2)),Y=d.i32_add(d.getLocal("pCoefs"),d.i32_const(I*3)),Z=d.i32_add(d.getLocal("pCoefs"),d.i32_const(I*4)),H=t.alloc(I*2),nt=d.i32_const(H),ut=d.i32_const(H),_t=d.i32_const(H+I),ct=t.alloc(I*2),At=d.i32_const(ct),Ct=d.i32_const(ct),vt=d.i32_const(ct+I);r.addCode(d.call(D+"_mul",T,q,ut),d.call(D+"_mul",M,q,_t),d.call(D+"_mul",$,Q,Ct),d.call(D+"_mul",Y,Q,vt),d.call(J+"_mul014",P,Z,At,nt,P))}rt();function bt(){const r=t.addFunction(o+"_millerLoop");r.addParam("ppreP","i32"),r.addParam("ppreQ","i32"),r.addParam("r","i32"),r.addLocal("pCoef","i32"),r.addLocal("i","i32");const d=r.getCodeBuilder(),Q=d.getLocal("ppreP"),q=d.getLocal("pCoef"),P=d.getLocal("r");r.addCode(d.call(J+"_one",P),d.if(d.call(G+"_isZero",Q),d.ret([])),d.if(d.call(G+"_isZero",d.getLocal("ppreQ")),d.ret([])),d.setLocal("pCoef",d.i32_add(d.getLocal("ppreQ"),d.i32_const(u*3))),d.setLocal("i",d.i32_const(pt.length-2)),d.block(d.loop(d.call(o+"_ell",Q,q,P),d.setLocal("pCoef",d.i32_add(d.getLocal("pCoef"),d.i32_const(ft))),d.if(d.i32_load8_s(d.getLocal("i"),wt),[...d.call(o+"_ell",Q,q,P),...d.setLocal("pCoef",d.i32_add(d.getLocal("pCoef"),d.i32_const(ft)))]),d.call(J+"_square",P,P),d.br_if(1,d.i32_eq(d.getLocal("i"),d.i32_const(1))),d.setLocal("i",d.i32_sub(d.getLocal("i"),d.i32_const(1))),d.br(0))),d.call(o+"_ell",Q,q,P)),r.addCode(d.call(J+"_conjugate",P,P))}function xt(r){const d=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760n,151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351n,0n],[2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n,1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557n,877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230n],[4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786n,0n],[151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027n,3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257n,2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437n,0n],[877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230n,3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557n]]],Q=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[0n,4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[0n,1n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[0n,793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n]],[[1n,0n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437n,0n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786n,0n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351n,0n]]],q=t.addFunction(J+"_frobeniusMap"+r);q.addParam("x","i32"),q.addParam("r","i32");const P=q.getCodeBuilder();for(let M=0;M<6;M++){const $=M==0?P.getLocal("x"):P.i32_add(P.getLocal("x"),P.i32_const(M*u)),Y=$,Z=P.i32_add(P.getLocal("x"),P.i32_const(M*u+I)),H=M==0?P.getLocal("r"):P.i32_add(P.getLocal("r"),P.i32_const(M*u)),nt=H,ut=P.i32_add(P.getLocal("r"),P.i32_const(M*u+I)),_t=T(d[Math.floor(M/3)][r%12],Q[M%3][r%6]),ct=t.alloc([...Bt.bigInt2BytesLE(w(_t[0]),g),...Bt.bigInt2BytesLE(w(_t[1]),g)]);r%2==1?q.addCode(P.call(D+"_copy",Y,nt),P.call(D+"_neg",Z,ut),P.call(S+"_mul",H,P.i32_const(ct),H)):q.addCode(P.call(S+"_mul",$,P.i32_const(ct),H))}function T(M,$){const Y=M[0],Z=M[1],H=$[0],nt=$[1],ut=[(Y*H-Z*nt)%a,(Y*nt+Z*H)%a];return Nc(ut[0])&&(ut[0]=ut[0]+a),ut}}function Mt(){const r=t.addFunction(o+"__cyclotomicSquare");r.addParam("x","i32"),r.addParam("r","i32");const d=r.getCodeBuilder(),Q=d.getLocal("x"),q=d.i32_add(d.getLocal("x"),d.i32_const(u)),P=d.i32_add(d.getLocal("x"),d.i32_const(2*u)),T=d.i32_add(d.getLocal("x"),d.i32_const(3*u)),M=d.i32_add(d.getLocal("x"),d.i32_const(4*u)),$=d.i32_add(d.getLocal("x"),d.i32_const(5*u)),Y=d.getLocal("r"),Z=d.i32_add(d.getLocal("r"),d.i32_const(u)),H=d.i32_add(d.getLocal("r"),d.i32_const(2*u)),nt=d.i32_add(d.getLocal("r"),d.i32_const(3*u)),ut=d.i32_add(d.getLocal("r"),d.i32_const(4*u)),_t=d.i32_add(d.getLocal("r"),d.i32_const(5*u)),ct=d.i32_const(t.alloc(u)),At=d.i32_const(t.alloc(u)),Ct=d.i32_const(t.alloc(u)),vt=d.i32_const(t.alloc(u)),It=d.i32_const(t.alloc(u)),mt=d.i32_const(t.alloc(u)),ht=d.i32_const(t.alloc(u)),Pt=d.i32_const(t.alloc(u));r.addCode(d.call(S+"_mul",Q,M,ht),d.call(S+"_mulNR",M,ct),d.call(S+"_add",Q,ct,ct),d.call(S+"_add",Q,M,Pt),d.call(S+"_mul",Pt,ct,ct),d.call(S+"_mulNR",ht,Pt),d.call(S+"_add",ht,Pt,Pt),d.call(S+"_sub",ct,Pt,ct),d.call(S+"_add",ht,ht,At),d.call(S+"_mul",T,P,ht),d.call(S+"_mulNR",P,Ct),d.call(S+"_add",T,Ct,Ct),d.call(S+"_add",T,P,Pt),d.call(S+"_mul",Pt,Ct,Ct),d.call(S+"_mulNR",ht,Pt),d.call(S+"_add",ht,Pt,Pt),d.call(S+"_sub",Ct,Pt,Ct),d.call(S+"_add",ht,ht,vt),d.call(S+"_mul",q,$,ht),d.call(S+"_mulNR",$,It),d.call(S+"_add",q,It,It),d.call(S+"_add",q,$,Pt),d.call(S+"_mul",Pt,It,It),d.call(S+"_mulNR",ht,Pt),d.call(S+"_add",ht,Pt,Pt),d.call(S+"_sub",It,Pt,It),d.call(S+"_add",ht,ht,mt),d.call(S+"_sub",ct,Q,Y),d.call(S+"_add",Y,Y,Y),d.call(S+"_add",ct,Y,Y),d.call(S+"_add",At,M,ut),d.call(S+"_add",ut,ut,ut),d.call(S+"_add",At,ut,ut),d.call(S+"_mul",mt,d.i32_const(ot),Pt),d.call(S+"_add",Pt,T,nt),d.call(S+"_add",nt,nt,nt),d.call(S+"_add",Pt,nt,nt),d.call(S+"_sub",It,P,H),d.call(S+"_add",H,H,H),d.call(S+"_add",It,H,H),d.call(S+"_sub",Ct,q,Z),d.call(S+"_add",Z,Z,Z),d.call(S+"_add",Ct,Z,Z),d.call(S+"_add",vt,$,_t),d.call(S+"_add",_t,_t,_t),d.call(S+"_add",vt,_t,_t))}function Vt(r,d,Q){const q=v(r).map(H=>H==-1?255:H),P=t.alloc(q),T=t.addFunction(o+"__cyclotomicExp_"+Q);T.addParam("x","i32"),T.addParam("r","i32"),T.addLocal("bit","i32"),T.addLocal("i","i32");const M=T.getCodeBuilder(),$=M.getLocal("x"),Y=M.getLocal("r"),Z=M.i32_const(t.alloc(l));T.addCode(M.call(J+"_conjugate",$,Z),M.call(J+"_one",Y),M.if(M.teeLocal("bit",M.i32_load8_s(M.i32_const(q.length-1),P)),M.if(M.i32_eq(M.getLocal("bit"),M.i32_const(1)),M.call(J+"_mul",Y,$,Y),M.call(J+"_mul",Y,Z,Y))),M.setLocal("i",M.i32_const(q.length-2)),M.block(M.loop(M.call(o+"__cyclotomicSquare",Y,Y),M.if(M.teeLocal("bit",M.i32_load8_s(M.getLocal("i"),P)),M.if(M.i32_eq(M.getLocal("bit"),M.i32_const(1)),M.call(J+"_mul",Y,$,Y),M.call(J+"_mul",Y,Z,Y))),M.br_if(1,M.i32_eqz(M.getLocal("i"))),M.setLocal("i",M.i32_sub(M.getLocal("i"),M.i32_const(1))),M.br(0)))),T.addCode(M.call(J+"_conjugate",Y,Y))}function Dt(){Mt(),Vt(h,y,"w0");const r=t.addFunction(o+"_finalExponentiation");r.addParam("x","i32"),r.addParam("r","i32");const d=r.getCodeBuilder(),Q=d.getLocal("x"),q=d.getLocal("r"),P=d.i32_const(t.alloc(l)),T=d.i32_const(t.alloc(l)),M=d.i32_const(t.alloc(l)),$=d.i32_const(t.alloc(l)),Y=d.i32_const(t.alloc(l)),Z=d.i32_const(t.alloc(l)),H=d.i32_const(t.alloc(l));r.addCode(d.call(J+"_frobeniusMap6",Q,P),d.call(J+"_inverse",Q,T),d.call(J+"_mul",P,T,M),d.call(J+"_copy",M,T),d.call(J+"_frobeniusMap2",M,M),d.call(J+"_mul",M,T,M),d.call(o+"__cyclotomicSquare",M,T),d.call(J+"_conjugate",T,T),d.call(o+"__cyclotomicExp_w0",M,$),d.call(o+"__cyclotomicSquare",$,Y),d.call(J+"_mul",T,$,Z),d.call(o+"__cyclotomicExp_w0",Z,T),d.call(o+"__cyclotomicExp_w0",T,P),d.call(o+"__cyclotomicExp_w0",P,H),d.call(J+"_mul",H,Y,H),d.call(o+"__cyclotomicExp_w0",H,Y),d.call(J+"_conjugate",Z,Z),d.call(J+"_mul",Y,Z,Y),d.call(J+"_mul",Y,M,Y),d.call(J+"_conjugate",M,Z),d.call(J+"_mul",T,M,T),d.call(J+"_frobeniusMap3",T,T),d.call(J+"_mul",H,Z,H),d.call(J+"_frobeniusMap1",H,H),d.call(J+"_mul",$,P,$),d.call(J+"_frobeniusMap2",$,$),d.call(J+"_mul",$,T,$),d.call(J+"_mul",$,H,$),d.call(J+"_mul",$,Y,q))}function $t(){const r=t.addFunction(o+"_finalExponentiationOld");r.addParam("x","i32"),r.addParam("r","i32");const Q=t.alloc(Bt.bigInt2BytesLE(322277361516934140462891564586510139908379969514828494218366688025288661041104682794998680497580008899973249814104447692778988208376779573819485263026159588510513834876303014016798809919343532899164848730280942609956670917565618115867287399623286813270357901731510188149934363360381614501334086825442271920079363289954510565375378443704372994881406797882676971082200626541916413184642520269678897559532260949334760604962086348898118982248842634379637598665468817769075878555493752214492790122785850202957575200176084204422751485957336465472324810982833638490904279282696134323072515220044451592646885410572234451732790590013479358343841220074174848221722017083597872017638514103174122784843925578370430843522959600095676285723737049438346544753168912974976791528535276317256904336520179281145394686565050419250614107803233314658825463117900250701199181529205942363159325765991819433914303908860460720581408201373164047773794825411011922305820065611121544561808414055302212057471395719432072209245600258134364584636810093520285711072578721435517884103526483832733289802426157301542744476740008494780363354305116978805620671467071400711358839553375340724899735460480144599782014906586543813292157922220645089192130209334926661588737007768565838519456601560804957985667880395221049249803753582637708560n,544)),q=r.getCodeBuilder();r.addCode(q.call(J+"_exp",q.getLocal("x"),q.i32_const(Q),q.i32_const(544),q.getLocal("r")))}const qt=t.alloc(c),Tt=t.alloc(m);function Rt(r){const d=t.addFunction(o+"_pairingEq"+r);for(let T=0;T<r;T++)d.addParam("p_"+T,"i32"),d.addParam("q_"+T,"i32");d.addParam("c","i32"),d.setReturnType("i32");const Q=d.getCodeBuilder(),q=Q.i32_const(t.alloc(l)),P=Q.i32_const(t.alloc(l));d.addCode(Q.call(J+"_one",q));for(let T=0;T<r;T++)d.addCode(Q.call(o+"_prepareG1",Q.getLocal("p_"+T),Q.i32_const(qt))),d.addCode(Q.call(o+"_prepareG2",Q.getLocal("q_"+T),Q.i32_const(Tt))),d.addCode(Q.if(Q.i32_eqz(Q.call(G+"_inGroupAffine",Q.i32_const(qt))),Q.ret(Q.i32_const(0))),Q.if(Q.i32_eqz(Q.call(U+"_inGroupAffine",Q.i32_const(Tt))),Q.ret(Q.i32_const(0)))),d.addCode(Q.call(o+"_millerLoop",Q.i32_const(qt),Q.i32_const(Tt),P)),d.addCode(Q.call(J+"_mul",q,P,q));d.addCode(Q.call(o+"_finalExponentiation",q,q)),d.addCode(Q.call(J+"_eq",q,Q.getLocal("c")))}function Xt(){const r=t.addFunction(o+"_pairing");r.addParam("p","i32"),r.addParam("q","i32"),r.addParam("r","i32");const d=r.getCodeBuilder(),Q=d.i32_const(t.alloc(l));r.addCode(d.call(o+"_prepareG1",d.getLocal("p"),d.i32_const(qt))),r.addCode(d.call(o+"_prepareG2",d.getLocal("q"),d.i32_const(Tt))),r.addCode(d.call(o+"_millerLoop",d.i32_const(qt),d.i32_const(Tt),Q)),r.addCode(d.call(o+"_finalExponentiation",Q,d.getLocal("r")))}function Yt(){const r=t.addFunction(U+"_inGroupAffine");r.addParam("p","i32"),r.setReturnType("i32");const d=r.getCodeBuilder(),Q=[2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279894n,2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279893n],q=4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,P=[2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n,2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n],T=d.i32_const(t.alloc([...Bt.bigInt2BytesLE(w(Q[0]),g),...Bt.bigInt2BytesLE(w(Q[1]),g)])),M=d.i32_const(t.alloc(Bt.bigInt2BytesLE(w(q),g))),$=d.i32_const(t.alloc([...Bt.bigInt2BytesLE(w(P[0]),g),...Bt.bigInt2BytesLE(w(P[1]),g)])),Y=d.i32_const(t.alloc(Bt.bigInt2BytesLE(h,8))),Z=d.getLocal("p"),H=d.i32_add(d.getLocal("p"),d.i32_const(u)),nt=d.i32_const(t.alloc(I)),ut=d.i32_const(t.alloc(u)),_t=d.i32_const(t.alloc(u)),ct=t.alloc(u*2),At=d.i32_const(ct),Ct=d.i32_const(ct),vt=d.i32_const(ct),It=d.i32_const(ct+I),mt=d.i32_const(ct+u),ht=d.i32_const(ct+u),Pt=d.i32_const(ct+u+I),Nt=t.alloc(u*3),Jt=d.i32_const(Nt),Pn=d.i32_const(Nt),un=d.i32_const(Nt),hn=d.i32_const(Nt+I),On=d.i32_const(Nt+u),fn=d.i32_const(Nt+u),Ln=d.i32_const(Nt+u+I),Qn=d.i32_const(Nt+u*2);r.addCode(d.if(d.call(U+"_isZeroAffine",d.getLocal("p")),d.ret(d.i32_const(1))),d.if(d.i32_eqz(d.call(U+"_inCurveAffine",d.getLocal("p"))),d.ret(d.i32_const(0))),d.call(S+"_mul",Z,T,ut),d.call(S+"_mul",H,T,_t),d.call(S+"_mul1",ut,M,Ct),d.call(S+"_neg",_t,mt),d.call(S+"_neg",ut,Pn),d.call(S+"_mul",_t,$,On),d.call(D+"_sub",vt,It,nt),d.call(D+"_add",vt,It,It),d.call(D+"_copy",nt,vt),d.call(D+"_sub",ht,Pt,nt),d.call(D+"_add",ht,Pt,Pt),d.call(D+"_copy",nt,ht),d.call(D+"_add",un,hn,nt),d.call(D+"_sub",un,hn,hn),d.call(D+"_copy",nt,un),d.call(D+"_sub",Ln,fn,nt),d.call(D+"_add",fn,Ln,Ln),d.call(D+"_copy",nt,fn),d.call(S+"_one",Qn),d.call(U+"_timesScalar",Jt,Y,d.i32_const(8),Jt),d.call(U+"_addMixed",Jt,At,Jt),d.ret(d.call(U+"_eqMixed",Jt,d.getLocal("p"))));const rn=t.addFunction(U+"_inGroup");rn.addParam("pIn","i32"),rn.setReturnType("i32");const nn=rn.getCodeBuilder(),Cn=nn.i32_const(t.alloc(u*2));rn.addCode(nn.call(U+"_toAffine",nn.getLocal("pIn"),Cn),nn.ret(nn.call(U+"_inGroupAffine",Cn)))}function N(){const r=t.addFunction(G+"_inGroupAffine");r.addParam("p","i32"),r.setReturnType("i32");const d=r.getCodeBuilder(),Q=4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,q=793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,P=(h*h-1n)/3n,T=d.i32_const(t.alloc(Bt.bigInt2BytesLE(w(Q),g))),M=d.i32_const(t.alloc(Bt.bigInt2BytesLE(w(q),g))),$=d.i32_const(t.alloc(Bt.bigInt2BytesLE(P,16))),Y=d.getLocal("p"),Z=d.i32_add(d.getLocal("p"),d.i32_const(I)),H=t.alloc(I*3),nt=d.i32_const(H),ut=d.i32_const(H),_t=d.i32_const(H+I),ct=t.alloc(I*2),At=d.i32_const(ct),Ct=d.i32_const(ct),vt=d.i32_const(ct+I);r.addCode(d.if(d.call(G+"_isZeroAffine",d.getLocal("p")),d.ret(d.i32_const(1))),d.if(d.i32_eqz(d.call(G+"_inCurveAffine",d.getLocal("p"))),d.ret(d.i32_const(0))),d.call(D+"_mul",Y,T,ut),d.call(D+"_copy",Z,_t),d.call(D+"_mul",Y,M,Ct),d.call(D+"_copy",Z,vt),d.call(G+"_doubleAffine",nt,nt),d.call(G+"_subMixed",nt,d.getLocal("p"),nt),d.call(G+"_subMixed",nt,At,nt),d.call(G+"_timesScalar",nt,$,d.i32_const(16),nt),d.ret(d.call(G+"_eqMixed",nt,At)));const It=t.addFunction(G+"_inGroup");It.addParam("pIn","i32"),It.setReturnType("i32");const mt=It.getCodeBuilder(),ht=mt.i32_const(t.alloc(I*2));It.addCode(mt.call(G+"_toAffine",mt.getLocal("pIn"),ht),mt.ret(mt.call(G+"_inGroupAffine",ht)))}for(let r=0;r<10;r++)xt(r),t.exportFunction(J+"_frobeniusMap"+r);N(),Yt(),yt(),at(),R(),dt(),bt(),$t(),Dt();for(let r=1;r<=5;r++)Rt(r),t.exportFunction(o+"_pairingEq"+r);Xt(),t.exportFunction(o+"_pairing"),t.exportFunction(o+"_prepareG1"),t.exportFunction(o+"_prepareG2"),t.exportFunction(o+"_millerLoop"),t.exportFunction(o+"_finalExponentiation"),t.exportFunction(o+"_finalExponentiationOld"),t.exportFunction(o+"__cyclotomicSquare"),t.exportFunction(o+"__cyclotomicExp_w0"),t.exportFunction(K+"_mul1"),t.exportFunction(K+"_mul01"),t.exportFunction(J+"_mul014"),t.exportFunction(G+"_inGroupAffine"),t.exportFunction(G+"_inGroup"),t.exportFunction(U+"_inGroupAffine"),t.exportFunction(U+"_inGroup")},Hc=zc,Vc=Kc;function Qo(e){if(typeof e=="bigint"||e.eq!==void 0)return e.toString(10);if(e instanceof Uint8Array)return zn(e,0);if(Array.isArray(e))return e.map(Qo);if(typeof e=="object"){const t={};return Object.keys(e).forEach(o=>{t[o]=Qo(e[o])}),t}else return e}function Mo(e){if(typeof e=="string"&&/^[0-9]+$/.test(e))return BigInt(e);if(typeof e=="string"&&/^0x[0-9a-fA-F]+$/.test(e))return BigInt(e);if(Array.isArray(e))return e.map(Mo);if(typeof e=="object"){if(e===null)return null;const t={};return Object.keys(e).forEach(o=>{t[o]=Mo(e[o])}),t}else return e}function $c(e){let t=BigInt(0),n=e.length,o=0;const a=new DataView(e.buffer,e.byteOffset,e.byteLength);for(;n>0;)n>=4?(n-=4,t+=BigInt(a.getUint32(n))<<BigInt(o*8),o+=4):n>=2?(n-=2,t+=BigInt(a.getUint16(n))<<BigInt(o*8),o+=2):(n-=1,t+=BigInt(a.getUint8(n))<<BigInt(o*8),o+=1);return t}function jc(e,t){let n=e;const o=new Uint8Array(t),a=new DataView(o.buffer);let s=t;for(;s>0;)s-4>=0?(s-=4,a.setUint32(s,Number(n&BigInt(4294967295))),n=n>>BigInt(32)):s-2>=0?(s-=2,a.setUint16(s,Number(n&BigInt(65535))),n=n>>BigInt(16)):(s-=1,a.setUint8(s,Number(n&BigInt(255))),n=n>>BigInt(8));if(n)throw new Error("Number does not fit in this length");return o}function Yc(e){let t=BigInt(0),n=0;const o=new DataView(e.buffer,e.byteOffset,e.byteLength);for(;n<e.length;)n+4<=e.length?(t+=BigInt(o.getUint32(n,!0))<<BigInt(n*8),n+=4):n+2<=e.length?(t+=BigInt(o.getUint16(n,!0))<<BigInt(n*8),n+=2):(t+=BigInt(o.getUint8(n,!0))<<BigInt(n*8),n+=1);return t}function Wa(e,t){let n=e;typeof t>"u"&&(t=Math.floor((Mn(e)-1)/8)+1,t==0&&(t=1));const o=new Uint8Array(t),a=new DataView(o.buffer);let s=0;for(;s<t;)s+4<=t?(a.setUint32(s,Number(n&BigInt(4294967295)),!0),s+=4,n=n>>BigInt(32)):s+2<=t?(a.setUint16(s,Number(n&BigInt(65535)),!0),s+=2,n=n>>BigInt(16)):(a.setUint8(s,Number(n&BigInt(255)),!0),s+=1,n=n>>BigInt(8));if(n)throw new Error("Number does not fit in this length");return o}function qo(e,t){if(typeof t=="bigint"||t.eq!==void 0)return t.toString(10);if(t instanceof Uint8Array)return e.toString(e.e(t));if(Array.isArray(t))return t.map(qo.bind(this,e));if(typeof t=="object"){const n={};return Object.keys(t).forEach(a=>{n[a]=qo(e,t[a])}),n}else return t}function Uo(e,t){if(typeof t=="string"&&/^[0-9]+$/.test(t))return e.e(t);if(typeof t=="string"&&/^0x[0-9a-fA-F]+$/.test(t))return e.e(t);if(Array.isArray(t))return t.map(Uo.bind(this,e));if(typeof t=="object"){if(t===null)return null;const n={};return Object.keys(t).forEach(a=>{n[a]=Uo(e,t[a])}),n}else return t}const Nn=[];for(let e=0;e<256;e++)Nn[e]=Zc(e,8);function Zc(e,t){let n=0,o=e;for(let a=0;a<t;a++)n<<=1,n=n|o&1,o>>=1;return n}function Xa(e,t){return(Nn[e>>>24]|Nn[e>>>16&255]<<8|Nn[e>>>8&255]<<16|Nn[e&255]<<24)>>>32-t}function jt(e){return((e&4294901760)!==0?(e&=4294901760,16):0)|((e&4278255360)!==0?(e&=4278255360,8):0)|((e&4042322160)!==0?(e&=4042322160,4):0)|((e&3435973836)!==0?(e&=3435973836,2):0)|(e&2863311530)!==0}function ti(e,t){const n=e.byteLength/t,o=jt(n);if(n!=1<<o)throw new Error("Invalid number of pointers");for(let a=0;a<n;a++){const s=Xa(a,o);if(a>s){const f=e.slice(a*t,(a+1)*t);e.set(e.slice(s*t,(s+1)*t),a*t),e.set(f,s*t)}}}function zo(e,t){const n=new Uint8Array(t*e.length);for(let o=0;o<e.length;o++)n.set(e[o],o*t);return n}function io(e,t){const n=e.byteLength/t,o=new Array(n);for(let a=0;a<n;a++)o[a]=e.slice(a*t,a*t+t);return o}var Jc=Object.freeze({__proto__:null,array2buffer:zo,beBuff2int:$c,beInt2Buff:jc,bitReverse:Xa,buffReverseBits:ti,buffer2array:io,leBuff2int:Yc,leInt2Buff:Wa,log2:jt,stringifyBigInts:Qo,stringifyFElements:qo,unstringifyBigInts:Mo,unstringifyFElements:Uo});const Gt=1<<30;class Ot{constructor(t){this.buffers=[],this.byteLength=t;for(let n=0;n<t;n+=Gt){const o=Math.min(t-n,Gt);this.buffers.push(new Uint8Array(o))}}slice(t,n){n===void 0&&(n=this.byteLength),t===void 0&&(t=0);const o=n-t,a=Math.floor(t/Gt),s=Math.floor((t+o-1)/Gt);if(a==s||o==0)return this.buffers[a].slice(t%Gt,t%Gt+o);let f,g=a,I=t%Gt,u=o;for(;u>0;){const l=I+u>Gt?Gt-I:u,E=new Uint8Array(this.buffers[g].buffer,this.buffers[g].byteOffset+I,l);if(l==o)return E.slice();f||(o<=Gt?f=new Uint8Array(o):f=new Ot(o)),f.set(E,o-u),u=u-l,g++,I=0}return f}set(t,n){n===void 0&&(n=0);const o=t.byteLength;if(o==0)return;const a=Math.floor(n/Gt),s=Math.floor((n+o-1)/Gt);if(a==s)return t instanceof Ot&&t.buffers.length==1?this.buffers[a].set(t.buffers[0],n%Gt):this.buffers[a].set(t,n%Gt);let f=a,g=n%Gt,I=o;for(;I>0;){const u=g+I>Gt?Gt-g:I,l=t.slice(o-I,o-I+u);new Uint8Array(this.buffers[f].buffer,this.buffers[f].byteOffset+g,u).set(l),I=I-u,f++,g=0}}}function gn(e,t,n,o){return async function(s){const f=Math.floor(s.byteLength/n);if(f*n!==s.byteLength)throw new Error("Invalid buffer size");const g=Math.floor(f/e.concurrency),I=[];for(let F=0;F<e.concurrency;F++){let A;if(F<e.concurrency-1?A=g:A=f-F*g,A==0)continue;const D=[{cmd:"ALLOCSET",var:0,buff:s.slice(F*g*n,F*g*n+A*n)},{cmd:"ALLOC",var:1,len:o*A},{cmd:"CALL",fnName:t,params:[{var:0},{val:A},{var:1}]},{cmd:"GET",out:0,var:1,len:o*A}];I.push(e.queueAction(D))}const u=await Promise.all(I);let l;s instanceof Ot?l=new Ot(f*o):l=new Uint8Array(f*o);let E=0;for(let F=0;F<u.length;F++)l.set(u[F][0],E),E+=u[F][0].byteLength;return l}}class ni{constructor(t,n,o,a){if(this.tm=t,this.prefix=n,this.p=a,this.n8=o,this.type="F1",this.m=1,this.half=mn(a,An),this.bitLength=Mn(a),this.mask=on(Xn(An,this.bitLength),An),this.pOp1=t.alloc(o),this.pOp2=t.alloc(o),this.pOp3=t.alloc(o),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(o/8),this.n32=Math.floor(o/4),this.n64*8!=this.n8)throw new Error("n8 must be a multiple of 8");this.half=mn(this.p,An),this.nqr=this.two;let s=this.exp(this.nqr,this.half);for(;!this.eq(s,this.negone);)this.nqr=this.add(this.nqr,this.one),s=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let f=on(this.p,An);for(;!po(f);)this.s=this.s+1,f=mn(f,An);this.w=[],this.w[this.s]=this.exp(this.nqr,f);for(let g=this.s-1;g>=0;g--)this.w[g]=this.square(this.w[g+1]);if(!this.eq(this.w[0],this.one))throw new Error("Error calculating roots of unity");this.batchToMontgomery=gn(t,n+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=gn(t,n+"_batchFromMontgomery",this.n8,this.n8)}op2(t,n,o){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,o),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,o){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,o),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){return this.op2("_add",t,n)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=Bn(zt(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(t){return this.op1Bool("_isNegative",t)}e(t,n){if(t instanceof Uint8Array)return t;let o=zt(t,n);da(o)?(o=ha(o),bo(o,this.p)&&(o=tn(o,this.p)),o=on(this.p,o)):bo(o,this.p)&&(o=tn(o,this.p));const a=Wa(o,this.n8);return this.toMontgomery(a)}toString(t,n){const o=this.fromMontgomery(t),a=zn(o,0);return ba(a,n)}fromRng(t){let n;const o=new Uint8Array(this.n8);do{n=ya;for(let a=0;a<this.n64;a++)n=Ao(n,Xn(t.nextU64(),64*a));n=yo(n,this.mask)}while(La(n,this.p));return Un(o,0,n,this.n8),o}random(){return this.fromRng(Io())}toObject(t){const n=this.fromMontgomery(t);return zn(n,0)}fromObject(t){const n=new Uint8Array(this.n8);return Un(n,0,t,this.n8),this.toMontgomery(n)}toRprLE(t,n,o){t.set(this.fromMontgomery(o),n)}toRprBE(t,n,o){const a=this.fromMontgomery(o);for(let s=0;s<this.n8/2;s++){const f=a[s];a[s]=a[this.n8-1-s],a[this.n8-1-s]=f}t.set(a,n)}fromRprLE(t,n){n=n||0;const o=t.slice(n,n+this.n8);return this.toMontgomery(o)}async batchInverse(t){let n=!1;const o=this.n8,a=this.n8;Array.isArray(t)?(t=zo(t,o),n=!0):t=t.slice(0,t.byteLength);const s=Math.floor(t.byteLength/o);if(s*o!==t.byteLength)throw new Error("Invalid buffer size");const f=Math.floor(s/this.tm.concurrency),g=[];for(let E=0;E<this.tm.concurrency;E++){let F;if(E<this.tm.concurrency-1?F=f:F=s-E*f,F==0)continue;const k=[{cmd:"ALLOCSET",var:0,buff:t.slice(E*f*o,E*f*o+F*o)},{cmd:"ALLOC",var:1,len:a*F},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:o},{val:F},{var:1},{val:a}]},{cmd:"GET",out:0,var:1,len:a*F}];g.push(this.tm.queueAction(k))}const I=await Promise.all(g);let u;t instanceof Ot?u=new Ot(s*a):u=new Uint8Array(s*a);let l=0;for(let E=0;E<I.length;E++)u.set(I[E][0],l),l+=I[E][0].byteLength;return n?io(u,a):u}}class oi{constructor(t,n,o){this.tm=t,this.prefix=n,this.F=o,this.type="F2",this.m=o.m*2,this.n8=this.F.n8*2,this.n32=this.F.n32*2,this.n64=this.F.n64*2,this.pOp1=t.alloc(o.n8*2),this.pOp2=t.alloc(o.n8*2),this.pOp3=t.alloc(o.n8*2),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,n,o){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,o),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,o){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,o),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){return this.op2("_add",t,n)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}mul1(t,n){return this.op2("_mul1",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=Bn(zt(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(t,n){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&t.length==2){const o=this.F.e(t[0],n),a=this.F.e(t[1],n),s=new Uint8Array(this.F.n8*2);return s.set(o),s.set(a,this.F.n8*2),s}else throw new Error("invalid F2")}toString(t,n){const o=this.F.toString(t.slice(0,this.F.n8),n),a=this.F.toString(t.slice(this.F.n8),n);return`[${o}, ${a}]`}fromRng(t){const n=this.F.fromRng(t),o=this.F.fromRng(t),a=new Uint8Array(this.F.n8*2);return a.set(n),a.set(o,this.F.n8),a}random(){return this.fromRng(Io())}toObject(t){const n=this.F.toObject(t.slice(0,this.F.n8)),o=this.F.toObject(t.slice(this.F.n8,this.F.n8*2));return[n,o]}fromObject(t){const n=new Uint8Array(this.F.n8*2),o=this.F.fromObject(t[0]),a=this.F.fromObject(t[1]);return n.set(o),n.set(a,this.F.n8),n}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8)}}class Wc{constructor(t,n,o){this.tm=t,this.prefix=n,this.F=o,this.type="F3",this.m=o.m*3,this.n8=this.F.n8*3,this.n32=this.F.n32*3,this.n64=this.F.n64*3,this.pOp1=t.alloc(o.n8*3),this.pOp2=t.alloc(o.n8*3),this.pOp3=t.alloc(o.n8*3),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,n,o){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,o),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,o){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,o),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}add(t,n){return this.op2("_add",t,n)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=Bn(zt(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(t,n){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&t.length==3){const o=this.F.e(t[0],n),a=this.F.e(t[1],n),s=this.F.e(t[2],n),f=new Uint8Array(this.F.n8*3);return f.set(o),f.set(a,this.F.n8),f.set(s,this.F.n8*2),f}else throw new Error("invalid F3")}toString(t,n){const o=this.F.toString(t.slice(0,this.F.n8),n),a=this.F.toString(t.slice(this.F.n8,this.F.n8*2),n),s=this.F.toString(t.slice(this.F.n8*2),n);return`[${o}, ${a}, ${s}]`}fromRng(t){const n=this.F.fromRng(t),o=this.F.fromRng(t),a=this.F.fromRng(t),s=new Uint8Array(this.F.n8*3);return s.set(n),s.set(o,this.F.n8),s.set(a,this.F.n8*2),s}random(){return this.fromRng(Io())}toObject(t){const n=this.F.toObject(t.slice(0,this.F.n8)),o=this.F.toObject(t.slice(this.F.n8,this.F.n8*2)),a=this.F.toObject(t.slice(this.F.n8*2,this.F.n8*3));return[n,o,a]}fromObject(t){const n=new Uint8Array(this.F.n8*3),o=this.F.fromObject(t[0]),a=this.F.fromObject(t[1]),s=this.F.fromObject(t[2]);return n.set(o),n.set(a,this.F.n8),n.set(s,this.F.n8*2),n}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8,this.F.n8*2)}c3(t){return t.slice(this.F.n8*2)}}class ai{constructor(t,n,o,a,s,f){this.tm=t,this.prefix=n,this.F=o,this.pOp1=t.alloc(o.n8*3),this.pOp2=t.alloc(o.n8*3),this.pOp3=t.alloc(o.n8*3),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,o.n8*3),this.tm.instance.exports[n+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,o.n8*2),this.one=this.tm.getBuff(a,o.n8*3),this.g=this.one,this.oneAffine=this.tm.getBuff(a,o.n8*2),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(s,o.n8),f&&(this.cofactor=Bn(f)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=gn(t,n+"_batchLEMtoC",o.n8*2,o.n8),this.batchLEMtoU=gn(t,n+"_batchLEMtoU",o.n8*2,o.n8*2),this.batchCtoLEM=gn(t,n+"_batchCtoLEM",o.n8,o.n8*2),this.batchUtoLEM=gn(t,n+"_batchUtoLEM",o.n8*2,o.n8*2),this.batchToJacobian=gn(t,n+"_batchToJacobian",o.n8*2,o.n8*3),this.batchToAffine=gn(t,n+"_batchToAffine",o.n8*3,o.n8*2)}op2(t,n,o){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,o),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}op2bool(t,n,o){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,o),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}op1Affine(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*2)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2("_add",t,n);if(n.byteLength==this.F.n8*2)return this.op2("_addMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2("_addMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2("_addAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}sub(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2("_sub",t,n);if(n.byteLength==this.F.n8*2)return this.op2("_subMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2("_subMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2("_subAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}neg(t){if(t.byteLength==this.F.n8*3)return this.op1("_neg",t);if(t.byteLength==this.F.n8*2)return this.op1Affine("_negAffine",t);throw new Error("invalid point size")}double(t){if(t.byteLength==this.F.n8*3)return this.op1("_double",t);if(t.byteLength==this.F.n8*2)return this.op1("_doubleAffine",t);throw new Error("invalid point size")}isZero(t){if(t.byteLength==this.F.n8*3)return this.op1Bool("_isZero",t);if(t.byteLength==this.F.n8*2)return this.op1Bool("_isZeroAffine",t);throw new Error("invalid point size")}timesScalar(t,n){n instanceof Uint8Array||(n=Bn(zt(n)));let o;if(t.byteLength==this.F.n8*3)o=this.prefix+"_timesScalar";else if(t.byteLength==this.F.n8*2)o=this.prefix+"_timesScalarAffine";else throw new Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[o](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}timesFr(t,n){let o;if(t.byteLength==this.F.n8*3)o=this.prefix+"_timesFr";else if(t.byteLength==this.F.n8*2)o=this.prefix+"_timesFrAffine";else throw new Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[o](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}eq(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2bool("_eq",t,n);if(n.byteLength==this.F.n8*2)return this.op2bool("_eqMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2bool("_eqMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2bool("_eqAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}toAffine(t){if(t.byteLength==this.F.n8*3)return this.op1Affine("_toAffine",t);if(t.byteLength==this.F.n8*2)return t;throw new Error("invalid point size")}toJacobian(t){if(t.byteLength==this.F.n8*3)return t;if(t.byteLength==this.F.n8*2)return this.op1("_toJacobian",t);throw new Error("invalid point size")}toRprUncompressed(t,n,o){if(this.tm.setBuff(this.pOp1,o),o.byteLength==this.F.n8*3)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(o.byteLength!=this.F.n8*2)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);const a=this.tm.getBuff(this.pOp1,this.F.n8*2);t.set(a,n)}fromRprUncompressed(t,n){const o=t.slice(n,n+this.F.n8*2);return this.tm.setBuff(this.pOp1,o),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,this.F.n8*2)}toRprCompressed(t,n,o){if(this.tm.setBuff(this.pOp1,o),o.byteLength==this.F.n8*3)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(o.byteLength!=this.F.n8*2)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);const a=this.tm.getBuff(this.pOp1,this.F.n8);t.set(a,n)}fromRprCompressed(t,n){const o=t.slice(n,n+this.F.n8);return this.tm.setBuff(this.pOp1,o),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,this.F.n8*2)}toUncompressed(t){const n=new Uint8Array(this.F.n8*2);return this.toRprUncompressed(n,0,t),n}toRprLEM(t,n,o){if(o.byteLength==this.F.n8*2){t.set(o,n);return}else if(o.byteLength==this.F.n8*3){this.tm.setBuff(this.pOp1,o),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);const a=this.tm.getBuff(this.pOp1,this.F.n8*2);t.set(a,n)}else throw new Error("invalid point size")}fromRprLEM(t,n){return n=n||0,t.slice(n,n+this.F.n8*2)}toString(t,n){if(t.byteLength==this.F.n8*3){const o=this.F.toString(t.slice(0,this.F.n8),n),a=this.F.toString(t.slice(this.F.n8,this.F.n8*2),n),s=this.F.toString(t.slice(this.F.n8*2),n);return`[ ${o}, ${a}, ${s} ]`}else if(t.byteLength==this.F.n8*2){const o=this.F.toString(t.slice(0,this.F.n8),n),a=this.F.toString(t.slice(this.F.n8),n);return`[ ${o}, ${a} ]`}else throw new Error("invalid point size")}isValid(t){if(this.isZero(t))return!0;const n=this.F,o=this.toAffine(t),a=o.slice(0,this.F.n8),s=o.slice(this.F.n8,this.F.n8*2),f=n.add(n.mul(n.square(a),a),this.b),g=n.square(s);return n.eq(f,g)}fromRng(t){const n=this.F;let o=[],a,s;do o[0]=n.fromRng(t),a=t.nextBool(),s=n.add(n.mul(n.square(o[0]),o[0]),this.b);while(!n.isSquare(s));o[1]=n.sqrt(s);const f=n.isNegative(o[1]);a^f&&(o[1]=n.neg(o[1]));let g=new Uint8Array(this.F.n8*2);return g.set(o[0]),g.set(o[1],this.F.n8),this.cofactor&&(g=this.timesScalar(g,this.cofactor)),g}toObject(t){if(this.isZero(t))return[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero)];const n=this.F.toObject(t.slice(0,this.F.n8)),o=this.F.toObject(t.slice(this.F.n8,this.F.n8*2));let a;return t.byteLength==this.F.n8*3?a=this.F.toObject(t.slice(this.F.n8*2,this.F.n8*3)):a=this.F.toObject(this.F.one),[n,o,a]}fromObject(t){const n=this.F.fromObject(t[0]),o=this.F.fromObject(t[1]);let a;if(t.length==3?a=this.F.fromObject(t[2]):a=this.F.one,this.F.isZero(a,this.F.one))return this.zeroAffine;if(this.F.eq(a,this.F.one)){const s=new Uint8Array(this.F.n8*2);return s.set(n),s.set(o,this.F.n8),s}else{const s=new Uint8Array(this.F.n8*3);return s.set(n),s.set(o,this.F.n8),s.set(a,this.F.n8*2),s}}e(t){return t instanceof Uint8Array?t:this.fromObject(t)}x(t){return this.toAffine(t).slice(0,this.F.n8)}y(t){return this.toAffine(t).slice(this.F.n8)}}function Xc(e){let n,o;async function a(l){const E=new Uint8Array(l.code),F=await WebAssembly.compile(E);o=new WebAssembly.Memory({initial:l.init,maximum:32767}),n=await WebAssembly.instantiate(F,{env:{memory:o}})}function s(l){const E=new Uint32Array(o.buffer,0,1);for(;E[0]&3;)E[0]++;const F=E[0];if(E[0]+=l,E[0]+l>o.buffer.byteLength){const A=o.buffer.byteLength/65536;let k=Math.floor((E[0]+l)/65536)+1;k>32767&&(k=32767),o.grow(k-A)}return F}function f(l){const E=s(l.byteLength);return I(E,l),E}function g(l,E){const F=new Uint8Array(o.buffer);return new Uint8Array(F.buffer,F.byteOffset+l,E)}function I(l,E){new Uint8Array(o.buffer).set(new Uint8Array(E),l)}function u(l){if(l[0].cmd=="INIT")return a(l[0]);const E={vars:[],out:[]},A=new Uint32Array(o.buffer,0,1)[0];for(let D=0;D<l.length;D++)switch(l[D].cmd){case"ALLOCSET":E.vars[l[D].var]=f(l[D].buff);break;case"ALLOC":E.vars[l[D].var]=s(l[D].len);break;case"SET":I(E.vars[l[D].var],l[D].buff);break;case"CALL":{const B=[];for(let G=0;G<l[D].params.length;G++){const S=l[D].params[G];typeof S.var<"u"?B.push(E.vars[S.var]+(S.offset||0)):typeof S.val<"u"&&B.push(S.val)}n.exports[l[D].fnName](...B);break}case"GET":E.out[l[D].out]=g(E.vars[l[D].var],l[D].len).slice();break;default:throw new Error("Invalid cmd")}const k=new Uint32Array(o.buffer,0,1);return k[0]=A,E.out}return u}const ko=25;class ii{constructor(){this.promise=new Promise((t,n)=>{this.reject=n,this.resolve=t})}}function ts(e){return new Promise(t=>setTimeout(t,e))}let Do;const ei=`(function thread(self) {
    const MAXMEM = 32767;
    let instance;
    let memory;

    if (self) {
        self.onmessage = function(e) {
            let data;
            if (e.data) {
                data = e.data;
            } else {
                data = e;
            }

            if (data[0].cmd == "INIT") {
                init(data[0]).then(function() {
                    self.postMessage(data.result);
                });
            } else if (data[0].cmd == "TERMINATE") {
                self.close();
            } else {
                const res = runTask(data);
                self.postMessage(res);
            }
        };
    }

    async function init(data) {
        const code = new Uint8Array(data.code);
        const wasmModule = await WebAssembly.compile(code);
        memory = new WebAssembly.Memory({initial:data.init, maximum: MAXMEM});

        instance = await WebAssembly.instantiate(wasmModule, {
            env: {
                "memory": memory
            }
        });
    }



    function alloc(length) {
        const u32 = new Uint32Array(memory.buffer, 0, 1);
        while (u32[0] & 3) u32[0]++;  // Return always aligned pointers
        const res = u32[0];
        u32[0] += length;
        if (u32[0] + length > memory.buffer.byteLength) {
            const currentPages = memory.buffer.byteLength / 0x10000;
            let requiredPages = Math.floor((u32[0] + length) / 0x10000)+1;
            if (requiredPages>MAXMEM) requiredPages=MAXMEM;
            memory.grow(requiredPages-currentPages);
        }
        return res;
    }

    function allocBuffer(buffer) {
        const p = alloc(buffer.byteLength);
        setBuffer(p, buffer);
        return p;
    }

    function getBuffer(pointer, length) {
        const u8 = new Uint8Array(memory.buffer);
        return new Uint8Array(u8.buffer, u8.byteOffset + pointer, length);
    }

    function setBuffer(pointer, buffer) {
        const u8 = new Uint8Array(memory.buffer);
        u8.set(new Uint8Array(buffer), pointer);
    }

    function runTask(task) {
        if (task[0].cmd == "INIT") {
            return init(task[0]);
        }
        const ctx = {
            vars: [],
            out: []
        };
        const u32a = new Uint32Array(memory.buffer, 0, 1);
        const oldAlloc = u32a[0];
        for (let i=0; i<task.length; i++) {
            switch (task[i].cmd) {
            case "ALLOCSET":
                ctx.vars[task[i].var] = allocBuffer(task[i].buff);
                break;
            case "ALLOC":
                ctx.vars[task[i].var] = alloc(task[i].len);
                break;
            case "SET":
                setBuffer(ctx.vars[task[i].var], task[i].buff);
                break;
            case "CALL": {
                const params = [];
                for (let j=0; j<task[i].params.length; j++) {
                    const p = task[i].params[j];
                    if (typeof p.var !== "undefined") {
                        params.push(ctx.vars[p.var] + (p.offset || 0));
                    } else if (typeof p.val != "undefined") {
                        params.push(p.val);
                    }
                }
                instance.exports[task[i].fnName](...params);
                break;
            }
            case "GET":
                ctx.out[task[i].out] = getBuffer(ctx.vars[task[i].var], task[i].len).slice();
                break;
            default:
                throw new Error("Invalid cmd");
            }
        }
        const u32b = new Uint32Array(memory.buffer, 0, 1);
        u32b[0] = oldAlloc;
        return ctx.out;
    }


    return runTask;
})(self)`;if(globalThis?.Blob){const e=new TextEncoder().encode(ei),t=new Blob([e],{type:"application/javascript"});Do=URL.createObjectURL(t)}else Do="data:application/javascript;base64,"+globalThis.btoa(ei);async function ns(e,t){const n=new os;n.memory=new WebAssembly.Memory({initial:ko}),n.u8=new Uint8Array(n.memory.buffer),n.u32=new Uint32Array(n.memory.buffer);const o=await WebAssembly.compile(e.code);if(n.instance=await WebAssembly.instantiate(o,{env:{memory:n.memory}}),globalThis?.Worker||(t=!0),n.singleThread=t,n.initalPFree=n.u32[0],n.pq=e.pq,n.pr=e.pr,n.pG1gen=e.pG1gen,n.pG1zero=e.pG1zero,n.pG2gen=e.pG2gen,n.pG2zero=e.pG2zero,n.pOneT=e.pOneT,t)n.code=e.code,n.taskManager=Xc(),await n.taskManager([{cmd:"INIT",init:ko,code:n.code.slice()}]),n.concurrency=1;else{n.workers=[],n.pendingDeferreds=[],n.working=[];let s=2;typeof navigator=="object"&&navigator.hardwareConcurrency&&(s=navigator.hardwareConcurrency),s==0&&(s=2),s>64&&(s=64),n.concurrency=s;for(let g=0;g<s;g++)n.workers[g]=new Worker(Do),n.workers[g].addEventListener("message",a(g)),n.working[g]=!1;const f=[];for(let g=0;g<n.workers.length;g++){const I=e.code.slice();f.push(n.postAction(g,[{cmd:"INIT",init:ko,code:I}],[I.buffer]))}await Promise.all(f)}return n;function a(s){return function(f){let g;f&&f.data?g=f.data:g=f,n.working[s]=!1,n.pendingDeferreds[s].resolve(g),n.processWorks()}}}class os{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(this.oldPFree!=0)throw new Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(this.oldPFree==0)throw new Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(t,n,o,a){if(this.working[t])throw new Error("Posting a job t a working worker");return this.working[t]=!0,this.pendingDeferreds[t]=a||new ii,this.workers[t].postMessage(n,o),this.pendingDeferreds[t].promise}processWorks(){for(let t=0;t<this.workers.length&&this.actionQueue.length>0;t++)if(this.working[t]==!1){const n=this.actionQueue.shift();this.postAction(t,n.data,n.transfers,n.deferred)}}queueAction(t,n){const o=new ii;if(this.singleThread){const a=this.taskManager(t);o.resolve(a)}else this.actionQueue.push({data:t,transfers:n,deferred:o}),this.processWorks();return o.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(t){const n=this.alloc(t.byteLength);return this.setBuff(n,t),n}getBuff(t,n){return this.u8.slice(t,t+n)}setBuff(t,n){this.u8.set(new Uint8Array(n),t)}alloc(t){for(;this.u32[0]&3;)this.u32[0]++;const n=this.u32[0];return this.u32[0]+=t,n}async terminate(){for(let t=0;t<this.workers.length;t++)this.workers[t].postMessage([{cmd:"TERMINATE"}]);await ts(200)}}function To(e,t){const n=e[t],o=e.Fr,a=e.tm;e[t].batchApplyKey=async function(s,f,g,I,u){I=I||"affine",u=u||"affine";let l,E,F,A,k;if(t=="G1")I=="jacobian"?(F=n.F.n8*3,l="g1m_batchApplyKey"):(F=n.F.n8*2,l="g1m_batchApplyKeyMixed"),A=n.F.n8*3,u=="jacobian"?k=n.F.n8*3:(E="g1m_batchToAffine",k=n.F.n8*2);else if(t=="G2")I=="jacobian"?(F=n.F.n8*3,l="g2m_batchApplyKey"):(F=n.F.n8*2,l="g2m_batchApplyKeyMixed"),A=n.F.n8*3,u=="jacobian"?k=n.F.n8*3:(E="g2m_batchToAffine",k=n.F.n8*2);else if(t=="Fr")l="frm_batchApplyKey",F=n.n8,A=n.n8,k=n.n8;else throw new Error("Invalid group: "+t);const D=Math.floor(s.byteLength/F),B=Math.floor(D/a.concurrency),G=[];g=o.e(g);let S=o.e(f);for(let w=0;w<a.concurrency;w++){let _;if(w<a.concurrency-1?_=B:_=D-w*B,_==0)continue;const p=[];p.push({cmd:"ALLOCSET",var:0,buff:s.slice(w*B*F,w*B*F+_*F)}),p.push({cmd:"ALLOCSET",var:1,buff:S}),p.push({cmd:"ALLOCSET",var:2,buff:g}),p.push({cmd:"ALLOC",var:3,len:_*Math.max(A,k)}),p.push({cmd:"CALL",fnName:l,params:[{var:0},{val:_},{var:1},{var:2},{var:3}]}),E&&p.push({cmd:"CALL",fnName:E,params:[{var:3},{val:_},{var:3}]}),p.push({cmd:"GET",out:0,var:3,len:_*k}),G.push(a.queueAction(p)),S=o.mul(S,o.exp(g,_))}const st=await Promise.all(G);let U;s instanceof Ot?U=new Ot(D*k):U=new Uint8Array(D*k);let lt=0;for(let w=0;w<st.length;w++)U.set(st[w][0],lt),lt+=st[w][0].byteLength;return U}}function as(e){const t=e.tm;e.pairing=function(o,a){t.startSyncOp();const s=t.allocBuff(e.G1.toJacobian(o)),f=t.allocBuff(e.G2.toJacobian(a)),g=t.alloc(e.Gt.n8);t.instance.exports[e.name+"_pairing"](s,f,g);const I=t.getBuff(g,e.Gt.n8);return t.endSyncOp(),I},e.pairingEq=async function(){let o,a;arguments.length%2==1?(o=arguments[arguments.length-1],a=(arguments.length-1)/2):(o=e.Gt.one,a=arguments.length/2);const s=[];for(let l=0;l<a;l++){const E=[],F=e.G1.toJacobian(arguments[l*2]);E.push({cmd:"ALLOCSET",var:0,buff:F}),E.push({cmd:"ALLOC",var:1,len:e.prePSize});const A=e.G2.toJacobian(arguments[l*2+1]);E.push({cmd:"ALLOCSET",var:2,buff:A}),E.push({cmd:"ALLOC",var:3,len:e.preQSize}),E.push({cmd:"ALLOC",var:4,len:e.Gt.n8}),E.push({cmd:"CALL",fnName:e.name+"_prepareG1",params:[{var:0},{var:1}]}),E.push({cmd:"CALL",fnName:e.name+"_prepareG2",params:[{var:2},{var:3}]}),E.push({cmd:"CALL",fnName:e.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),E.push({cmd:"GET",out:0,var:4,len:e.Gt.n8}),s.push(t.queueAction(E))}const f=await Promise.all(s);t.startSyncOp();const g=t.alloc(e.Gt.n8);t.instance.exports.ftm_one(g);for(let l=0;l<f.length;l++){const E=t.allocBuff(f[l][0]);t.instance.exports.ftm_mul(g,E,g)}t.instance.exports[e.name+"_finalExponentiation"](g,g);const I=t.allocBuff(o),u=!!t.instance.exports.ftm_eq(g,I);return t.endSyncOp(),u},e.prepareG1=function(n){this.tm.startSyncOp();const o=this.tm.allocBuff(n),a=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](o,a);const s=this.tm.getBuff(a,this.prePSize);return this.tm.endSyncOp(),s},e.prepareG2=function(n){this.tm.startSyncOp();const o=this.tm.allocBuff(n),a=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](o,a);const s=this.tm.getBuff(a,this.preQSize);return this.tm.endSyncOp(),s},e.millerLoop=function(n,o){this.tm.startSyncOp();const a=this.tm.allocBuff(n),s=this.tm.allocBuff(o),f=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](a,s,f);const g=this.tm.getBuff(f,this.Gt.n8);return this.tm.endSyncOp(),g},e.finalExponentiation=function(n){this.tm.startSyncOp();const o=this.tm.allocBuff(n),a=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](o,a);const s=this.tm.getBuff(a,this.Gt.n8);return this.tm.endSyncOp(),s}}const ci=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];function si(e,t){const n=e[t],o=n.tm;async function a(f,g,I,u,l){if(!(f instanceof Uint8Array))throw u&&u.error(`${l} _multiExpChunk buffBases is not Uint8Array`),new Error(`${l} _multiExpChunk buffBases is not Uint8Array`);if(!(g instanceof Uint8Array))throw u&&u.error(`${l} _multiExpChunk buffScalars is not Uint8Array`),new Error(`${l} _multiExpChunk buffScalars is not Uint8Array`);I=I||"affine";let E,F;if(t=="G1")I=="affine"?(F="g1m_multiexpAffine_chunk",E=n.F.n8*2):(F="g1m_multiexp_chunk",E=n.F.n8*3);else if(t=="G2")I=="affine"?(F="g2m_multiexpAffine_chunk",E=n.F.n8*2):(F="g2m_multiexp_chunk",E=n.F.n8*3);else throw new Error("Invalid group");const A=Math.floor(f.byteLength/E);if(A==0)return n.zero;const k=Math.floor(g.byteLength/A);if(k*A!=g.byteLength)throw new Error("Scalar size does not match");const D=ci[jt(A)],B=Math.floor((k*8-1)/D)+1,G=[];for(let U=0;U<B;U++){const lt=[{cmd:"ALLOCSET",var:0,buff:f},{cmd:"ALLOCSET",var:1,buff:g},{cmd:"ALLOC",var:2,len:n.F.n8*3},{cmd:"CALL",fnName:F,params:[{var:0},{var:1},{val:k},{val:A},{val:U*D},{val:Math.min(k*8-U*D,D)},{var:2}]},{cmd:"GET",out:0,var:2,len:n.F.n8*3}];G.push(n.tm.queueAction(lt))}const S=await Promise.all(G);let st=n.zero;for(let U=S.length-1;U>=0;U--){if(!n.isZero(st))for(let lt=0;lt<D;lt++)st=n.double(st);st=n.add(st,S[U][0])}return st}async function s(f,g,I,u,l){let A;if(t=="G1")I=="affine"?A=n.F.n8*2:A=n.F.n8*3;else if(t=="G2")I=="affine"?A=n.F.n8*2:A=n.F.n8*3;else throw new Error("Invalid group");const k=Math.floor(f.byteLength/A);if(k==0)return n.zero;const D=Math.floor(g.byteLength/k);if(D*k!=g.byteLength)throw new Error("Scalar size does not match");const B=ci[jt(k)],G=Math.floor((D*8-1)/B)+1;let S;S=Math.floor(k/(o.concurrency/G)),S>4194304&&(S=4194304),S<1024&&(S=1024);const st=[];for(let w=0;w<k;w+=S){u&&u.debug(`Multiexp start: ${l}: ${w}/${k}`);const _=Math.min(k-w,S),p=f.slice(w*A,(w+_)*A),V=g.slice(w*D,(w+_)*D);st.push(a(p,V,I,u,l).then(j=>(u&&u.debug(`Multiexp end: ${l}: ${w}/${k}`),j)))}const U=await Promise.all(st);let lt=n.zero;for(let w=U.length-1;w>=0;w--)lt=n.add(lt,U[w]);return lt}n.multiExp=async function(g,I,u,l){return await s(g,I,"jacobian",u,l)},n.multiExpAffine=async function(g,I,u,l){return await s(g,I,"affine",u,l)}}function Go(e,t){const n=e[t],o=e.Fr,a=n.tm;async function s(u,l,E,F,A,k){E=E||"affine",F=F||"affine";const D=14;let B,G,S,st,U,lt,w,_;t=="G1"?(E=="affine"?(B=n.F.n8*2,st="g1m_batchToJacobian"):B=n.F.n8*3,G=n.F.n8*3,l&&(_="g1m_fftFinal"),w="g1m_fftJoin",lt="g1m_fftMix",F=="affine"?(S=n.F.n8*2,U="g1m_batchToAffine"):S=n.F.n8*3):t=="G2"?(E=="affine"?(B=n.F.n8*2,st="g2m_batchToJacobian"):B=n.F.n8*3,G=n.F.n8*3,l&&(_="g2m_fftFinal"),w="g2m_fftJoin",lt="g2m_fftMix",F=="affine"?(S=n.F.n8*2,U="g2m_batchToAffine"):S=n.F.n8*3):t=="Fr"&&(B=n.n8,G=n.n8,S=n.n8,l&&(_="frm_fftFinal"),lt="frm_fftMix",w="frm_fftJoin");let p=!1;Array.isArray(u)?(u=zo(u,B),p=!0):u=u.slice(0,u.byteLength);const V=u.byteLength/B,j=jt(V);if(1<<j!=V)throw new Error("fft must be multiple of 2");if(j==o.s+1){let K;return l?K=await g(u,E,F,A,k):K=await f(u,E,F,A,k),p?io(K,S):K}let X;l&&(X=o.inv(o.e(V)));let O;ti(u,B);let b,x=Math.min(1<<D,V),z=V/x;for(;z<a.concurrency&&x>=16;)z*=2,x/=2;const ot=jt(x),tt=[];for(let K=0;K<z;K++){A&&A.debug(`${k}: fft ${j} mix start: ${K}/${z}`);const it=[];it.push({cmd:"ALLOC",var:0,len:G*x});const J=u.slice(x*K*B,x*(K+1)*B);it.push({cmd:"SET",var:0,buff:J}),st&&it.push({cmd:"CALL",fnName:st,params:[{var:0},{val:x},{var:0}]});for(let et=1;et<=ot;et++)it.push({cmd:"CALL",fnName:lt,params:[{var:0},{val:x},{val:et}]});ot==j?(_&&(it.push({cmd:"ALLOCSET",var:1,buff:X}),it.push({cmd:"CALL",fnName:_,params:[{var:0},{val:x},{var:1}]})),U&&it.push({cmd:"CALL",fnName:U,params:[{var:0},{val:x},{var:0}]}),it.push({cmd:"GET",out:0,var:0,len:x*S})):it.push({cmd:"GET",out:0,var:0,len:G*x}),tt.push(a.queueAction(it).then(et=>(A&&A.debug(`${k}: fft ${j} mix end: ${K}/${z}`),et)))}b=await Promise.all(tt);for(let K=0;K<z;K++)b[K]=b[K][0];for(let K=ot+1;K<=j;K++){A&&A.debug(`${k}: fft  ${j}  join: ${K}/${j}`);const it=1<<j-K,J=z/it,et=[];for(let wt=0;wt<it;wt++)for(let ft=0;ft<J/2;ft++){const L=o.exp(o.w[K],ft*x),i=o.w[K],C=wt*J+ft,c=wt*J+ft+J/2,m=[];m.push({cmd:"ALLOCSET",var:0,buff:b[C]}),m.push({cmd:"ALLOCSET",var:1,buff:b[c]}),m.push({cmd:"ALLOCSET",var:2,buff:L}),m.push({cmd:"ALLOCSET",var:3,buff:i}),m.push({cmd:"CALL",fnName:w,params:[{var:0},{var:1},{val:x},{var:2},{var:3}]}),K==j?(_&&(m.push({cmd:"ALLOCSET",var:4,buff:X}),m.push({cmd:"CALL",fnName:_,params:[{var:0},{val:x},{var:4}]}),m.push({cmd:"CALL",fnName:_,params:[{var:1},{val:x},{var:4}]})),U&&(m.push({cmd:"CALL",fnName:U,params:[{var:0},{val:x},{var:0}]}),m.push({cmd:"CALL",fnName:U,params:[{var:1},{val:x},{var:1}]})),m.push({cmd:"GET",out:0,var:0,len:x*S}),m.push({cmd:"GET",out:1,var:1,len:x*S})):(m.push({cmd:"GET",out:0,var:0,len:x*G}),m.push({cmd:"GET",out:1,var:1,len:x*G})),et.push(a.queueAction(m).then(y=>(A&&A.debug(`${k}: fft ${j} join  ${K}/${j}  ${wt+1}/${it} ${ft}/${J/2}`),y)))}const pt=await Promise.all(et);for(let wt=0;wt<it;wt++)for(let ft=0;ft<J/2;ft++){const L=wt*J+ft,i=wt*J+ft+J/2,C=pt.shift();b[L]=C[0],b[i]=C[1]}}if(u instanceof Ot?O=new Ot(V*S):O=new Uint8Array(V*S),l){O.set(b[0].slice((x-1)*S));let K=S;for(let it=z-1;it>0;it--)O.set(b[it],K),K+=x*S,delete b[it];O.set(b[0].slice(0,(x-1)*S),K),delete b[0]}else for(let K=0;K<z;K++)O.set(b[K],x*S*K),delete b[K];return p?io(O,S):O}async function f(u,l,E,F,A){let k,D;k=u.slice(0,u.byteLength/2),D=u.slice(u.byteLength/2,u.byteLength);const B=[];[k,D]=await I(k,D,"fftJoinExt",o.one,o.shift,l,"jacobian",F,A),B.push(s(k,!1,"jacobian",E,F,A)),B.push(s(D,!1,"jacobian",E,F,A));const G=await Promise.all(B);let S;return G[0].byteLength>268435456?S=new Ot(G[0].byteLength*2):S=new Uint8Array(G[0].byteLength*2),S.set(G[0]),S.set(G[1],G[0].byteLength),S}async function g(u,l,E,F,A){let k,D;k=u.slice(0,u.byteLength/2),D=u.slice(u.byteLength/2,u.byteLength);const B=[];B.push(s(k,!0,l,"jacobian",F,A)),B.push(s(D,!0,l,"jacobian",F,A)),[k,D]=await Promise.all(B);const G=await I(k,D,"fftJoinExtInv",o.one,o.shiftInv,"jacobian",E,F,A);let S;return G[0].byteLength>268435456?S=new Ot(G[0].byteLength*2):S=new Uint8Array(G[0].byteLength*2),S.set(G[0]),S.set(G[1],G[0].byteLength),S}async function I(u,l,E,F,A,k,D,B,G){let U,lt,w,_,p,V;if(t=="G1")k=="affine"?(p=n.F.n8*2,lt="g1m_batchToJacobian"):p=n.F.n8*3,V=n.F.n8*3,U="g1m_"+E,D=="affine"?(w="g1m_batchToAffine",_=n.F.n8*2):_=n.F.n8*3;else if(t=="G2")k=="affine"?(p=n.F.n8*2,lt="g2m_batchToJacobian"):p=n.F.n8*3,U="g2m_"+E,V=n.F.n8*3,D=="affine"?(w="g2m_batchToAffine",_=n.F.n8*2):_=n.F.n8*3;else if(t=="Fr")p=o.n8,_=o.n8,V=o.n8,U="frm_"+E;else throw new Error("Invalid group");if(u.byteLength!=l.byteLength)throw new Error("Invalid buffer size");const j=Math.floor(u.byteLength/p);if(j!=1<<jt(j))throw new Error("Invalid number of points");let X=Math.floor(j/a.concurrency);X<16&&(X=16),X>65536&&(X=65536);const O=[];for(let tt=0;tt<j;tt+=X){B&&B.debug(`${G}: fftJoinExt Start: ${tt}/${j}`);const K=Math.min(j-tt,X),it=o.mul(F,o.exp(A,tt)),J=[],et=u.slice(tt*p,(tt+K)*p),pt=l.slice(tt*p,(tt+K)*p);J.push({cmd:"ALLOC",var:0,len:V*K}),J.push({cmd:"SET",var:0,buff:et}),J.push({cmd:"ALLOC",var:1,len:V*K}),J.push({cmd:"SET",var:1,buff:pt}),J.push({cmd:"ALLOCSET",var:2,buff:it}),J.push({cmd:"ALLOCSET",var:3,buff:A}),lt&&(J.push({cmd:"CALL",fnName:lt,params:[{var:0},{val:K},{var:0}]}),J.push({cmd:"CALL",fnName:lt,params:[{var:1},{val:K},{var:1}]})),J.push({cmd:"CALL",fnName:U,params:[{var:0},{var:1},{val:K},{var:2},{var:3},{val:o.s}]}),w&&(J.push({cmd:"CALL",fnName:w,params:[{var:0},{val:K},{var:0}]}),J.push({cmd:"CALL",fnName:w,params:[{var:1},{val:K},{var:1}]})),J.push({cmd:"GET",out:0,var:0,len:K*_}),J.push({cmd:"GET",out:1,var:1,len:K*_}),O.push(a.queueAction(J).then(wt=>(B&&B.debug(`${G}: fftJoinExt End: ${tt}/${j}`),wt)))}const b=await Promise.all(O);let x,z;j*_>268435456?(x=new Ot(j*_),z=new Ot(j*_)):(x=new Uint8Array(j*_),z=new Uint8Array(j*_));let ot=0;for(let tt=0;tt<b.length;tt++)x.set(b[tt][0],ot),z.set(b[tt][1],ot),ot+=b[tt][0].byteLength;return[x,z]}n.fft=async function(u,l,E,F,A){return await s(u,!1,l,E,F,A)},n.ifft=async function(u,l,E,F,A){return await s(u,!0,l,E,F,A)},n.lagrangeEvaluations=async function(u,l,E,F,A){l=l||"affine",E=E||"affine";let k;if(t=="G1")l=="affine"?k=n.F.n8*2:k=n.F.n8*3;else if(t=="G2")l=="affine"?k=n.F.n8*2:k=n.F.n8*3;else if(t=="Fr")k=o.n8;else throw new Error("Invalid group");const D=u.byteLength/k,B=jt(D);if(2**B*k!=u.byteLength)throw F&&F.error("lagrangeEvaluations iinvalid input size"),new Error("lagrangeEvaluations invalid Input size");if(B<=o.s)return await n.ifft(u,l,E,F,A);if(B>o.s+1)throw F&&F.error("lagrangeEvaluations input too big"),new Error("lagrangeEvaluations input too big");let G=u.slice(0,u.byteLength/2),S=u.slice(u.byteLength/2,u.byteLength);const st=o.exp(o.shift,D/2),U=o.inv(o.sub(o.one,st));[G,S]=await I(G,S,"prepareLagrangeEvaluation",U,o.shiftInv,l,"jacobian",F,A+" prep");const lt=[];lt.push(s(G,!0,"jacobian",E,F,A+" t0")),lt.push(s(S,!0,"jacobian",E,F,A+" t1")),[G,S]=await Promise.all(lt);let w;return G.byteLength>268435456?w=new Ot(G.byteLength*2):w=new Uint8Array(G.byteLength*2),w.set(G),w.set(S,G.byteLength),w},n.fftMix=async function(l){const E=n.F.n8*3;let F,A;if(t=="G1")F="g1m_fftMix",A="g1m_fftJoin";else if(t=="G2")F="g2m_fftMix",A="g2m_fftJoin";else if(t=="Fr")F="frm_fftMix",A="frm_fftJoin";else throw new Error("Invalid group");const k=Math.floor(l.byteLength/E),D=jt(k);let B=1<<jt(a.concurrency);k<=B*2&&(B=1);const G=k/B,S=jt(G),st=[];for(let p=0;p<B;p++){const V=[],j=l.slice(p*G*E,(p+1)*G*E);V.push({cmd:"ALLOCSET",var:0,buff:j});for(let X=1;X<=S;X++)V.push({cmd:"CALL",fnName:F,params:[{var:0},{val:G},{val:X}]});V.push({cmd:"GET",out:0,var:0,len:G*E}),st.push(a.queueAction(V))}const U=await Promise.all(st),lt=[];for(let p=0;p<U.length;p++)lt[p]=U[p][0];for(let p=S+1;p<=D;p++){const V=1<<D-p,j=B/V,X=[];for(let b=0;b<V;b++)for(let x=0;x<j/2;x++){const z=o.exp(o.w[p],x*G),ot=o.w[p],tt=b*j+x,K=b*j+x+j/2,it=[];it.push({cmd:"ALLOCSET",var:0,buff:lt[tt]}),it.push({cmd:"ALLOCSET",var:1,buff:lt[K]}),it.push({cmd:"ALLOCSET",var:2,buff:z}),it.push({cmd:"ALLOCSET",var:3,buff:ot}),it.push({cmd:"CALL",fnName:A,params:[{var:0},{var:1},{val:G},{var:2},{var:3}]}),it.push({cmd:"GET",out:0,var:0,len:G*E}),it.push({cmd:"GET",out:1,var:1,len:G*E}),X.push(a.queueAction(it))}const O=await Promise.all(X);for(let b=0;b<V;b++)for(let x=0;x<j/2;x++){const z=b*j+x,ot=b*j+x+j/2,tt=O.shift();lt[z]=tt[0],lt[ot]=tt[1]}}let w;l instanceof Ot?w=new Ot(k*E):w=new Uint8Array(k*E);let _=0;for(let p=0;p<B;p++)w.set(lt[p],_),_+=lt[p].byteLength;return w},n.fftJoin=async function(l,E,F,A){const k=n.F.n8*3;let D;if(t=="G1")D="g1m_fftJoin";else if(t=="G2")D="g2m_fftJoin";else if(t=="Fr")D="frm_fftJoin";else throw new Error("Invalid group");if(l.byteLength!=E.byteLength)throw new Error("Invalid buffer size");const B=Math.floor(l.byteLength/k);if(B!=1<<jt(B))throw new Error("Invalid number of points");let G=1<<jt(a.concurrency);B<=G*2&&(G=1);const S=B/G,st=[];for(let p=0;p<G;p++){const V=[],j=o.mul(F,o.exp(A,p*S)),X=l.slice(p*S*k,(p+1)*S*k),O=E.slice(p*S*k,(p+1)*S*k);V.push({cmd:"ALLOCSET",var:0,buff:X}),V.push({cmd:"ALLOCSET",var:1,buff:O}),V.push({cmd:"ALLOCSET",var:2,buff:j}),V.push({cmd:"ALLOCSET",var:3,buff:A}),V.push({cmd:"CALL",fnName:D,params:[{var:0},{var:1},{val:S},{var:2},{var:3}]}),V.push({cmd:"GET",out:0,var:0,len:S*k}),V.push({cmd:"GET",out:1,var:1,len:S*k}),st.push(a.queueAction(V))}const U=await Promise.all(st);let lt,w;l instanceof Ot?(lt=new Ot(B*k),w=new Ot(B*k)):(lt=new Uint8Array(B*k),w=new Uint8Array(B*k));let _=0;for(let p=0;p<U.length;p++)lt.set(U[p][0],_),w.set(U[p][1],_),_+=U[p][0].byteLength;return[lt,w]},n.fftFinal=async function(l,E){const F=n.F.n8*3,A=n.F.n8*2;let k,D;if(t=="G1")k="g1m_fftFinal",D="g1m_batchToAffine";else if(t=="G2")k="g2m_fftFinal",D="g2m_batchToAffine";else throw new Error("Invalid group");const B=Math.floor(l.byteLength/F);if(B!=1<<jt(B))throw new Error("Invalid number of points");const G=Math.floor(B/a.concurrency),S=[];for(let w=0;w<a.concurrency;w++){let _;if(w<a.concurrency-1?_=G:_=B-w*G,_==0)continue;const p=[],V=l.slice(w*G*F,(w*G+_)*F);p.push({cmd:"ALLOCSET",var:0,buff:V}),p.push({cmd:"ALLOCSET",var:1,buff:E}),p.push({cmd:"CALL",fnName:k,params:[{var:0},{val:_},{var:1}]}),p.push({cmd:"CALL",fnName:D,params:[{var:0},{val:_},{var:0}]}),p.push({cmd:"GET",out:0,var:0,len:_*A}),S.push(a.queueAction(p))}const st=await Promise.all(S);let U;l instanceof Ot?U=new Ot(B*A):U=new Uint8Array(B*A);let lt=0;for(let w=st.length-1;w>=0;w--)U.set(st[w][0],lt),lt+=st[w][0].byteLength;return U}}async function li(e){const t=await ns(e.wasm,e.singleThread),n={};return n.q=zt(e.wasm.q.toString()),n.r=zt(e.wasm.r.toString()),n.name=e.name,n.tm=t,n.prePSize=e.wasm.prePSize,n.preQSize=e.wasm.preQSize,n.Fr=new ni(t,"frm",e.n8r,e.r),n.F1=new ni(t,"f1m",e.n8q,e.q),n.F2=new oi(t,"f2m",n.F1),n.G1=new ai(t,"g1m",n.F1,e.wasm.pG1gen,e.wasm.pG1b,e.cofactorG1),n.G2=new ai(t,"g2m",n.F2,e.wasm.pG2gen,e.wasm.pG2b,e.cofactorG2),n.F6=new Wc(t,"f6m",n.F2),n.F12=new oi(t,"ftm",n.F6),n.Gt=n.F12,To(n,"G1"),To(n,"G2"),To(n,"Fr"),si(n,"G1"),si(n,"G2"),Go(n,"G1"),Go(n,"G2"),Go(n,"Fr"),as(n),n.array2buffer=function(o,a){const s=new Uint8Array(a*o.length);for(let f=0;f<o.length;f++)s.set(o[f],f*a);return s},n.buffer2array=function(o,a){const s=o.byteLength/a,f=new Array(s);for(let g=0;g<s;g++)f[g]=o.slice(g*a,g*a+a);return f},n}function Fn(e){return BigInt(e)}function ri(e){return e<0n}function is(e){return e===0n}function es(e){return ri(e)?e.toString(2).length-1:e.toString(2).length}function Ro(e){const t=[],n=Fn(e);return t.push(Number(n&0xFFn)),t.push(Number(n>>8n&0xFFn)),t.push(Number(n>>16n&0xFFn)),t.push(Number(n>>24n&0xFFn)),t}function cs(e){for(var t=[],n=0;n<e.length;n++){var o=e.charCodeAt(n);o<128?t.push(o):o<2048?t.push(192|o>>6,128|o&63):o<55296||o>=57344?t.push(224|o>>12,128|o>>6&63,128|o&63):(n++,o=65536+((o&1023)<<10|e.charCodeAt(n)&1023),t.push(240|o>>18,128|o>>12&63,128|o>>6&63,128|o&63))}return t}function Kn(e){const t=cs(e);return[...Et(t.length),...t]}function di(e){const t=[];let n=Fn(e);if(ri(n))throw new Error("Number cannot be negative");for(;!is(n);)t.push(Number(n&0x7Fn)),n=n>>7n;t.length==0&&t.push(0);for(let o=0;o<t.length-1;o++)t[o]=t[o]|128;return t}function _i(e){let t,n;const o=es(e);e<0?(n=!0,t=(1n<<BigInt(o))+e):(n=!1,t=Fn(e));const a=7-o%7,s=(1n<<BigInt(a))-1n<<BigInt(o),f=(1<<7-a)-1|128,g=di(t+s);return n||(g[g.length-1]=g[g.length-1]&f),g}function No(e){let t=Fn(e);if(t>0xFFFFFFFFn)throw new Error("Number too big");if(t>0x7FFFFFFFn&&(t=t-0x100000000n),t<-2147483648n)throw new Error("Number too small");return _i(t)}function ss(e){let t=Fn(e);if(t>0xFFFFFFFFFFFFFFFFn)throw new Error("Number too big");if(t>0x7FFFFFFFFFFFFFFFn&&(t=t-0x10000000000000000n),t<-9223372036854775808n)throw new Error("Number too small");return _i(t)}function Et(e){let t=Fn(e);if(t>0xFFFFFFFFn)throw new Error("Number too big");return di(t)}function gi(e){return Array.from(e,function(t){return("0"+(t&255).toString(16)).slice(-2)}).join("")}class ls{constructor(t){this.func=t,this.functionName=t.functionName,this.module=t.module}setLocal(t,n){const o=this.func.localIdxByName[t];if(o===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...n,33,...Et(o)]}teeLocal(t,n){const o=this.func.localIdxByName[t];if(o===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...n,34,...Et(o)]}getLocal(t){const n=this.func.localIdxByName[t];if(n===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[32,...Et(n)]}i64_load8_s(t,n,o){const a=n||0,s=o===void 0?0:o;return[...t,48,s,...Et(a)]}i64_load8_u(t,n,o){const a=n||0,s=o===void 0?0:o;return[...t,49,s,...Et(a)]}i64_load16_s(t,n,o){const a=n||0,s=o===void 0?1:o;return[...t,50,s,...Et(a)]}i64_load16_u(t,n,o){const a=n||0,s=o===void 0?1:o;return[...t,51,s,...Et(a)]}i64_load32_s(t,n,o){const a=n||0,s=o===void 0?2:o;return[...t,52,s,...Et(a)]}i64_load32_u(t,n,o){const a=n||0,s=o===void 0?2:o;return[...t,53,s,...Et(a)]}i64_load(t,n,o){const a=n||0,s=o===void 0?3:o;return[...t,41,s,...Et(a)]}i64_store(t,n,o,a){let s,f,g;return Array.isArray(n)?(s=0,f=3,g=n):Array.isArray(o)?(s=n,f=3,g=o):Array.isArray(a)&&(s=n,f=o,g=a),[...t,...g,55,f,...Et(s)]}i64_store32(t,n,o,a){let s,f,g;return Array.isArray(n)?(s=0,f=2,g=n):Array.isArray(o)?(s=n,f=2,g=o):Array.isArray(a)&&(s=n,f=o,g=a),[...t,...g,62,f,...Et(s)]}i64_store16(t,n,o,a){let s,f,g;return Array.isArray(n)?(s=0,f=1,g=n):Array.isArray(o)?(s=n,f=1,g=o):Array.isArray(a)&&(s=n,f=o,g=a),[...t,...g,61,f,...Et(s)]}i64_store8(t,n,o,a){let s,f,g;return Array.isArray(n)?(s=0,f=0,g=n):Array.isArray(o)?(s=n,f=0,g=o):Array.isArray(a)&&(s=n,f=o,g=a),[...t,...g,60,f,...Et(s)]}i32_load8_s(t,n,o){const a=n||0,s=o===void 0?0:o;return[...t,44,s,...Et(a)]}i32_load8_u(t,n,o){const a=n||0,s=o===void 0?0:o;return[...t,45,s,...Et(a)]}i32_load16_s(t,n,o){const a=n||0,s=o===void 0?1:o;return[...t,46,s,...Et(a)]}i32_load16_u(t,n,o){const a=n||0,s=o===void 0?1:o;return[...t,47,s,...Et(a)]}i32_load(t,n,o){const a=n||0,s=o===void 0?2:o;return[...t,40,s,...Et(a)]}i32_store(t,n,o,a){let s,f,g;return Array.isArray(n)?(s=0,f=2,g=n):Array.isArray(o)?(s=n,f=2,g=o):Array.isArray(a)&&(s=n,f=o,g=a),[...t,...g,54,f,...Et(s)]}i32_store16(t,n,o,a){let s,f,g;return Array.isArray(n)?(s=0,f=1,g=n):Array.isArray(o)?(s=n,f=1,g=o):Array.isArray(a)&&(s=n,f=o,g=a),[...t,...g,59,f,...Et(s)]}i32_store8(t,n,o,a){let s,f,g;return Array.isArray(n)?(s=0,f=0,g=n):Array.isArray(o)?(s=n,f=0,g=o):Array.isArray(a)&&(s=n,f=o,g=a),[...t,...g,58,f,...Et(s)]}call(t,...n){const o=this.module.functionIdxByName[t];if(o===void 0)throw new Error(`Function not defined: Function: ${t}`);return[...[].concat(...n),16,...Et(o)]}call_indirect(t,...n){return[...[].concat(...n),...t,17,0,0]}if(t,n,o){return o?[...t,4,64,...n,5,...o,11]:[...t,4,64,...n,11]}block(t){return[2,64,...t,11]}loop(...t){return[3,64,...[].concat(...t),11]}br_if(t,n){return[...n,13,...Et(t)]}br(t){return[12,...Et(t)]}ret(t){return[...t,15]}drop(t){return[...t,26]}i64_const(t){return[66,...ss(t)]}i32_const(t){return[65,...No(t)]}i64_eqz(t){return[...t,80]}i64_eq(t,n){return[...t,...n,81]}i64_ne(t,n){return[...t,...n,82]}i64_lt_s(t,n){return[...t,...n,83]}i64_lt_u(t,n){return[...t,...n,84]}i64_gt_s(t,n){return[...t,...n,85]}i64_gt_u(t,n){return[...t,...n,86]}i64_le_s(t,n){return[...t,...n,87]}i64_le_u(t,n){return[...t,...n,88]}i64_ge_s(t,n){return[...t,...n,89]}i64_ge_u(t,n){return[...t,...n,90]}i64_add(t,n){return[...t,...n,124]}i64_sub(t,n){return[...t,...n,125]}i64_mul(t,n){return[...t,...n,126]}i64_div_s(t,n){return[...t,...n,127]}i64_div_u(t,n){return[...t,...n,128]}i64_rem_s(t,n){return[...t,...n,129]}i64_rem_u(t,n){return[...t,...n,130]}i64_and(t,n){return[...t,...n,131]}i64_or(t,n){return[...t,...n,132]}i64_xor(t,n){return[...t,...n,133]}i64_shl(t,n){return[...t,...n,134]}i64_shr_s(t,n){return[...t,...n,135]}i64_shr_u(t,n){return[...t,...n,136]}i64_extend_i32_s(t){return[...t,172]}i64_extend_i32_u(t){return[...t,173]}i64_clz(t){return[...t,121]}i64_ctz(t){return[...t,122]}i32_eqz(t){return[...t,69]}i32_eq(t,n){return[...t,...n,70]}i32_ne(t,n){return[...t,...n,71]}i32_lt_s(t,n){return[...t,...n,72]}i32_lt_u(t,n){return[...t,...n,73]}i32_gt_s(t,n){return[...t,...n,74]}i32_gt_u(t,n){return[...t,...n,75]}i32_le_s(t,n){return[...t,...n,76]}i32_le_u(t,n){return[...t,...n,77]}i32_ge_s(t,n){return[...t,...n,78]}i32_ge_u(t,n){return[...t,...n,79]}i32_add(t,n){return[...t,...n,106]}i32_sub(t,n){return[...t,...n,107]}i32_mul(t,n){return[...t,...n,108]}i32_div_s(t,n){return[...t,...n,109]}i32_div_u(t,n){return[...t,...n,110]}i32_rem_s(t,n){return[...t,...n,111]}i32_rem_u(t,n){return[...t,...n,112]}i32_and(t,n){return[...t,...n,113]}i32_or(t,n){return[...t,...n,114]}i32_xor(t,n){return[...t,...n,115]}i32_shl(t,n){return[...t,...n,116]}i32_shr_s(t,n){return[...t,...n,117]}i32_shr_u(t,n){return[...t,...n,118]}i32_rotl(t,n){return[...t,...n,119]}i32_rotr(t,n){return[...t,...n,120]}i32_wrap_i64(t){return[...t,167]}i32_clz(t){return[...t,103]}i32_ctz(t){return[...t,104]}unreachable(){return[0]}current_memory(){return[63,0]}comment(){return[]}}const Ko={i32:127,i64:126,f32:125,f64:124,anyfunc:112,func:96,emptyblock:64};class ui{constructor(t,n,o,a,s){if(o=="import")this.fnType="import",this.moduleName=a,this.fieldName=s;else if(o=="internal")this.fnType="internal";else throw new Error("Invalid function fnType: "+o);this.module=t,this.fnName=n,this.params=[],this.locals=[],this.localIdxByName={},this.code=[],this.returnType=null,this.nextLocal=0}addParam(t,n){if(this.localIdxByName[t])throw new Error(`param already exists. Function: ${this.fnName}, Param: ${t} `);const o=this.nextLocal++;this.localIdxByName[t]=o,this.params.push({type:n})}addLocal(t,n,o){const a=o||1;if(this.localIdxByName[t])throw new Error(`local already exists. Function: ${this.fnName}, Param: ${t} `);const s=this.nextLocal++;this.localIdxByName[t]=s,this.locals.push({type:n,length:a})}setReturnType(t){if(this.returnType)throw new Error(`returnType already defined. Function: ${this.fnName}`);this.returnType=t}getSignature(){const t=[...Et(this.params.length),...this.params.map(o=>Ko[o.type])],n=this.returnType?[1,Ko[this.returnType]]:[0];return[96,...t,...n]}getBody(){const t=this.locals.map(o=>[...Et(o.length),Ko[o.type]]),n=[...Et(this.locals.length),...[].concat(...t),...this.code,11];return[...Et(n.length),...n]}addCode(...t){this.code.push(...[].concat(...t))}getCodeBuilder(){return new ls(this)}}class hi{constructor(){this.functions=[],this.functionIdxByName={},this.nImportFunctions=0,this.nInternalFunctions=0,this.memory={pagesSize:1,moduleName:"env",fieldName:"memory"},this.free=8,this.datas=[],this.modules={},this.exports=[],this.functionsTable=[]}build(){return this._setSignatures(),new Uint8Array([...Ro(1836278016),...Ro(1),...this._buildType(),...this._buildImport(),...this._buildFunctionDeclarations(),...this._buildFunctionsTable(),...this._buildExports(),...this._buildElements(),...this._buildCode(),...this._buildData()])}addFunction(t){if(typeof this.functionIdxByName[t]<"u")throw new Error(`Function already defined: ${t}`);const n=this.functions.length;return this.functionIdxByName[t]=n,this.functions.push(new ui(this,t,"internal")),this.nInternalFunctions++,this.functions[n]}addIimportFunction(t,n,o){if(typeof this.functionIdxByName[t]<"u")throw new Error(`Function already defined: ${t}`);if(this.functions.length>0&&this.functions[this.functions.length-1].type=="internal")throw new Error(`Import functions must be declared before internal: ${t}`);let a=o||t;const s=this.functions.length;return this.functionIdxByName[t]=s,this.functions.push(new ui(this,t,"import",n,a)),this.nImportFunctions++,this.functions[s]}setMemory(t,n,o){this.memory={pagesSize:t,moduleName:n||"env",fieldName:o||"memory"}}exportFunction(t,n){const o=n||t;if(typeof this.functionIdxByName[t]>"u")throw new Error(`Function not defined: ${t}`);const a=this.functionIdxByName[t];o!=t&&(this.functionIdxByName[o]=a),this.exports.push({exportName:o,idx:a})}addFunctionToTable(t){const n=this.functionIdxByName[t];this.functionsTable.push(n)}addData(t,n){this.datas.push({offset:t,bytes:n})}alloc(t,n){let o,a;(Array.isArray(t)||ArrayBuffer.isView(t))&&typeof n>"u"?(o=t.length,a=t):(o=t,a=n),o=(o-1>>3)+1<<3;const s=this.free;return this.free+=o,a&&this.addData(s,a),s}allocString(t){const o=new globalThis.TextEncoder().encode(t);return this.alloc([...o,0])}_setSignatures(){this.signatures=[];const t={};if(this.functionsTable.length>0){const n=this.functions[this.functionsTable[0]].getSignature(),o="s_"+gi(n);t[o]=0,this.signatures.push(n)}for(let n=0;n<this.functions.length;n++){const o=this.functions[n].getSignature(),a="s_"+gi(o);typeof t[a]>"u"&&(t[a]=this.signatures.length,this.signatures.push(o)),this.functions[n].signatureIdx=t[a]}}_buildSection(t,n){return[t,...Et(n.length),...n]}_buildType(){return this._buildSection(1,[...Et(this.signatures.length),...[].concat(...this.signatures)])}_buildImport(){const t=[];t.push([...Kn(this.memory.moduleName),...Kn(this.memory.fieldName),2,0,...Et(this.memory.pagesSize)]);for(let n=0;n<this.nImportFunctions;n++)t.push([...Kn(this.functions[n].moduleName),...Kn(this.functions[n].fieldName),0,...Et(this.functions[n].signatureIdx)]);return this._buildSection(2,Et(t.length).concat(...t))}_buildFunctionDeclarations(){const t=[];for(let n=this.nImportFunctions;n<this.nImportFunctions+this.nInternalFunctions;n++)t.push(...Et(this.functions[n].signatureIdx));return this._buildSection(3,[...Et(t.length),...t])}_buildFunctionsTable(){return this.functionsTable.length==0?[]:this._buildSection(4,[...Et(1),112,0,...Et(this.functionsTable.length)])}_buildElements(){if(this.functionsTable.length==0)return[];const t=[];for(let n=0;n<this.functionsTable.length;n++)t.push(...Et(this.functionsTable[n]));return this._buildSection(9,[...Et(1),...Et(0),65,...No(0),11,...Et(this.functionsTable.length),...t])}_buildExports(){const t=[];for(let n=0;n<this.exports.length;n++)t.push([...Kn(this.exports[n].exportName),0,...Et(this.exports[n].idx)]);return this._buildSection(7,Et(t.length).concat(...t))}_buildCode(){const t=[];for(let n=this.nImportFunctions;n<this.nImportFunctions+this.nInternalFunctions;n++)t.push(this.functions[n].getBody());return this._buildSection(10,Et(t.length).concat(...t))}_buildData(){const t=[];t.push([0,65,0,11,4,...Ro(this.free)]);for(let n=0;n<this.datas.length;n++)t.push([0,65,...No(this.datas[n].offset),11,...Et(this.datas[n].bytes.length),...this.datas[n].bytes]);return this._buildSection(11,Et(t.length).concat(...t))}}globalThis.curve_bn128=null;async function fi(e,t){if(!e&&globalThis.curve_bn128)return globalThis.curve_bn128;const n=new hi;n.setMemory(25),Hc(n);const o={};o.code=n.build(),o.pq=n.modules.f1m.pq,o.pr=n.modules.frm.pq,o.pG1gen=n.modules.bn128.pG1gen,o.pG1zero=n.modules.bn128.pG1zero,o.pG1b=n.modules.bn128.pG1b,o.pG2gen=n.modules.bn128.pG2gen,o.pG2zero=n.modules.bn128.pG2zero,o.pG2b=n.modules.bn128.pG2b,o.pOneT=n.modules.bn128.pOneT,o.prePSize=n.modules.bn128.prePSize,o.preQSize=n.modules.bn128.preQSize,o.n8q=32,o.n8r=32,o.q=n.modules.bn128.q,o.r=n.modules.bn128.r;const a={name:"bn128",wasm:o,q:zt("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:zt("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:zt("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!e},s=await li(a);return s.terminate=async function(){a.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},e||(globalThis.curve_bn128=s),s}globalThis.curve_bls12381=null;async function Li(e,t){if(!e&&globalThis.curve_bls12381)return globalThis.curve_bls12381;const n=new hi;n.setMemory(25),Vc(n);const o={};o.code=n.build(),o.pq=n.modules.f1m.pq,o.pr=n.modules.frm.pq,o.pG1gen=n.modules.bls12381.pG1gen,o.pG1zero=n.modules.bls12381.pG1zero,o.pG1b=n.modules.bls12381.pG1b,o.pG2gen=n.modules.bls12381.pG2gen,o.pG2zero=n.modules.bls12381.pG2zero,o.pG2b=n.modules.bls12381.pG2b,o.pOneT=n.modules.bls12381.pOneT,o.prePSize=n.modules.bls12381.prePSize,o.preQSize=n.modules.bls12381.preQSize,o.n8q=48,o.n8r=32,o.q=n.modules.bls12381.q,o.r=n.modules.bls12381.r;const a={name:"bls12381",wasm:o,q:zt("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:zt("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:zt("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:zt("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!e},s=await li(a);return s.terminate=async function(){a.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},e||(globalThis.curve_bls12381=s),s}zt("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),zt("21888242871839275222246405745257275088548364400416034343698204186575808495617"),zt("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),zt("21888242871839275222246405745257275088696311157297823662689037894645226208583");const Qt=Ke,Hn=Jc;var pi={};async function Ai(e,t,n,o){if(n=n||262144,typeof t!="number"&&["w+","wx+","r","ax+","a+"].indexOf(t)<0)throw new Error("Invalid open option");const a=await pi.promises.open(e,t),s=await a.stat();return new rs(a,s,n,o,e)}class rs{constructor(t,n,o,a,s){for(this.fileName=s,this.fd=t,this.pos=0,this.pageSize=a||256;this.pageSize<n.blksize;)this.pageSize*=2;this.totalSize=n.size,this.totalPages=Math.floor((n.size-1)/this.pageSize)+1,this.maxPagesLoaded=Math.floor(o/this.pageSize)+1,this.pages={},this.pendingLoads=[],this.writing=!1,this.reading=!1,this.avBuffs=[],this.history={}}_loadPage(t){const n=this,o=new Promise((a,s)=>{n.pendingLoads.push({page:t,resolve:a,reject:s})});return n.__statusPage("After Load request: ",t),o}__statusPage(t,n){const o=[],a=this;if(!a.logHistory)return;o.push("=="+t+" "+n);let s="";for(let f=0;f<a.pendingLoads.length;f++)a.pendingLoads[f].page==n&&(s=s+" "+f);if(s&&o.push("Pending loads:"+s),typeof a.pages[n]<"u"){const f=a.pages[n];o.push("Loaded"),o.push("pendingOps: "+f.pendingOps),f.loading&&o.push("loading: "+f.loading),f.writing&&o.push("writing"),f.dirty&&o.push("dirty")}o.push("=="),a.history[n]||(a.history[n]=[]),a.history[n].push(o)}__printHistory(t){}_triggerLoad(){const t=this;if(t.reading||t.pendingLoads.length==0)return;const n=Object.keys(t.pages),o=[];for(let g=0;g<n.length;g++){const I=t.pages[parseInt(n[g])];I.dirty==!1&&I.pendingOps==0&&!I.writing&&!I.loading&&o.push(parseInt(n[g]))}let a=t.maxPagesLoaded-n.length;const s=[];for(;t.pendingLoads.length>0&&(typeof t.pages[t.pendingLoads[0].page]<"u"||a>0||o.length>0);){const g=t.pendingLoads.shift();if(typeof t.pages[g.page]<"u"){t.pages[g.page].pendingOps++;const I=o.indexOf(g.page);I>=0&&o.splice(I,1),t.pages[g.page].loading?t.pages[g.page].loading.push(g):g.resolve(),t.__statusPage("After Load (cached): ",g.page)}else{if(a)a--;else{const I=o.shift();t.__statusPage("Before Unload: ",I),t.avBuffs.unshift(t.pages[I]),delete t.pages[I],t.__statusPage("After Unload: ",I)}g.page>=t.totalPages?(t.pages[g.page]=f(),g.resolve(),t.__statusPage("After Load (new): ",g.page)):(t.reading=!0,t.pages[g.page]=f(),t.pages[g.page].loading=[g],s.push(t.fd.read(t.pages[g.page].buff,0,t.pageSize,g.page*t.pageSize).then(I=>{t.pages[g.page].size=I.bytesRead;const u=t.pages[g.page].loading;delete t.pages[g.page].loading;for(let l=0;l<u.length;l++)u[l].resolve();return t.__statusPage("After Load (loaded): ",g.page),I},I=>{g.reject(I)})),t.__statusPage("After Load (loading): ",g.page))}}Promise.all(s).then(()=>{t.reading=!1,t.pendingLoads.length>0&&setImmediate(t._triggerLoad.bind(t)),t._tryClose()});function f(){if(t.avBuffs.length>0){const g=t.avBuffs.shift();return g.dirty=!1,g.pendingOps=1,g.size=0,g}else return{dirty:!1,buff:new Uint8Array(t.pageSize),pendingOps:1,size:0}}}_triggerWrite(){const t=this;if(t.writing)return;const n=Object.keys(t.pages),o=[];for(let a=0;a<n.length;a++){const s=t.pages[parseInt(n[a])];s.dirty&&(s.dirty=!1,s.writing=!0,t.writing=!0,o.push(t.fd.write(s.buff,0,s.size,parseInt(n[a])*t.pageSize).then(()=>{s.writing=!1},f=>{t.error=f,t._tryClose()})))}t.writing&&Promise.all(o).then(()=>{t.writing=!1,setImmediate(t._triggerWrite.bind(t)),t._tryClose(),t.pendingLoads.length>0&&setImmediate(t._triggerLoad.bind(t))})}_getDirtyPage(){for(let t in this.pages)if(this.pages[t].dirty)return t;return-1}async write(t,n){if(t.byteLength==0)return;const o=this;if(typeof n>"u"&&(n=o.pos),o.pos=n+t.byteLength,o.totalSize<n+t.byteLength&&(o.totalSize=n+t.byteLength),o.pendingClose)throw new Error("Writing a closing file");const a=Math.floor(n/o.pageSize),s=Math.floor((n+t.byteLength-1)/o.pageSize),f=[];for(let l=a;l<=s;l++)f.push(o._loadPage(l));o._triggerLoad();let g=a,I=n%o.pageSize,u=t.byteLength;for(;u>0;){await f[g-a];const l=I+u>o.pageSize?o.pageSize-I:u,E=t.slice(t.byteLength-u,t.byteLength-u+l);new Uint8Array(o.pages[g].buff.buffer,I,l).set(E),o.pages[g].dirty=!0,o.pages[g].pendingOps--,o.pages[g].size=Math.max(I+l,o.pages[g].size),g>=o.totalPages&&(o.totalPages=g+1),u=u-l,g++,I=0,o.writing||setImmediate(o._triggerWrite.bind(o))}}async read(t,n){const o=this;let a=new Uint8Array(t);return await o.readToBuffer(a,0,t,n),a}async readToBuffer(t,n,o,a){if(o==0)return;const s=this;if(o>s.pageSize*s.maxPagesLoaded*.8){const F=Math.floor(o*1.1);this.maxPagesLoaded=Math.floor(F/s.pageSize)+1}if(typeof a>"u"&&(a=s.pos),s.pos=a+o,s.pendingClose)throw new Error("Reading a closing file");const f=Math.floor(a/s.pageSize),g=Math.floor((a+o-1)/s.pageSize),I=[];for(let F=f;F<=g;F++)I.push(s._loadPage(F));s._triggerLoad();let u=f,l=a%s.pageSize,E=a+o>s.totalSize?o-(a+o-s.totalSize):o;for(;E>0;){await I[u-f],s.__statusPage("After Await (read): ",u);const F=l+E>s.pageSize?s.pageSize-l:E,A=new Uint8Array(s.pages[u].buff.buffer,s.pages[u].buff.byteOffset+l,F);t.set(A,n+o-E),s.pages[u].pendingOps--,s.__statusPage("After Op done: ",u),E=E-F,u++,l=0,s.pendingLoads.length>0&&setImmediate(s._triggerLoad.bind(s))}this.pos=a+o}_tryClose(){const t=this;!t.pendingClose||(t.error&&t.pendingCloseReject(t.error),t._getDirtyPage()>=0||t.writing||t.reading||t.pendingLoads.length>0)||t.pendingClose()}close(){const t=this;if(t.pendingClose)throw new Error("Closing the file twice");return new Promise((n,o)=>{t.pendingClose=n,t.pendingCloseReject=o,t._tryClose()}).then(()=>{t.fd.close()},n=>{throw t.fd.close(),n})}async discard(){await this.close(),await pi.promises.unlink(this.fileName)}async writeULE32(t,n){const o=this,a=new Uint8Array(4);new DataView(a.buffer).setUint32(0,t,!0),await o.write(a,n)}async writeUBE32(t,n){const o=this,a=new Uint8Array(4);new DataView(a.buffer).setUint32(0,t,!1),await o.write(a,n)}async writeULE64(t,n){const o=this,a=new Uint8Array(8),s=new DataView(a.buffer);s.setUint32(0,t&4294967295,!0),s.setUint32(4,Math.floor(t/4294967296),!0),await o.write(a,n)}async readULE32(t){const o=await this.read(4,t);return new Uint32Array(o.buffer)[0]}async readUBE32(t){const o=await this.read(4,t);return new DataView(o.buffer).getUint32(0,!1)}async readULE64(t){const o=await this.read(8,t),a=new Uint32Array(o.buffer);return a[1]*4294967296+a[0]}async readString(t){const n=this;if(n.pendingClose)throw new Error("Reading a closing file");let o=typeof t>"u"?n.pos:t,a=Math.floor(o/n.pageSize),s=!1,f="";for(;!s;){let g=n._loadPage(a);n._triggerLoad(),await g,n.__statusPage("After Await (read): ",a);let I=o%n.pageSize;const u=new Uint8Array(n.pages[a].buff.buffer,n.pages[a].buff.byteOffset+I,n.pageSize-I);let l=u.findIndex(E=>E===0);s=l!==-1,s?(f+=new TextDecoder().decode(u.slice(0,l)),n.pos=a*this.pageSize+I+l+1):(f+=new TextDecoder().decode(u),n.pos=a*this.pageSize+I+u.length),n.pages[a].pendingOps--,n.__statusPage("After Op done: ",a),o=n.pos,a++,n.pendingLoads.length>0&&setImmediate(n._triggerLoad.bind(n))}return f}}function ds(e){const t=e.initialSize||1048576,n=new Ci;return n.o=e,n.o.data=new Uint8Array(t),n.allocSize=t,n.totalSize=0,n.readOnly=!1,n.pos=0,n}function _s(e){const t=new Ci;return t.o=e,t.allocSize=e.data.byteLength,t.totalSize=e.data.byteLength,t.readOnly=!0,t.pos=0,t}const Ho=new Uint8Array(4),bi=new DataView(Ho.buffer),yi=new Uint8Array(8),Ii=new DataView(yi.buffer);class Ci{constructor(){this.pageSize=16384}_resizeIfNeeded(t){if(t>this.allocSize){const n=Math.max(this.allocSize+1048576,Math.floor(this.allocSize*1.1),t),o=new Uint8Array(n);o.set(this.o.data),this.o.data=o,this.allocSize=n}}async write(t,n){if(typeof n>"u"&&(n=this.pos),this.readOnly)throw new Error("Writing a read only file");this._resizeIfNeeded(n+t.byteLength),this.o.data.set(t.slice(),n),n+t.byteLength>this.totalSize&&(this.totalSize=n+t.byteLength),this.pos=n+t.byteLength}async readToBuffer(t,n,o,a){if(typeof a>"u"&&(a=this.pos),this.readOnly&&a+o>this.totalSize)throw new Error("Reading out of bounds");this._resizeIfNeeded(a+o);const f=new Uint8Array(this.o.data.buffer,this.o.data.byteOffset+a,o);t.set(f,n),this.pos=a+o}async read(t,n){const o=this,a=new Uint8Array(t);return await o.readToBuffer(a,0,t,n),a}close(){this.o.data.byteLength!=this.totalSize&&(this.o.data=this.o.data.slice(0,this.totalSize))}async discard(){}async writeULE32(t,n){const o=this;bi.setUint32(0,t,!0),await o.write(Ho,n)}async writeUBE32(t,n){const o=this;bi.setUint32(0,t,!1),await o.write(Ho,n)}async writeULE64(t,n){const o=this;Ii.setUint32(0,t&4294967295,!0),Ii.setUint32(4,Math.floor(t/4294967296),!0),await o.write(yi,n)}async readULE32(t){const o=await this.read(4,t);return new Uint32Array(o.buffer)[0]}async readUBE32(t){const o=await this.read(4,t);return new DataView(o.buffer).getUint32(0,!1)}async readULE64(t){const o=await this.read(8,t),a=new Uint32Array(o.buffer);return a[1]*4294967296+a[0]}async readString(t){const n=this;let o=typeof t>"u"?n.pos:t;if(o>this.totalSize){if(this.readOnly)throw new Error("Reading out of bounds");this._resizeIfNeeded(t)}const a=new Uint8Array(n.o.data.buffer,o,this.totalSize-o);let s=a.findIndex(I=>I===0),f=s!==-1,g="";return f?(g=new TextDecoder().decode(a.slice(0,s)),n.pos=o+s+1):n.pos=o,g}}const kt=1<<22;function gs(e){const t=e.initialSize||0,n=new Ei;n.o=e;const o=t?Math.floor((t-1)/kt)+1:0;n.o.data=[];for(let a=0;a<o-1;a++)n.o.data.push(new Uint8Array(kt));return o&&n.o.data.push(new Uint8Array(t-kt*(o-1))),n.totalSize=0,n.readOnly=!1,n.pos=0,n}function us(e){const t=new Ei;return t.o=e,t.totalSize=(e.data.length-1)*kt+e.data[e.data.length-1].byteLength,t.readOnly=!0,t.pos=0,t}const Vo=new Uint8Array(4),mi=new DataView(Vo.buffer),wi=new Uint8Array(8),Bi=new DataView(wi.buffer);class Ei{constructor(){this.pageSize=16384}_resizeIfNeeded(t){if(t<=this.totalSize)return;if(this.readOnly)throw new Error("Reading out of file bounds");const n=Math.floor((t-1)/kt)+1;for(let o=Math.max(this.o.data.length-1,0);o<n;o++){const a=o<n-1?kt:t-(n-1)*kt,s=new Uint8Array(a);o==this.o.data.length-1&&s.set(this.o.data[o]),this.o.data[o]=s}this.totalSize=t}async write(t,n){const o=this;if(typeof n>"u"&&(n=o.pos),this.readOnly)throw new Error("Writing a read only file");this._resizeIfNeeded(n+t.byteLength);let s=Math.floor(n/kt),f=n%kt,g=t.byteLength;for(;g>0;){const I=f+g>kt?kt-f:g,u=t.slice(t.byteLength-g,t.byteLength-g+I);new Uint8Array(o.o.data[s].buffer,f,I).set(u),g=g-I,s++,f=0}this.pos=n+t.byteLength}async readToBuffer(t,n,o,a){const s=this;if(typeof a>"u"&&(a=s.pos),this.readOnly&&a+o>this.totalSize)throw new Error("Reading out of bounds");this._resizeIfNeeded(a+o);let g=Math.floor(a/kt),I=a%kt,u=o;for(;u>0;){const l=I+u>kt?kt-I:u,E=new Uint8Array(s.o.data[g].buffer,I,l);t.set(E,n+o-u),u=u-l,g++,I=0}this.pos=a+o}async read(t,n){const o=this,a=new Uint8Array(t);return await o.readToBuffer(a,0,t,n),a}close(){}async discard(){}async writeULE32(t,n){const o=this;mi.setUint32(0,t,!0),await o.write(Vo,n)}async writeUBE32(t,n){const o=this;mi.setUint32(0,t,!1),await o.write(Vo,n)}async writeULE64(t,n){const o=this;Bi.setUint32(0,t&4294967295,!0),Bi.setUint32(4,Math.floor(t/4294967296),!0),await o.write(wi,n)}async readULE32(t){const o=await this.read(4,t);return new Uint32Array(o.buffer)[0]}async readUBE32(t){const o=await this.read(4,t);return new DataView(o.buffer).getUint32(0,!1)}async readULE64(t){const o=await this.read(8,t),a=new Uint32Array(o.buffer);return a[1]*4294967296+a[0]}async readString(t){const n=this,o=2048;let a=typeof t>"u"?n.pos:t;if(a>this.totalSize){if(this.readOnly)throw new Error("Reading out of bounds");this._resizeIfNeeded(t)}let s=!1,f="";for(;!s;){let g=Math.floor(a/kt),I=a%kt;if(n.o.data[g]===void 0)throw new Error("ERROR");let u=Math.min(o,n.o.data[g].length-I);const l=new Uint8Array(n.o.data[g].buffer,I,u);let E=l.findIndex(F=>F===0);s=E!==-1,s?(f+=new TextDecoder().decode(l.slice(0,E)),n.pos=g*kt+I+E+1):(f+=new TextDecoder().decode(l),n.pos=g*kt+I+l.length),a=n.pos}return f}}const hs=1024,fs=512,Ls=2,ps=0,As=65536,bs=8192;async function Fi(e,t,n){if(typeof e=="string"&&(e={type:"file",fileName:e,cacheSize:As,pageSize:bs}),e.type=="file")return await Ai(e.fileName,hs|fs|Ls,e.cacheSize,e.pageSize);if(e.type=="mem")return ds(e);if(e.type=="bigMem")return gs(e);throw new Error("Invalid FastFile type: "+e.type)}async function Si(e,t,n){if(e instanceof Uint8Array&&(e={type:"mem",data:e}),typeof e=="string"&&(e={type:"mem",data:await fetch(e).then(function(a){return a.arrayBuffer()}).then(function(a){return new Uint8Array(a)})}),e.type=="file")return await Ai(e.fileName,ps,e.cacheSize,e.pageSize);if(e.type=="mem")return await _s(e);if(e.type=="bigMem")return await us(e);throw new Error("Invalid FastFile type: "+e.type)}async function vi(e,t,n,o,a){const s=await Si(e),f=await s.read(4);let g="";for(let E=0;E<4;E++)g+=String.fromCharCode(f[E]);if(g!=t)throw new Error(e+": Invalid File format");if(await s.readULE32()>n)throw new Error("Version not supported");const u=await s.readULE32();let l=[];for(let E=0;E<u;E++){let F=await s.readULE32(),A=await s.readULE64();typeof l[F]>"u"&&(l[F]=[]),l[F].push({p:s.pos,size:A}),s.pos+=A}return{fd:s,sections:l}}async function ys(e,t,n,o,a,s){const f=await Fi(e),g=new Uint8Array(4);for(let I=0;I<4;I++)g[I]=t.charCodeAt(I);return await f.write(g,0),await f.writeULE32(n),await f.writeULE32(o),f}async function xi(e,t){if(typeof e.writingSection<"u")throw new Error("Already writing a section");await e.writeULE32(t),e.writingSection={pSectionSize:e.pos},await e.writeULE64(0)}async function Pi(e){if(typeof e.writingSection>"u")throw new Error("Not writing a section");const t=e.pos-e.writingSection.pSectionSize-8,n=e.pos;e.pos=e.writingSection.pSectionSize,await e.writeULE64(t),e.pos=n,delete e.writingSection}async function Vn(e,t,n){if(typeof e.readingSection<"u")throw new Error("Already reading a section");if(!t[n])throw new Error(e.fileName+": Missing section "+n);if(t[n].length>1)throw new Error(e.fileName+": Section Duplicated "+n);e.pos=t[n][0].p,e.readingSection=t[n][0]}async function $n(e,t){if(typeof e.readingSection>"u")throw new Error("Not reading a section");if(e.pos-e.readingSection.p!=e.readingSection.size)throw new Error("Invalid section size reading");delete e.readingSection}async function Is(e,t,n,o){const a=new Uint8Array(n);Qt.toRprLE(a,0,t,n),await e.write(a,o)}async function bn(e,t,n){const o=await e.read(t,n);return Qt.fromRprLE(o,0,t)}async function yn(e,t,n,o,a){if(o=typeof o>"u"?0:o,a=typeof a>"u"?t[n][0].size-o:a,o+a>t[n][0].size)throw new Error("Reading out of the range of the section");let s;return a<1073741824?s=new Uint8Array(a):s=new Ot(a),await e.readToBuffer(s,0,a,t[n][0].p+o),s}Qt.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),Qt.e("21888242871839275222246405745257275088548364400416034343698204186575808495617");const Cs=Qt.e("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),ms=Qt.e("21888242871839275222246405745257275088696311157297823662689037894645226208583");async function $o(e,t){let n,o=t&&t.singleThread;if(Qt.eq(e,ms))n=await fi(o);else if(Qt.eq(e,Cs))n=await Li(o);else throw new Error(`Curve not supported: ${Qt.toString(e)}`);return n}async function ws(e,t){let n,o=t&&t.singleThread;const a=s(e);if(["BN128","BN254","ALTBN128"].indexOf(a)>=0)n=await fi(o);else if(["BLS12381"].indexOf(a)>=0)n=await Li(o);else throw new Error(`Curve not supported: ${e}`);return n;function s(f){return f.toUpperCase().match(/[A-Za-z0-9]+/g).join("")}}var Bs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},en={exports:{}},Es=Qi;class Oi extends Error{}Oi.prototype.name="AssertionError";function Qi(e,t){if(!e){var n=new Oi(t);throw Error.captureStackTrace&&Error.captureStackTrace(n,Qi),n}}var jo={exports:{}};function Mi(e){return e.length}function Fs(e){const t=e.byteLength;let n="";for(let o=0;o<t;o++)n+=String.fromCharCode(e[o]);return n}function Ss(e,t,n=0,o=Mi(t)){const a=Math.min(o,e.byteLength-n);for(let s=0;s<a;s++)e[n+s]=t.charCodeAt(s);return a}var vs={byteLength:Mi,toString:Fs,write:Ss};const Sn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",In=new Uint8Array(256);for(let e=0;e<Sn.length;e++)In[Sn.charCodeAt(e)]=e;In[45]=62,In[95]=63;function qi(e){let t=e.length;return e.charCodeAt(t-1)===61&&t--,t>1&&e.charCodeAt(t-1)===61&&t--,t*3>>>2}function xs(e){const t=e.byteLength;let n="";for(let o=0;o<t;o+=3)n+=Sn[e[o]>>2]+Sn[(e[o]&3)<<4|e[o+1]>>4]+Sn[(e[o+1]&15)<<2|e[o+2]>>6]+Sn[e[o+2]&63];return t%3===2?n=n.substring(0,n.length-1)+"=":t%3===1&&(n=n.substring(0,n.length-2)+"=="),n}function Ps(e,t,n=0,o=qi(t)){const a=Math.min(o,e.byteLength-n);for(let s=0,f=0;f<a;s+=4){const g=In[t.charCodeAt(s)],I=In[t.charCodeAt(s+1)],u=In[t.charCodeAt(s+2)],l=In[t.charCodeAt(s+3)];e[f++]=g<<2|I>>4,e[f++]=(I&15)<<4|u>>2,e[f++]=(u&3)<<6|l&63}return a}var Os={byteLength:qi,toString:xs,write:Ps};function Ui(e){return e.length>>>1}function Qs(e){const t=e.byteLength;e=new DataView(e.buffer,e.byteOffset,t);let n="",o=0;for(let a=t-t%4;o<a;o+=4)n+=e.getUint32(o).toString(16).padStart(8,"0");for(;o<t;o++)n+=e.getUint8(o).toString(16).padStart(2,"0");return n}function Ms(e,t,n=0,o=Ui(t)){const a=Math.min(o,e.byteLength-n);for(let s=0;s<a;s++){const f=zi(t.charCodeAt(s*2)),g=zi(t.charCodeAt(s*2+1));if(f===void 0||g===void 0)return e.subarray(0,s);e[n+s]=f<<4|g}return a}var qs={byteLength:Ui,toString:Qs,write:Ms};function zi(e){if(e>=48&&e<=57)return e-48;if(e>=65&&e<=70)return e-65+10;if(e>=97&&e<=102)return e-97+10}function Yo(e){let t=0;for(let n=0,o=e.length;n<o;n++){const a=e.charCodeAt(n);if(a>=55296&&a<=56319&&n+1<o){const s=e.charCodeAt(n+1);if(s>=56320&&s<=57343){t+=4,n++;continue}}a<=127?t+=1:a<=2047?t+=2:t+=3}return t}let Zo;if(typeof TextDecoder<"u"){const e=new TextDecoder;Zo=function(n){return e.decode(n)}}else Zo=function(t){const n=t.byteLength;let o="",a=0;for(;a<n;){let s=t[a];if(s<=127){o+=String.fromCharCode(s),a++;continue}let f=0,g=0;if(s<=223?(f=1,g=s&31):s<=239?(f=2,g=s&15):s<=244&&(f=3,g=s&7),n-a-f>0){let I=0;for(;I<f;)s=t[a+I+1],g=g<<6|s&63,I+=1}else g=65533,f=n-a;o+=String.fromCodePoint(g),a+=f+1}return o};let Jo;if(typeof TextEncoder<"u"){const e=new TextEncoder;Jo=function(n,o,a=0,s=Yo(o)){const f=Math.min(s,n.byteLength-a);return e.encodeInto(o,n.subarray(a,a+f)),f}}else Jo=function(t,n,o=0,a=Yo(n)){const s=Math.min(a,t.byteLength-o);t=t.subarray(o,o+s);let f=0,g=0;for(;f<n.length;){const I=n.codePointAt(f);if(I<=127){t[g++]=I,f++;continue}let u=0,l=0;for(I<=2047?(u=6,l=192):I<=65535?(u=12,l=224):I<=2097151&&(u=18,l=240),t[g++]=l|I>>u,u-=6;u>=0;)t[g++]=128|I>>u&63,u-=6;f+=I>=65536?2:1}return s};var Us={byteLength:Yo,toString:Zo,write:Jo};function ki(e){return e.length*2}function zs(e){const t=e.byteLength;let n="";for(let o=0;o<t-1;o+=2)n+=String.fromCharCode(e[o]+e[o+1]*256);return n}function ks(e,t,n=0,o=ki(t)){const a=Math.min(o,e.byteLength-n);let s=a;for(let f=0;f<t.length&&!((s-=2)<0);++f){const g=t.charCodeAt(f),I=g>>8,u=g%256;e[n+f*2]=u,e[n+f*2+1]=I}return a}var Ds={byteLength:ki,toString:zs,write:ks};(function(e,t){const n=vs,o=Os,a=qs,s=Us,f=Ds,g=new Uint8Array(Uint16Array.of(255).buffer)[0]===255;function I(c){switch(c){case"ascii":return n;case"base64":return o;case"hex":return a;case"utf8":case"utf-8":case void 0:return s;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return f;default:throw new Error(`Unknown encoding: ${c}`)}}function u(c){return c instanceof Uint8Array}function l(c){try{return I(c),!0}catch{return!1}}function E(c,m,y){const h=new Uint8Array(c);return m!==void 0&&t.fill(h,m,0,h.byteLength,y),h}function F(c){return new Uint8Array(c)}function A(c){return new Uint8Array(c)}function k(c,m){return I(m).byteLength(c)}function D(c,m){if(c===m)return 0;const y=Math.min(c.byteLength,m.byteLength);c=new DataView(c.buffer,c.byteOffset,c.byteLength),m=new DataView(m.buffer,m.byteOffset,m.byteLength);let h=0;for(let v=y-y%4;h<v;h+=4){const W=c.getUint32(h,g),R=m.getUint32(h,g);if(W!==R)break}for(;h<y;h++){const v=c.getUint8(h),W=m.getUint8(h);if(v<W)return-1;if(v>W)return 1}return c.byteLength>m.byteLength?1:c.byteLength<m.byteLength?-1:0}function B(c,m){m===void 0&&(m=c.reduce((v,W)=>v+W.byteLength,0));const y=new Uint8Array(m);let h=0;for(const v of c){if(h+v.byteLength>y.byteLength){const W=v.subarray(0,y.byteLength-h);return y.set(W,h),y}y.set(v,h),h+=v.byteLength}return y}function G(c,m,y=0,h=0,v=c.byteLength){if(v>0&&v<h||v===h||c.byteLength===0||m.byteLength===0)return 0;if(y<0)throw new RangeError("targetStart is out of range");if(h<0||h>=c.byteLength)throw new RangeError("sourceStart is out of range");if(v<0)throw new RangeError("sourceEnd is out of range");y>=m.byteLength&&(y=m.byteLength),v>c.byteLength&&(v=c.byteLength),m.byteLength-y<v-h&&(v=m.length-y+h);const W=v-h;return c===m?m.copyWithin(y,h,v):m.set(c.subarray(h,v),y),W}function S(c,m){if(c===m)return!0;if(c.byteLength!==m.byteLength)return!1;const y=c.byteLength;c=new DataView(c.buffer,c.byteOffset,c.byteLength),m=new DataView(m.buffer,m.byteOffset,m.byteLength);let h=0;for(let v=y-y%4;h<v;h+=4)if(c.getUint32(h,g)!==m.getUint32(h,g))return!1;for(;h<y;h++)if(c.getUint8(h)!==m.getUint8(h))return!1;return!0}function st(c,m,y,h,v){if(typeof m=="string"?typeof y=="string"?(v=y,y=0,h=c.byteLength):typeof h=="string"&&(v=h,h=c.byteLength):typeof m=="number"?m=m&255:typeof m=="boolean"&&(m=+m),y<0||c.byteLength<y||c.byteLength<h)throw new RangeError("Out of range index");if(y===void 0&&(y=0),h===void 0&&(h=c.byteLength),h<=y)return c;if(m||(m=0),typeof m=="number")for(let W=y;W<h;++W)c[W]=m;else{m=u(m)?m:U(m,v);const W=m.byteLength;for(let R=0;R<h-y;++R)c[R+y]=m[R%W]}return c}function U(c,m,y){return typeof c=="string"?lt(c,m):Array.isArray(c)?w(c):ArrayBuffer.isView(c)?_(c):p(c,m,y)}function lt(c,m){const y=I(m),h=new Uint8Array(y.byteLength(c));return y.write(h,c,0,h.byteLength),h}function w(c){const m=new Uint8Array(c.length);return m.set(c),m}function _(c){const m=new Uint8Array(c.byteLength);return m.set(c),m}function p(c,m,y){return new Uint8Array(c,m,y)}function V(c,m,y,h){return X(c,m,y,h)!==-1}function j(c,m,y,h,v){if(c.byteLength===0)return-1;if(typeof y=="string"?(h=y,y=0):y===void 0?y=v?0:c.length-1:y<0&&(y+=c.byteLength),y>=c.byteLength){if(v)return-1;y=c.byteLength-1}else if(y<0)if(v)y=0;else return-1;if(typeof m=="string")m=U(m,h);else if(typeof m=="number")return m=m&255,v?c.indexOf(m,y):c.lastIndexOf(m,y);if(m.byteLength===0)return-1;if(v){let W=-1;for(let R=y;R<c.byteLength;R++)if(c[R]===m[W===-1?0:R-W]){if(W===-1&&(W=R),R-W+1===m.byteLength)return W}else W!==-1&&(R-=R-W),W=-1}else{y+m.byteLength>c.byteLength&&(y=c.byteLength-m.byteLength);for(let W=y;W>=0;W--){let R=!0;for(let at=0;at<m.byteLength;at++)if(c[W+at]!==m[at]){R=!1;break}if(R)return W}}return-1}function X(c,m,y,h){return j(c,m,y,h,!0)}function O(c,m,y,h){return j(c,m,y,h,!1)}function b(c,m,y){const h=c[m];c[m]=c[y],c[y]=h}function x(c){const m=c.byteLength;if(m%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let y=0;y<m;y+=2)b(c,y,y+1);return c}function z(c){const m=c.byteLength;if(m%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let y=0;y<m;y+=4)b(c,y,y+3),b(c,y+1,y+2);return c}function ot(c){const m=c.byteLength;if(m%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let y=0;y<m;y+=8)b(c,y,y+7),b(c,y+1,y+6),b(c,y+2,y+5),b(c,y+3,y+4);return c}function tt(c){return c}function K(c,m,y=0,h=c.byteLength){const v=c.byteLength;return y>=v||h<=y?"":(y<0&&(y=0),h>v&&(h=v),(y!==0||h<v)&&(c=c.subarray(y,h)),I(m).toString(c))}function it(c,m,y,h,v){return y===void 0?v="utf8":h===void 0&&typeof y=="string"?(v=y,y=void 0):v===void 0&&typeof h=="string"&&(v=h,h=void 0),I(v).write(c,m,y,h)}function J(c,m,y){return y===void 0&&(y=0),new DataView(c.buffer,c.byteOffset,c.byteLength).setFloat64(y,m,!0),y+8}function et(c,m,y){return y===void 0&&(y=0),new DataView(c.buffer,c.byteOffset,c.byteLength).setFloat32(y,m,!0),y+4}function pt(c,m,y){return y===void 0&&(y=0),new DataView(c.buffer,c.byteOffset,c.byteLength).setUint32(y,m,!0),y+4}function wt(c,m,y){return y===void 0&&(y=0),new DataView(c.buffer,c.byteOffset,c.byteLength).setInt32(y,m,!0),y+4}function ft(c,m){return m===void 0&&(m=0),new DataView(c.buffer,c.byteOffset,c.byteLength).getFloat64(m,!0)}function L(c,m){return m===void 0&&(m=0),new DataView(c.buffer,c.byteOffset,c.byteLength).getFloat32(m,!0)}function i(c,m){return m===void 0&&(m=0),new DataView(c.buffer,c.byteOffset,c.byteLength).getUint32(m,!0)}function C(c,m){return m===void 0&&(m=0),new DataView(c.buffer,c.byteOffset,c.byteLength).getInt32(m,!0)}e.exports=t={isBuffer:u,isEncoding:l,alloc:E,allocUnsafe:F,allocUnsafeSlow:A,byteLength:k,compare:D,concat:B,copy:G,equals:S,fill:st,from:U,includes:V,indexOf:X,lastIndexOf:O,swap16:x,swap32:z,swap64:ot,toBuffer:tt,toString:K,write:it,writeDoubleLE:J,writeFloatLE:et,writeUInt32LE:pt,writeInt32LE:wt,readDoubleLE:ft,readFloatLE:L,readUInt32LE:i,readInt32LE:C}})(jo,jo.exports);var Wo,Di;function Ts(){if(Di)return Wo;Di=1;var e=(s,f)=>function(){return f||(0,s[Object.keys(s)[0]])((f={exports:{}}).exports,f),f.exports},t=(()=>{for(var s=new Uint8Array(128),f=0;f<64;f++)s[f<26?f+65:f<52?f+71:f<62?f-4:f*4-205]=f;return g=>{for(var I=g.length,u=new Uint8Array((I-(g[I-1]=="=")-(g[I-2]=="="))*3/4|0),l=0,E=0;l<I;){var F=s[g.charCodeAt(l++)],A=s[g.charCodeAt(l++)],k=s[g.charCodeAt(l++)],D=s[g.charCodeAt(l++)];u[E++]=F<<2|A>>4,u[E++]=A<<4|k>>2,u[E++]=k<<6|D}return u}})(),n=e({"wasm-binary:./blake2b.wat"(s,f){f.exports=t("AGFzbQEAAAABEANgAn9/AGADf39/AGABfwADBQQAAQICBQUBAQroBwdNBQZtZW1vcnkCAAxibGFrZTJiX2luaXQAAA5ibGFrZTJiX3VwZGF0ZQABDWJsYWtlMmJfZmluYWwAAhBibGFrZTJiX2NvbXByZXNzAAMKvz8EwAIAIABCADcDACAAQgA3AwggAEIANwMQIABCADcDGCAAQgA3AyAgAEIANwMoIABCADcDMCAAQgA3AzggAEIANwNAIABCADcDSCAAQgA3A1AgAEIANwNYIABCADcDYCAAQgA3A2ggAEIANwNwIABCADcDeCAAQoiS853/zPmE6gBBACkDAIU3A4ABIABCu86qptjQ67O7f0EIKQMAhTcDiAEgAEKr8NP0r+68tzxBECkDAIU3A5ABIABC8e30+KWn/aelf0EYKQMAhTcDmAEgAELRhZrv+s+Uh9EAQSApAwCFNwOgASAAQp/Y+dnCkdqCm39BKCkDAIU3A6gBIABC6/qG2r+19sEfQTApAwCFNwOwASAAQvnC+JuRo7Pw2wBBOCkDAIU3A7gBIABCADcDwAEgAEIANwPIASAAQgA3A9ABC20BA38gAEHAAWohAyAAQcgBaiEEIAQpAwCnIQUCQANAIAEgAkYNASAFQYABRgRAIAMgAykDACAFrXw3AwBBACEFIAAQAwsgACAFaiABLQAAOgAAIAVBAWohBSABQQFqIQEMAAsLIAQgBa03AwALYQEDfyAAQcABaiEBIABByAFqIQIgASABKQMAIAIpAwB8NwMAIABCfzcD0AEgAikDAKchAwJAA0AgA0GAAUYNASAAIANqQQA6AAAgA0EBaiEDDAALCyACIAOtNwMAIAAQAwuqOwIgfgl/IABBgAFqISEgAEGIAWohIiAAQZABaiEjIABBmAFqISQgAEGgAWohJSAAQagBaiEmIABBsAFqIScgAEG4AWohKCAhKQMAIQEgIikDACECICMpAwAhAyAkKQMAIQQgJSkDACEFICYpAwAhBiAnKQMAIQcgKCkDACEIQoiS853/zPmE6gAhCUK7zqqm2NDrs7t/IQpCq/DT9K/uvLc8IQtC8e30+KWn/aelfyEMQtGFmu/6z5SH0QAhDUKf2PnZwpHagpt/IQ5C6/qG2r+19sEfIQ9C+cL4m5Gjs/DbACEQIAApAwAhESAAKQMIIRIgACkDECETIAApAxghFCAAKQMgIRUgACkDKCEWIAApAzAhFyAAKQM4IRggACkDQCEZIAApA0ghGiAAKQNQIRsgACkDWCEcIAApA2AhHSAAKQNoIR4gACkDcCEfIAApA3ghICANIAApA8ABhSENIA8gACkD0AGFIQ8gASAFIBF8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSASfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgE3x8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBR8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAVfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgFnx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBd8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAYfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgGXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBp8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAbfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgHHx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIB18fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAefHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgH3x8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFICB8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAffHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgG3x8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBV8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAZfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgGnx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHICB8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAefHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggF3x8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBJ8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAdfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgEXx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBN8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAcfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggGHx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBZ8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAUfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgHHx8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBl8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAdfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgEXx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBZ8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByATfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggIHx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIB58fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAbfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgH3x8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBR8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAXfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggGHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBJ8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAafHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFXx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBh8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAafHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgFHx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBJ8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAefHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgHXx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBx8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAffHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgE3x8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBd8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAWfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgG3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBV8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCARfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgIHx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBl8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAafHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgEXx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBZ8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAYfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgE3x8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBV8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAbfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggIHx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIB98fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiASfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgHHx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIB18fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAXfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggGXx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBR8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAefHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgE3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIB18fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAXfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgG3x8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBF8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAcfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggGXx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBR8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAVfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgHnx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBh8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAWfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggIHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIB98fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSASfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgGnx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIB18fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAWfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgEnx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGICB8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAffHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgHnx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBV8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAbfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgEXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBh8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAXfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgFHx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBp8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCATfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgGXx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBx8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAefHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgHHx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBh8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAffHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgHXx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBJ8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAUfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggGnx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBZ8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiARfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgIHx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBV8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAZfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggF3x8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBN8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAbfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgF3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFICB8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAffHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGnx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBx8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAUfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggEXx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBl8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAdfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgE3x8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIB58fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAYfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggEnx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBV8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAbfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFnx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBt8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSATfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgGXx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBV8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAYfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgF3x8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBJ8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAWfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgIHx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBx8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAafHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgH3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBR8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAdfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgHnx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBF8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSARfHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgEnx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBN8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAUfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgFXx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBZ8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAXfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggGHx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBl8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAafHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgG3x8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBx8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAdfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggHnx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIB98fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAgfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgH3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBt8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAVfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGXx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBp8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAgfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggHnx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBd8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiASfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgHXx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBF8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByATfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggHHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBh8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAWfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFHx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgISAhKQMAIAEgCYWFNwMAICIgIikDACACIAqFhTcDACAjICMpAwAgAyALhYU3AwAgJCAkKQMAIAQgDIWFNwMAICUgJSkDACAFIA2FhTcDACAmICYpAwAgBiAOhYU3AwAgJyAnKQMAIAcgD4WFNwMAICggKCkDACAIIBCFhTcDAAs=")}}),o=n(),a=WebAssembly.compile(o);return Wo=async s=>(await WebAssembly.instantiate(await a,s)).exports,Wo}var Zt=Es,Gs=jo.exports,cn=null,Ti=typeof WebAssembly<"u"&&Ts()().then(e=>{cn=e}),sn=64,eo=[];en.exports=Ht;var Gi=en.exports.BYTES_MIN=16,Ri=en.exports.BYTES_MAX=64;en.exports.BYTES=32;var Ni=en.exports.KEYBYTES_MIN=16,Ki=en.exports.KEYBYTES_MAX=64;en.exports.KEYBYTES=32;var Hi=en.exports.SALTBYTES=16,Vi=en.exports.PERSONALBYTES=16;function Ht(e,t,n,o,a){if(!(this instanceof Ht))return new Ht(e,t,n,o,a);if(!cn)throw new Error("WASM not loaded. Wait for Blake2b.ready(cb)");e||(e=32),a!==!0&&(Zt(e>=Gi,"digestLength must be at least "+Gi+", was given "+e),Zt(e<=Ri,"digestLength must be at most "+Ri+", was given "+e),t!=null&&(Zt(t instanceof Uint8Array,"key must be Uint8Array or Buffer"),Zt(t.length>=Ni,"key must be at least "+Ni+", was given "+t.length),Zt(t.length<=Ki,"key must be at least "+Ki+", was given "+t.length)),n!=null&&(Zt(n instanceof Uint8Array,"salt must be Uint8Array or Buffer"),Zt(n.length===Hi,"salt must be exactly "+Hi+", was given "+n.length)),o!=null&&(Zt(o instanceof Uint8Array,"personal must be Uint8Array or Buffer"),Zt(o.length===Vi,"personal must be exactly "+Vi+", was given "+o.length))),eo.length||(eo.push(sn),sn+=216),this.digestLength=e,this.finalized=!1,this.pointer=eo.pop(),this._memory=new Uint8Array(cn.memory.buffer),this._memory.fill(0,0,64),this._memory[0]=this.digestLength,this._memory[1]=t?t.length:0,this._memory[2]=1,this._memory[3]=1,n&&this._memory.set(n,32),o&&this._memory.set(o,48),this.pointer+216>this._memory.length&&this._realloc(this.pointer+216),cn.blake2b_init(this.pointer,this.digestLength),t&&(this.update(t),this._memory.fill(0,sn,sn+t.length),this._memory[this.pointer+200]=128)}Ht.prototype._realloc=function(e){cn.memory.grow(Math.max(0,Math.ceil(Math.abs(e-this._memory.length)/65536))),this._memory=new Uint8Array(cn.memory.buffer)},Ht.prototype.update=function(e){return Zt(this.finalized===!1,"Hash instance finalized"),Zt(e instanceof Uint8Array,"input must be Uint8Array or Buffer"),sn+e.length>this._memory.length&&this._realloc(sn+e.length),this._memory.set(e,sn),cn.blake2b_update(this.pointer,sn,sn+e.length),this},Ht.prototype.digest=function(e){if(Zt(this.finalized===!1,"Hash instance finalized"),this.finalized=!0,eo.push(this.pointer),cn.blake2b_final(this.pointer),!e||e==="binary")return this._memory.slice(this.pointer+128,this.pointer+128+this.digestLength);if(typeof e=="string")return Gs.toString(this._memory,e,this.pointer+128,this.pointer+128+this.digestLength);Zt(e instanceof Uint8Array&&e.length>=this.digestLength,"input must be Uint8Array or Buffer");for(var t=0;t<this.digestLength;t++)e[t]=this._memory[this.pointer+128+t];return e},Ht.prototype.final=Ht.prototype.digest,Ht.WASM=cn,Ht.SUPPORTED=typeof WebAssembly<"u",Ht.ready=function(e){return e||(e=Rs),Ti?Ti.then(()=>e(),e):e(new Error("WebAssembly not supported"))},Ht.prototype.ready=Ht.ready,Ht.prototype.getPartialHash=function(){return this._memory.slice(this.pointer,this.pointer+216)},Ht.prototype.setPartialHash=function(e){this._memory.set(e,this.pointer)};function Rs(){}function co(e){return((e&4294901760)!==0?(e&=4294901760,16):0)|((e&4278255360)!==0?(e&=4278255360,8):0)|((e&4042322160)!==0?(e&=4042322160,4):0)|((e&3435973836)!==0?(e&=3435973836,2):0)|(e&2863311530)!==0}const Ns=1,Ks=2,$i=10,Hs=2;async function Wt(e,t,n){const o=await e.read(t.G1.F.n8*2),a=t.G1.fromRprLEM(o,0);return n?t.G1.toObject(a):a}async function jn(e,t,n){const o=await e.read(t.G2.F.n8*2),a=t.G2.fromRprLEM(o,0);return n?t.G2.toObject(a):a}async function Vs(e,t,n,o){await Vn(e,t,1);const a=await e.readULE32();if(await $n(e),a===Ns)return await $s(e,t,n,o);if(a===Ks)return await js(e,t,n,o);if(a===$i)return await Ys(e,t,n,o);throw new Error("Protocol not supported: ")}async function $s(e,t,n,o){const a={};a.protocol="groth16",await Vn(e,t,2);const s=await e.readULE32();a.n8q=s,a.q=await bn(e,s);const f=await e.readULE32();return a.n8r=f,a.r=await bn(e,f),a.curve=await $o(a.q,o),a.nVars=await e.readULE32(),a.nPublic=await e.readULE32(),a.domainSize=await e.readULE32(),a.power=co(a.domainSize),a.vk_alpha_1=await Wt(e,a.curve,n),a.vk_beta_1=await Wt(e,a.curve,n),a.vk_beta_2=await jn(e,a.curve,n),a.vk_gamma_2=await jn(e,a.curve,n),a.vk_delta_1=await Wt(e,a.curve,n),a.vk_delta_2=await jn(e,a.curve,n),await $n(e),a}async function js(e,t,n,o){const a={};a.protocol="plonk",await Vn(e,t,2);const s=await e.readULE32();a.n8q=s,a.q=await bn(e,s);const f=await e.readULE32();return a.n8r=f,a.r=await bn(e,f),a.curve=await $o(a.q,o),a.nVars=await e.readULE32(),a.nPublic=await e.readULE32(),a.domainSize=await e.readULE32(),a.power=co(a.domainSize),a.nAdditions=await e.readULE32(),a.nConstraints=await e.readULE32(),a.k1=await e.read(f),a.k2=await e.read(f),a.Qm=await Wt(e,a.curve,n),a.Ql=await Wt(e,a.curve,n),a.Qr=await Wt(e,a.curve,n),a.Qo=await Wt(e,a.curve,n),a.Qc=await Wt(e,a.curve,n),a.S1=await Wt(e,a.curve,n),a.S2=await Wt(e,a.curve,n),a.S3=await Wt(e,a.curve,n),a.X_2=await jn(e,a.curve,n),await $n(e),a}async function Ys(e,t,n,o){const a={};a.protocol="fflonk",a.protocolId=$i,await Vn(e,t,Hs);const s=await e.readULE32();a.n8q=s,a.q=await bn(e,s),a.curve=await $o(a.q,o);const f=await e.readULE32();return a.n8r=f,a.r=await bn(e,f),a.nVars=await e.readULE32(),a.nPublic=await e.readULE32(),a.domainSize=await e.readULE32(),a.power=co(a.domainSize),a.nAdditions=await e.readULE32(),a.nConstraints=await e.readULE32(),a.k1=await e.read(f),a.k2=await e.read(f),a.w3=await e.read(f),a.w4=await e.read(f),a.w8=await e.read(f),a.wr=await e.read(f),a.X_2=await jn(e,a.curve,n),a.C0=await Wt(e,a.curve,n),await $n(e),a}async function Zs(e,t,n){await xi(e,1);const o=(Math.floor((Qt.bitLength(n)-1)/64)+1)*8;if(await e.writeULE32(o),await Is(e,n,o),t.byteLength%o!=0)throw new Error("Invalid witness length");await e.writeULE32(t.byteLength/o),await Pi(e),await xi(e,2),await e.write(t),await Pi(e)}async function Js(e,t){await Vn(e,t,1);const n=await e.readULE32(),o=await bn(e,n),a=await e.readULE32();return await $n(e),{n8:n,q:o,nWitness:a}}const{stringifyBigInts:ji}=Hn;async function Yi(e,t,n,o){const{fd:a,sections:s}=await vi(t,"wtns",2),f=await Js(a,s),{fd:g,sections:I}=await vi(e,"zkey",2),u=await Vs(g,I,void 0,o);if(u.protocol!="groth16")throw new Error("zkey file is not groth16");if(!Qt.eq(u.r,f.q))throw new Error("Curve of the witness does not match the curve of the proving key");if(f.nWitness!=u.nVars)throw new Error(`Invalid witness length. Circuit: ${u.nVars}, witness: ${f.nWitness}`);const l=u.curve,E=l.Fr,F=l.G1,A=l.G2,k=co(u.domainSize);n&&n.debug("Reading Wtns");const D=await yn(a,s,2);n&&n.debug("Reading Coeffs");const B=await yn(g,I,4);n&&n.debug("Building ABC");const[G,S,st]=await Ws(l,u,D,B,n),U=k==E.s?l.Fr.shift:l.Fr.w[k+1],lt=await E.ifft(G,"","",n,"IFFT_A"),w=await E.batchApplyKey(lt,E.e(1),U),_=await E.fft(w,"","",n,"FFT_A"),p=await E.ifft(S,"","",n,"IFFT_B"),V=await E.batchApplyKey(p,E.e(1),U),j=await E.fft(V,"","",n,"FFT_B"),X=await E.ifft(st,"","",n,"IFFT_C"),O=await E.batchApplyKey(X,E.e(1),U),b=await E.fft(O,"","",n,"FFT_C");n&&n.debug("Join ABC");const x=await Xs(l,u,_,j,b,n);let z={};n&&n.debug("Reading A Points");const ot=await yn(g,I,5);z.pi_a=await l.G1.multiExpAffine(ot,D,n,"multiexp A"),n&&n.debug("Reading B1 Points");const tt=await yn(g,I,6);let K=await l.G1.multiExpAffine(tt,D,n,"multiexp B1");n&&n.debug("Reading B2 Points");const it=await yn(g,I,7);z.pi_b=await l.G2.multiExpAffine(it,D,n,"multiexp B2"),n&&n.debug("Reading C Points");const J=await yn(g,I,8);z.pi_c=await l.G1.multiExpAffine(J,D.slice((u.nPublic+1)*l.Fr.n8),n,"multiexp C"),n&&n.debug("Reading H Points");const et=await yn(g,I,9),pt=await l.G1.multiExpAffine(et,x,n,"multiexp H"),wt=l.Fr.random(),ft=l.Fr.random();z.pi_a=F.add(z.pi_a,u.vk_alpha_1),z.pi_a=F.add(z.pi_a,F.timesFr(u.vk_delta_1,wt)),z.pi_b=A.add(z.pi_b,u.vk_beta_2),z.pi_b=A.add(z.pi_b,A.timesFr(u.vk_delta_2,ft)),K=F.add(K,u.vk_beta_1),K=F.add(K,F.timesFr(u.vk_delta_1,ft)),z.pi_c=F.add(z.pi_c,pt),z.pi_c=F.add(z.pi_c,F.timesFr(z.pi_a,ft)),z.pi_c=F.add(z.pi_c,F.timesFr(K,wt)),z.pi_c=F.add(z.pi_c,F.timesFr(u.vk_delta_1,E.neg(E.mul(wt,ft))));let L=[];for(let i=1;i<=u.nPublic;i++){const C=D.slice(i*E.n8,i*E.n8+E.n8);L.push(Qt.fromRprLE(C))}return z.pi_a=F.toObject(F.toAffine(z.pi_a)),z.pi_b=A.toObject(A.toAffine(z.pi_b)),z.pi_c=F.toObject(F.toAffine(z.pi_c)),z.protocol="groth16",z.curve=l.name,await g.close(),await a.close(),z=ji(z),L=ji(L),{proof:z,publicSignals:L}}async function Ws(e,t,n,o,a){const s=e.Fr.n8,f=12+t.n8r,g=(o.byteLength-4)/f,I=new Ot(t.domainSize*s),u=new Ot(t.domainSize*s),l=new Ot(t.domainSize*s),E=[I,u];for(let F=0;F<g;F++){a&&F%1e6==0&&a.debug(`QAP AB: ${F}/${g}`);const A=o.slice(4+F*f,4+F*f+f),k=new DataView(A.buffer),D=k.getUint32(0,!0),B=k.getUint32(4,!0),G=k.getUint32(8,!0),S=A.slice(12,12+s);E[D].set(e.Fr.add(E[D].slice(B*s,B*s+s),e.Fr.mul(S,n.slice(G*s,G*s+s))),B*s)}for(let F=0;F<t.domainSize;F++)a&&F%1e6==0&&a.debug(`QAP C: ${F}/${t.domainSize}`),l.set(e.Fr.mul(I.slice(F*s,F*s+s),u.slice(F*s,F*s+s)),F*s);return[I,u,l]}async function Xs(e,t,n,o,a,s){const g=e.Fr.n8,I=Math.floor(n.byteLength/e.Fr.n8),u=[];for(let A=0;A<I;A+=4194304){s&&s.debug(`JoinABC: ${A}/${I}`);const k=Math.min(I-A,4194304),D=[],B=n.slice(A*g,(A+k)*g),G=o.slice(A*g,(A+k)*g),S=a.slice(A*g,(A+k)*g);D.push({cmd:"ALLOCSET",var:0,buff:B}),D.push({cmd:"ALLOCSET",var:1,buff:G}),D.push({cmd:"ALLOCSET",var:2,buff:S}),D.push({cmd:"ALLOC",var:3,len:k*g}),D.push({cmd:"CALL",fnName:"qap_joinABC",params:[{var:0},{var:1},{var:2},{val:k},{var:3}]}),D.push({cmd:"CALL",fnName:"frm_batchFromMontgomery",params:[{var:3},{val:k},{var:3}]}),D.push({cmd:"GET",out:0,var:3,len:k*g}),u.push(e.tm.queueAction(D))}const l=await Promise.all(u);let E;n instanceof Ot?E=new Ot(n.byteLength):E=new Uint8Array(n.byteLength);let F=0;for(let A=0;A<l.length;A++)E.set(l[A][0],F),F+=l[A][0].byteLength;return E}function Zi(e){let t=[];return n(t,e),t;function n(o,a){if(Array.isArray(a))for(let s=0;s<a.length;s++)n(o,a[s]);else o.push(a)}}function tl(e,t){let n=BigInt(e)%t;return n<0&&(n+=t),n}function Ji(e){const t=BigInt(2)**BigInt(64);let n=BigInt("0xCBF29CE484222325");for(let s=0;s<e.length;s++)n^=BigInt(e[s].charCodeAt(0)),n*=BigInt(1099511628211),n%=t;let o=n.toString(16),a=16-o.length;return o="0".repeat(a).concat(o),o}function nl(e,t){const n=[];let o=BigInt(e);const a=BigInt(4294967296);for(;o;)n.unshift(Number(o%a)),o=o/a;if(t){let s=t-n.length;for(;s>0;)n.unshift(0),s--}return n}async function ol(e,t){let n,o,a;t=t||{};let s=1,f=0,g=0,I=!1;if(e instanceof WebAssembly.Instance)n=e,I=!0;else{let F=32767;if(t.memorySize&&(F=parseInt(t.memorySize),F<0))throw new Error("Invalid memory size");let A=!1;for(;!A;)try{a=new WebAssembly.Memory({initial:F}),A=!0}catch(B){if(F<=1)throw B;console.warn("Could not allocate "+F*1024*64+" bytes. This may cause severe instability. Trying with "+F*1024*64/2+" bytes"),F=Math.floor(F/2)}const k=await WebAssembly.compile(e);let D="";n=await WebAssembly.instantiate(k,{env:{memory:a},runtime:{printDebug:function(B){},exceptionHandler:function(B){let G;throw B===1?G="Signal not found. ":B===2?G="Too many signals set. ":B===3?G="Signal already set. ":B===4?G="Assert Failed. ":B===5?G="Not enough memory. ":B===6?G="Input signal array access exceeds the size. ":G="Unknown error. ",console.error("ERROR: ",B,D),new Error(G+D)},printErrorMessage:function(){D+=l()+`
`},writeBufferMessage:function(){l()},showSharedRWMemory:function(){const B=n.exports.getFieldNumLen32(),G=new Uint32Array(B);for(let S=0;S<B;S++)G[B-1-S]=n.exports.readSharedRWMemory(S);s>=2&&(f>=1||g>=7)?Qt.fromArray(G,4294967296).toString():console.log(Qt.fromArray(G,4294967296))},error:function(B,G,S,st,U,lt){let w;throw B===7?w=E(G)+" "+o.getFr(st).toString()+" != "+o.getFr(U).toString()+" "+E(lt):B===9?w=E(G)+" "+o.getFr(st).toString()+" "+E(U):B===5&&t.sym?w=E(G)+" "+t.sym.labelIdx2Name[U]:w=E(G)+" "+S+" "+st+" "+U+" "+lt,new Error(w)},log:function(B){console.log(o.getFr(B).toString())},logGetSignal:function(B,G){t.logGetSignal&&t.logGetSignal(B,o.getFr(G))},logSetSignal:function(B,G){t.logSetSignal&&t.logSetSignal(B,o.getFr(G))},logStartComponent:function(B){t.logStartComponent&&t.logStartComponent(B)},logFinishComponent:function(B){t.logFinishComponent&&t.logFinishComponent(B)}}})}typeof n.exports.getVersion=="function"&&(s=n.exports.getVersion()),typeof n.exports.getMinorVersion=="function"&&(f=n.exports.getMinorVersion()),typeof n.exports.getPatchVersion=="function"&&(g=n.exports.getPatchVersion());const u=t&&(t.sanityCheck||t.logGetSignal||t.logSetSignal||t.logStartComponent||t.logFinishComponent);if(s===2)o=new il(n,u);else if(s===1){if(I)throw new Error("Loading code from WebAssembly instance is not supported for circom version 1");o=new al(a,n,u)}else throw new Error(`Unsupported circom version: ${s}`);return o;function l(){let F="",A=n.exports.getMessageChar();for(;A!==0;)F+=String.fromCharCode(A),A=n.exports.getMessageChar();return F}function E(F){const A=new Uint8Array(a.buffer),k=[];for(let D=0;A[F+D]>0;D++)k.push(A[F+D]);return String.fromCharCode.apply(null,k)}}class al{constructor(t,n,o){this.memory=t,this.i32=new Uint32Array(t.buffer),this.instance=n,this.n32=(this.instance.exports.getFrLen()>>2)-2;const a=this.instance.exports.getPRawPrime(),s=new Array(this.n32);for(let f=0;f<this.n32;f++)s[this.n32-1-f]=this.i32[(a>>2)+f];this.prime=Qt.fromArray(s,4294967296),this.Fr=new ac(this.prime),this.mask32=Qt.fromString("FFFFFFFF",16),this.NVars=this.instance.exports.getNVars(),this.n64=Math.floor((this.Fr.bitLength-1)/64)+1,this.R=this.Fr.e(Qt.shiftLeft(1,this.n64*64)),this.RInv=this.Fr.inv(this.R),this.sanityCheck=o}circom_version(){return 1}async _doCalculateWitness(t,n){this.instance.exports.init(this.sanityCheck||n?1:0);const o=this.allocInt(),a=this.allocFr();Object.keys(t).forEach(f=>{const g=Ji(f),I=parseInt(g.slice(0,8),16),u=parseInt(g.slice(8,16),16);try{this.instance.exports.getSignalOffset32(o,0,I,u)}catch{throw new Error(`Signal ${f} is not an input of the circuit.`)}const l=this.getInt(o),E=Zi(t[f]);for(let F=0;F<E.length;F++)this.setFr(a,E[F]),this.instance.exports.setSignal(0,0,l+F,a)})}async calculateWitness(t,n){const o=this,a=o.i32[0],s=[];await o._doCalculateWitness(t,n);for(let f=0;f<o.NVars;f++){const g=o.instance.exports.getPWitness(f);s.push(o.getFr(g))}return o.i32[0]=a,s}async calculateBinWitness(t,n){const o=this,a=o.i32[0];await o._doCalculateWitness(t,n);const s=o.instance.exports.getWitnessBuffer();o.i32[0]=a;const f=o.memory.buffer.slice(s,s+o.NVars*o.n64*8);return new Uint8Array(f)}allocInt(){const t=this.i32[0];return this.i32[0]=t+8,t}allocFr(){const t=this.i32[0];return this.i32[0]=t+this.n32*4+8,t}getInt(t){return this.i32[t>>2]}setInt(t,n){this.i32[t>>2]=n}getFr(t){const n=this,o=t>>2;if(n.i32[o+1]&2147483648){const s=new Array(n.n32);for(let g=0;g<n.n32;g++)s[n.n32-1-g]=n.i32[o+2+g];const f=n.Fr.e(Qt.fromArray(s,4294967296));return n.i32[o+1]&1073741824?a(f):f}else return n.i32[o]&2147483648?n.Fr.e(n.i32[o]-4294967296):n.Fr.e(n.i32[o]);function a(s){return n.Fr.mul(n.RInv,s)}}setFr(t,n){const o=this;n=o.Fr.e(n);const a=o.Fr.neg(o.Fr.e("80000000",16)),s=o.Fr.e("7FFFFFFF",16);if(o.Fr.geq(n,a)&&o.Fr.leq(n,s)){let g;o.Fr.geq(n,o.Fr.zero)?g=Qt.toNumber(n):(g=Qt.toNumber(o.Fr.sub(n,a)),g=g-2147483648,g=4294967296+g),o.i32[t>>2]=g,o.i32[(t>>2)+1]=0;return}o.i32[t>>2]=0,o.i32[(t>>2)+1]=2147483648;const f=Qt.toArray(n,4294967296);for(let g=0;g<o.n32;g++){const I=f.length-1-g;I>=0?o.i32[(t>>2)+2+g]=f[I]:o.i32[(t>>2)+2+g]=0}}}class il{constructor(t,n){this.instance=t,this.version=this.instance.exports.getVersion(),this.n32=this.instance.exports.getFieldNumLen32(),this.instance.exports.getRawPrime();const o=new Uint32Array(this.n32);for(let a=0;a<this.n32;a++)o[this.n32-1-a]=this.instance.exports.readSharedRWMemory(a);this.prime=Qt.fromArray(o,4294967296),this.witnessSize=this.instance.exports.getWitnessSize(),this.sanityCheck=n}circom_version(){return this.instance.exports.getVersion()}async _doCalculateWitness(t,n){this.instance.exports.init(this.sanityCheck||n?1:0);const o=Object.keys(t);let a=0;if(o.forEach(s=>{const f=Ji(s),g=parseInt(f.slice(0,8),16),I=parseInt(f.slice(8,16),16),u=Zi(t[s]);if(typeof this.instance.exports.getInputSignalSize=="function"){let l=this.instance.exports.getInputSignalSize(g,I);if(l<0)throw new Error(`Signal ${s} not found
`);if(u.length<l)throw new Error(`Not enough values for input signal ${s}
`);if(u.length>l)throw new Error(`Too many values for input signal ${s}
`)}for(let l=0;l<u.length;l++){const E=nl(tl(u[l],this.prime),this.n32);for(let F=0;F<this.n32;F++)this.instance.exports.writeSharedRWMemory(F,E[this.n32-1-F]);try{this.instance.exports.setInputSignal(g,I,l),a++}catch(F){throw new Error(F)}}}),a<this.instance.exports.getInputSize())throw new Error(`Not all inputs have been set. Only ${a} out of ${this.instance.exports.getInputSize()}`)}async calculateWitness(t,n){const o=[];await this._doCalculateWitness(t,n);for(let a=0;a<this.witnessSize;a++){this.instance.exports.getWitness(a);const s=new Uint32Array(this.n32);for(let f=0;f<this.n32;f++)s[this.n32-1-f]=this.instance.exports.readSharedRWMemory(f);o.push(Qt.fromArray(s,4294967296))}return o}async calculateWTNSBin(t,n){const o=new Uint32Array(this.witnessSize*this.n32+this.n32+11),a=new Uint8Array(o.buffer);await this._doCalculateWitness(t,n),a[0]=119,a[1]=116,a[2]=110,a[3]=115,o[1]=2,o[2]=2,o[3]=1;const s=this.n32*4,g=(8+s).toString(16);o[4]=parseInt(g.slice(0,8),16),o[5]=parseInt(g.slice(8,16),16),o[6]=s,this.instance.exports.getRawPrime();let I=7;for(let E=0;E<this.n32;E++)o[I+E]=this.instance.exports.readSharedRWMemory(E);I+=this.n32,o[I]=this.witnessSize,I++,o[I]=2,I++;const l=(s*this.witnessSize).toString(16);o[I]=parseInt(l.slice(0,8),16),o[I+1]=parseInt(l.slice(8,16),16),I+=2;for(let E=0;E<this.witnessSize;E++){this.instance.exports.getWitness(E);for(let F=0;F<this.n32;F++)o[I+F]=this.instance.exports.readSharedRWMemory(F);I+=this.n32}return a}}const{unstringifyBigInts:el}=Hn;async function cl(e,t,n,o){const a=el(e),s=await Si(t),f=await s.read(s.totalSize);await s.close();const g=await ol(f,o);if(g.circom_version()===1){const I=await g.calculateBinWitness(a),u=await ys(n,"wtns",2,2);await Zs(u,I,g.prime),await u.close()}else{const I=await Fi(n),u=await g.calculateWTNSBin(a);await I.write(u),await I.close()}}const{unstringifyBigInts:sl}=Hn;async function ll(e,t,n,o,a,s){const f=sl(e),g={type:"mem"};return await cl(f,t,g,a),await Yi(n,g,o,s)}const{unstringifyBigInts:Xo}=Hn;async function rl(e,t,n,o){const a=Xo(e),s=Xo(n),f=Xo(t),g=await ws(a.curve),I=g.G1.fromObject(a.IC[0]),u=new Uint8Array(g.G1.F.n8*2*f.length),l=new Uint8Array(g.Fr.n8*f.length);if(!_l(g,f))return o&&o.error("Public inputs are not valid."),!1;for(let U=0;U<f.length;U++){const lt=g.G1.fromObject(a.IC[U+1]);u.set(lt,U*g.G1.F.n8*2),Qt.toRprLE(l,g.Fr.n8*U,f[U],g.Fr.n8)}let E=await g.G1.multiExpAffine(u,l);E=g.G1.add(E,I);const F=g.G1.fromObject(s.pi_a),A=g.G2.fromObject(s.pi_b),k=g.G1.fromObject(s.pi_c);if(!dl(g,{pi_a:F,pi_b:A,pi_c:k}))return o&&o.error("Proof commitments are not valid."),!1;const D=g.G2.fromObject(a.vk_gamma_2),B=g.G2.fromObject(a.vk_delta_2),G=g.G1.fromObject(a.vk_alpha_1),S=g.G2.fromObject(a.vk_beta_2);return await g.pairingEq(g.G1.neg(F),A,E,D,k,B,G,S)?(o&&o.info("OK!"),!0):(o&&o.error("Invalid proof"),!1)}function dl(e,t){const n=e.G1,o=e.G2;return n.isValid(t.pi_a)&&o.isValid(t.pi_b)&&n.isValid(t.pi_c)}function _l(e,t){for(let n=0;n<t.length;n++)if(!Qt.lt(t[n],e.r))return!1;return!0}const{unstringifyBigInts:Wi}=Hn;function ln(e){let t=e.toString(16);for(;t.length<64;)t="0"+t;return t=`"0x${t}"`,t}async function gl(e,t){const n=Wi(e),o=Wi(t);let a="";for(let f=0;f<o.length;f++)a!=""&&(a=a+","),a=a+ln(o[f]);let s;return s=`[${ln(n.pi_a[0])}, ${ln(n.pi_a[1])}],[[${ln(n.pi_b[0][1])}, ${ln(n.pi_b[0][0])}],[${ln(n.pi_b[1][1])}, ${ln(n.pi_b[1][0])}]],[${ln(n.pi_c[0])}, ${ln(n.pi_c[1])}],[${a}]`,s}var ta=Object.freeze({__proto__:null,fullProve:ll,prove:Yi,verify:rl,exportSolidityCallData:gl});Qt.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),Qt.e("21888242871839275222246405745257275088548364400416034343698204186575808495617");var ul={exports:{}};/**
 * [js-sha3]{@link https://github.com/emn178/js-sha3}
 *
 * @version 0.8.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2018
 * @license MIT
 */(function(e){(function(){var t="input is invalid type",n="finalize already called",o=typeof window=="object",a=o?window:{};a.JS_SHA3_NO_WINDOW&&(o=!1);var s=!o&&typeof self=="object",f=!a.JS_SHA3_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;f?a=Bs:s&&(a=self);var g=!a.JS_SHA3_NO_COMMON_JS&&!0&&e.exports,I=!a.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",u="0123456789abcdef".split(""),l=[31,7936,2031616,520093696],E=[4,1024,262144,67108864],F=[1,256,65536,16777216],A=[6,1536,393216,100663296],k=[0,8,16,24],D=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],B=[224,256,384,512],G=[128,256],S=["hex","buffer","arrayBuffer","array","digest"],st={128:168,256:136};(a.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(L){return Object.prototype.toString.call(L)==="[object Array]"}),I&&(a.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(L){return typeof L=="object"&&L.buffer&&L.buffer.constructor===ArrayBuffer});for(var U=function(L,i,C){return function(c){return new pt(L,i,L).update(c)[C]()}},lt=function(L,i,C){return function(c,m){return new pt(L,i,m).update(c)[C]()}},w=function(L,i,C){return function(c,m,y,h){return x["cshake"+L].update(c,m,y,h)[C]()}},_=function(L,i,C){return function(c,m,y,h){return x["kmac"+L].update(c,m,y,h)[C]()}},p=function(L,i,C,c){for(var m=0;m<S.length;++m){var y=S[m];L[y]=i(C,c,y)}return L},V=function(L,i){var C=U(L,i,"hex");return C.create=function(){return new pt(L,i,L)},C.update=function(c){return C.create().update(c)},p(C,U,L,i)},j=function(L,i){var C=lt(L,i,"hex");return C.create=function(c){return new pt(L,i,c)},C.update=function(c,m){return C.create(m).update(c)},p(C,lt,L,i)},X=function(L,i){var C=st[L],c=w(L,i,"hex");return c.create=function(m,y,h){return!y&&!h?x["shake"+L].create(m):new pt(L,i,m).bytepad([y,h],C)},c.update=function(m,y,h,v){return c.create(y,h,v).update(m)},p(c,w,L,i)},O=function(L,i){var C=st[L],c=_(L,i,"hex");return c.create=function(m,y,h){return new wt(L,i,y).bytepad(["KMAC",h],C).bytepad([m],C)},c.update=function(m,y,h,v){return c.create(m,h,v).update(y)},p(c,_,L,i)},b=[{name:"keccak",padding:F,bits:B,createMethod:V},{name:"sha3",padding:A,bits:B,createMethod:V},{name:"shake",padding:l,bits:G,createMethod:j},{name:"cshake",padding:E,bits:G,createMethod:X},{name:"kmac",padding:E,bits:G,createMethod:O}],x={},z=[],ot=0;ot<b.length;++ot)for(var tt=b[ot],K=tt.bits,it=0;it<K.length;++it){var J=tt.name+"_"+K[it];if(z.push(J),x[J]=tt.createMethod(K[it],tt.padding),tt.name!=="sha3"){var et=tt.name+K[it];z.push(et),x[et]=x[J]}}function pt(L,i,C){this.blocks=[],this.s=[],this.padding=i,this.outputBits=C,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(L<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=C>>5,this.extraBytes=(C&31)>>3;for(var c=0;c<50;++c)this.s[c]=0}pt.prototype.update=function(L){if(this.finalized)throw new Error(n);var i,C=typeof L;if(C!=="string"){if(C==="object"){if(L===null)throw new Error(t);if(I&&L.constructor===ArrayBuffer)L=new Uint8Array(L);else if(!Array.isArray(L)&&(!I||!ArrayBuffer.isView(L)))throw new Error(t)}else throw new Error(t);i=!0}for(var c=this.blocks,m=this.byteCount,y=L.length,h=this.blockCount,v=0,W=this.s,R,at;v<y;){if(this.reset)for(this.reset=!1,c[0]=this.block,R=1;R<h+1;++R)c[R]=0;if(i)for(R=this.start;v<y&&R<m;++v)c[R>>2]|=L[v]<<k[R++&3];else for(R=this.start;v<y&&R<m;++v)at=L.charCodeAt(v),at<128?c[R>>2]|=at<<k[R++&3]:at<2048?(c[R>>2]|=(192|at>>6)<<k[R++&3],c[R>>2]|=(128|at&63)<<k[R++&3]):at<55296||at>=57344?(c[R>>2]|=(224|at>>12)<<k[R++&3],c[R>>2]|=(128|at>>6&63)<<k[R++&3],c[R>>2]|=(128|at&63)<<k[R++&3]):(at=65536+((at&1023)<<10|L.charCodeAt(++v)&1023),c[R>>2]|=(240|at>>18)<<k[R++&3],c[R>>2]|=(128|at>>12&63)<<k[R++&3],c[R>>2]|=(128|at>>6&63)<<k[R++&3],c[R>>2]|=(128|at&63)<<k[R++&3]);if(this.lastByteIndex=R,R>=m){for(this.start=R-m,this.block=c[h],R=0;R<h;++R)W[R]^=c[R];ft(W),this.reset=!0}else this.start=R}return this},pt.prototype.encode=function(L,i){var C=L&255,c=1,m=[C];for(L=L>>8,C=L&255;C>0;)m.unshift(C),L=L>>8,C=L&255,++c;return i?m.push(c):m.unshift(c),this.update(m),m.length},pt.prototype.encodeString=function(L){var i,C=typeof L;if(C!=="string"){if(C==="object"){if(L===null)throw new Error(t);if(I&&L.constructor===ArrayBuffer)L=new Uint8Array(L);else if(!Array.isArray(L)&&(!I||!ArrayBuffer.isView(L)))throw new Error(t)}else throw new Error(t);i=!0}var c=0,m=L.length;if(i)c=m;else for(var y=0;y<L.length;++y){var h=L.charCodeAt(y);h<128?c+=1:h<2048?c+=2:h<55296||h>=57344?c+=3:(h=65536+((h&1023)<<10|L.charCodeAt(++y)&1023),c+=4)}return c+=this.encode(c*8),this.update(L),c},pt.prototype.bytepad=function(L,i){for(var C=this.encode(i),c=0;c<L.length;++c)C+=this.encodeString(L[c]);var m=i-C%i,y=[];return y.length=m,this.update(y),this},pt.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var L=this.blocks,i=this.lastByteIndex,C=this.blockCount,c=this.s;if(L[i>>2]|=this.padding[i&3],this.lastByteIndex===this.byteCount)for(L[0]=L[C],i=1;i<C+1;++i)L[i]=0;for(L[C-1]|=2147483648,i=0;i<C;++i)c[i]^=L[i];ft(c)}},pt.prototype.toString=pt.prototype.hex=function(){this.finalize();for(var L=this.blockCount,i=this.s,C=this.outputBlocks,c=this.extraBytes,m=0,y=0,h="",v;y<C;){for(m=0;m<L&&y<C;++m,++y)v=i[m],h+=u[v>>4&15]+u[v&15]+u[v>>12&15]+u[v>>8&15]+u[v>>20&15]+u[v>>16&15]+u[v>>28&15]+u[v>>24&15];y%L===0&&(ft(i),m=0)}return c&&(v=i[m],h+=u[v>>4&15]+u[v&15],c>1&&(h+=u[v>>12&15]+u[v>>8&15]),c>2&&(h+=u[v>>20&15]+u[v>>16&15])),h},pt.prototype.arrayBuffer=function(){this.finalize();var L=this.blockCount,i=this.s,C=this.outputBlocks,c=this.extraBytes,m=0,y=0,h=this.outputBits>>3,v;c?v=new ArrayBuffer(C+1<<2):v=new ArrayBuffer(h);for(var W=new Uint32Array(v);y<C;){for(m=0;m<L&&y<C;++m,++y)W[y]=i[m];y%L===0&&ft(i)}return c&&(W[m]=i[m],v=v.slice(0,h)),v},pt.prototype.buffer=pt.prototype.arrayBuffer,pt.prototype.digest=pt.prototype.array=function(){this.finalize();for(var L=this.blockCount,i=this.s,C=this.outputBlocks,c=this.extraBytes,m=0,y=0,h=[],v,W;y<C;){for(m=0;m<L&&y<C;++m,++y)v=y<<2,W=i[m],h[v]=W&255,h[v+1]=W>>8&255,h[v+2]=W>>16&255,h[v+3]=W>>24&255;y%L===0&&ft(i)}return c&&(v=y<<2,W=i[m],h[v]=W&255,c>1&&(h[v+1]=W>>8&255),c>2&&(h[v+2]=W>>16&255)),h};function wt(L,i,C){pt.call(this,L,i,C)}wt.prototype=new pt,wt.prototype.finalize=function(){return this.encode(this.outputBits,!0),pt.prototype.finalize.call(this)};var ft=function(L){var i,C,c,m,y,h,v,W,R,at,yt,dt,Lt,St,gt,rt,bt,xt,Mt,Vt,Dt,$t,qt,Tt,Rt,Xt,Yt,N,r,d,Q,q,P,T,M,$,Y,Z,H,nt,ut,_t,ct,At,Ct,vt,It,mt,ht,Pt,Nt,Jt,Pn,un,hn,On,fn,Ln,Qn,rn,nn,Cn,Lo;for(c=0;c<48;c+=2)m=L[0]^L[10]^L[20]^L[30]^L[40],y=L[1]^L[11]^L[21]^L[31]^L[41],h=L[2]^L[12]^L[22]^L[32]^L[42],v=L[3]^L[13]^L[23]^L[33]^L[43],W=L[4]^L[14]^L[24]^L[34]^L[44],R=L[5]^L[15]^L[25]^L[35]^L[45],at=L[6]^L[16]^L[26]^L[36]^L[46],yt=L[7]^L[17]^L[27]^L[37]^L[47],dt=L[8]^L[18]^L[28]^L[38]^L[48],Lt=L[9]^L[19]^L[29]^L[39]^L[49],i=dt^(h<<1|v>>>31),C=Lt^(v<<1|h>>>31),L[0]^=i,L[1]^=C,L[10]^=i,L[11]^=C,L[20]^=i,L[21]^=C,L[30]^=i,L[31]^=C,L[40]^=i,L[41]^=C,i=m^(W<<1|R>>>31),C=y^(R<<1|W>>>31),L[2]^=i,L[3]^=C,L[12]^=i,L[13]^=C,L[22]^=i,L[23]^=C,L[32]^=i,L[33]^=C,L[42]^=i,L[43]^=C,i=h^(at<<1|yt>>>31),C=v^(yt<<1|at>>>31),L[4]^=i,L[5]^=C,L[14]^=i,L[15]^=C,L[24]^=i,L[25]^=C,L[34]^=i,L[35]^=C,L[44]^=i,L[45]^=C,i=W^(dt<<1|Lt>>>31),C=R^(Lt<<1|dt>>>31),L[6]^=i,L[7]^=C,L[16]^=i,L[17]^=C,L[26]^=i,L[27]^=C,L[36]^=i,L[37]^=C,L[46]^=i,L[47]^=C,i=at^(m<<1|y>>>31),C=yt^(y<<1|m>>>31),L[8]^=i,L[9]^=C,L[18]^=i,L[19]^=C,L[28]^=i,L[29]^=C,L[38]^=i,L[39]^=C,L[48]^=i,L[49]^=C,St=L[0],gt=L[1],vt=L[11]<<4|L[10]>>>28,It=L[10]<<4|L[11]>>>28,N=L[20]<<3|L[21]>>>29,r=L[21]<<3|L[20]>>>29,rn=L[31]<<9|L[30]>>>23,nn=L[30]<<9|L[31]>>>23,_t=L[40]<<18|L[41]>>>14,ct=L[41]<<18|L[40]>>>14,T=L[2]<<1|L[3]>>>31,M=L[3]<<1|L[2]>>>31,rt=L[13]<<12|L[12]>>>20,bt=L[12]<<12|L[13]>>>20,mt=L[22]<<10|L[23]>>>22,ht=L[23]<<10|L[22]>>>22,d=L[33]<<13|L[32]>>>19,Q=L[32]<<13|L[33]>>>19,Cn=L[42]<<2|L[43]>>>30,Lo=L[43]<<2|L[42]>>>30,un=L[5]<<30|L[4]>>>2,hn=L[4]<<30|L[5]>>>2,$=L[14]<<6|L[15]>>>26,Y=L[15]<<6|L[14]>>>26,xt=L[25]<<11|L[24]>>>21,Mt=L[24]<<11|L[25]>>>21,Pt=L[34]<<15|L[35]>>>17,Nt=L[35]<<15|L[34]>>>17,q=L[45]<<29|L[44]>>>3,P=L[44]<<29|L[45]>>>3,Tt=L[6]<<28|L[7]>>>4,Rt=L[7]<<28|L[6]>>>4,On=L[17]<<23|L[16]>>>9,fn=L[16]<<23|L[17]>>>9,Z=L[26]<<25|L[27]>>>7,H=L[27]<<25|L[26]>>>7,Vt=L[36]<<21|L[37]>>>11,Dt=L[37]<<21|L[36]>>>11,Jt=L[47]<<24|L[46]>>>8,Pn=L[46]<<24|L[47]>>>8,At=L[8]<<27|L[9]>>>5,Ct=L[9]<<27|L[8]>>>5,Xt=L[18]<<20|L[19]>>>12,Yt=L[19]<<20|L[18]>>>12,Ln=L[29]<<7|L[28]>>>25,Qn=L[28]<<7|L[29]>>>25,nt=L[38]<<8|L[39]>>>24,ut=L[39]<<8|L[38]>>>24,$t=L[48]<<14|L[49]>>>18,qt=L[49]<<14|L[48]>>>18,L[0]=St^~rt&xt,L[1]=gt^~bt&Mt,L[10]=Tt^~Xt&N,L[11]=Rt^~Yt&r,L[20]=T^~$&Z,L[21]=M^~Y&H,L[30]=At^~vt&mt,L[31]=Ct^~It&ht,L[40]=un^~On&Ln,L[41]=hn^~fn&Qn,L[2]=rt^~xt&Vt,L[3]=bt^~Mt&Dt,L[12]=Xt^~N&d,L[13]=Yt^~r&Q,L[22]=$^~Z&nt,L[23]=Y^~H&ut,L[32]=vt^~mt&Pt,L[33]=It^~ht&Nt,L[42]=On^~Ln&rn,L[43]=fn^~Qn&nn,L[4]=xt^~Vt&$t,L[5]=Mt^~Dt&qt,L[14]=N^~d&q,L[15]=r^~Q&P,L[24]=Z^~nt&_t,L[25]=H^~ut&ct,L[34]=mt^~Pt&Jt,L[35]=ht^~Nt&Pn,L[44]=Ln^~rn&Cn,L[45]=Qn^~nn&Lo,L[6]=Vt^~$t&St,L[7]=Dt^~qt&gt,L[16]=d^~q&Tt,L[17]=Q^~P&Rt,L[26]=nt^~_t&T,L[27]=ut^~ct&M,L[36]=Pt^~Jt&At,L[37]=Nt^~Pn&Ct,L[46]=rn^~Cn&un,L[47]=nn^~Lo&hn,L[8]=$t^~St&rt,L[9]=qt^~gt&bt,L[18]=q^~Tt&Xt,L[19]=P^~Rt&Yt,L[28]=_t^~T&$,L[29]=ct^~M&Y,L[38]=Jt^~At&vt,L[39]=Pn^~Ct&It,L[48]=Cn^~un&On,L[49]=Lo^~hn&fn,L[0]^=D[c],L[1]^=D[c+1]};if(g)e.exports=x;else for(ot=0;ot<z.length;++ot)a[z[ot]]=x[z[ot]]})()})(ul);class hl{constructor(t,n={}){this.instance=t,this.memory=n.memory||new WebAssembly.Memory({initial:32768}),this.n64=this.instance.exports.get_n64?this.instance.exports.get_n64():0,this.nPublic=this.instance.exports.get_n_public?this.instance.exports.get_n_public():0,this.nConstraints=this.instance.exports.get_n_constraints?this.instance.exports.get_n_constraints():0}circom_version_supported(){return"2.1.0"}async calculateWTNSBin(t,n=0){throw new Error("calculateWTNSBin not implemented: Witness calculation requires circuit-specific implementation")}}function na(){return{runtime:{error:function(e,t,n){throw new Error(`WebAssembly error: ${e} at ${t}:${n}`)},print:function(e,t){},printErrorMessage:function(){},exceptionHandler:function(e){throw new Error(`WebAssembly exception: ${e}`)},time:function(){return Math.floor(Date.now()/1e3)},abort:function(e,t,n,o){throw new Error(`WebAssembly execution aborted at ${t}:${n}:${o}`)},writeBufferMessage:function(){},writeErrorMessage:function(){},memset:function(e,t,n){return e},showSharedRWMemory:function(){},logSetSignal:function(){},logGetSignal:function(){},logFinishComponent:function(){},logStartComponent:function(){},seed:function(){return Math.floor(Math.random()*1e6)}}}}async function Xi(e,t={}){try{const n=await WebAssembly.compile(e),o=na(),a=await WebAssembly.instantiate(n,o);return new hl(a,t)}catch(n){throw n}}typeof window<"u"&&(window.WitnessCalculatorBuilder=Xi,window.createCircomRuntimeImports=na,window.snarkjs={groth16:ta});let so=null;function te(){if(typeof window>"u")return Promise.resolve();if(so)return so;const e=window.requestIdleCallback||(t=>setTimeout(t,2e3));return so=new Promise(t=>{e(()=>{Promise.all([fetch("/zklogin.wasm").then(n=>n.arrayBuffer()),fetch("/zklogin.zkey").then(n=>n.arrayBuffer())]).then(()=>{console.info("⚡ zk-login assets pre-loaded"),t()}).catch(n=>{console.warn("⚡ zk-login pre-load failed",n),t()})})}),so}const ne="galactic:zkLogin",oe=`${ne}:activeIssuer`,fl=900*1e3,ae=21e4,ie="SHA-256",Ll="galactic::salt",lo=new Map,vn=new Map,Yn=new Map,oa=new Map;let aa=null,ee=!1;const Zn=new TextEncoder,ce=new TextDecoder;function ia(e){return`${ne}:${e}`}function ro(e){switch(e.toLowerCase()){case"google":return"https://accounts.google.com";case"microsoft":return"https://login.microsoftonline.com";default:throw new Error(`Unknown provider: ${e}`)}}function Jn(e){switch(e){case"https://accounts.google.com":return"google";case"https://login.microsoftonline.com":return"microsoft";default:throw new Error(`Unknown issuer: ${e}`)}}function _o(e){try{return Jn(e)}catch{try{return new URL(e).hostname}catch{return e}}}function pl(e){return Array.isArray(e)?e.map(t=>String(t)).sort().join(" "):typeof e=="string"?e:""}function se(e){const t=String.fromCharCode(...new Uint8Array(e));return btoa(t)}function le(e){const t=atob(e),n=new Uint8Array(t.length);for(let o=0;o<t.length;o++)n[o]=t.charCodeAt(o);return n.buffer}function ea(e){try{const t=ia(e),n=localStorage.getItem(t);return n?JSON.parse(n):null}catch(t){return console.warn(`Failed to parse JWT entry for ${e}. Removing.`,t),localStorage.removeItem(ia(e)),null}}function Al(e,t){const n=ia(e);localStorage.setItem(n,JSON.stringify(t))}function re(){return localStorage.getItem(oe)}function bl(e){localStorage.setItem(oe,e)}function de(){lo.clear(),vn.clear()}function go(){if(aa&&window.clearTimeout(aa),aa=window.setTimeout(()=>{de()},fl),!ee){const e=()=>go();["mousemove","keydown","click","scroll"].forEach(t=>{window.addEventListener(t,e)}),typeof requestIdleCallback<"u"&&requestIdleCallback(()=>go()),ee=!0}}async function ca(e,t){const n=Jn(t.iss),o=vn.get(n);if(o)return o;const a=pl(t.aud),s=`${Ll}::${t.iss}::${t.sub}::${a}`,f=await crypto.subtle.digest("SHA-256",Zn.encode(s)),g=await crypto.subtle.importKey("raw",Zn.encode(e),"PBKDF2",!1,["deriveBits"]),I=await crypto.subtle.deriveBits({name:"PBKDF2",salt:f,iterations:ae,hash:ie},g,256),u=new Uint8Array(I);return vn.set(n,u),u}async function sa(e,t){be(e);const n=`galactic::encryption::${t}`,o=await crypto.subtle.digest("SHA-256",Zn.encode(n)),a=await crypto.subtle.importKey("raw",Zn.encode(e),"PBKDF2",!1,["deriveBits"]),s=await crypto.subtle.deriveBits({name:"PBKDF2",salt:o,iterations:ae,hash:ie},a,256);return await crypto.subtle.importKey("raw",s,{name:"AES-GCM"},!1,["encrypt","decrypt"])}async function yl(e,t){const n=crypto.getRandomValues(new Uint8Array(12)),o=await crypto.subtle.encrypt({name:"AES-GCM",iv:n},e,t);return{ciphertext:se(o),iv:se(n.buffer)}}async function _e(e,t,n){const o=le(t),a=le(n),s=await crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(a)},e,o);return new Uint8Array(s)}let la=null;function Il(e){la=e}async function ge(e){const t=oa.get(e)||0;if(Date.now()<t){const o=Math.ceil((t-Date.now())/1e3);throw new Error(`Too many failed attempts. Try again in ${o} seconds.`)}const n=Yn.get(e)||0;return console.log(`🔑 PASSWORD PROMPT #${n+1} for ${_o(e)}`),la?await la(e,n):new Promise((o,a)=>{const s=e==="https://accounts.google.com"?"Google":new URL(e).hostname,f=n>0?`Invalid password (${n}/5 attempts). Enter password for ${s} zkLogin:`:`Enter password for ${s} zkLogin:`,g=prompt(f);g===null?(console.log(`🔑 Password prompt cancelled for ${_o(e)}`),a(new Error("Password prompt cancelled"))):g.length<8?(console.log(`🔑 Password too short provided in prompt for ${_o(e)}`),a(new Error("Password must be at least 8 characters"))):o(g)})}function ue(e){const t=(Yn.get(e)||0)+1;Yn.set(e,t),t>=5&&(oa.set(e,Date.now()+5e3),Yn.delete(e))}function he(e){Yn.delete(e),oa.delete(e)}async function fe(e){const t=lo.get(e),n=_o(e);if(t)return t;const o=Jn(e);for(;;){let a;try{a=await ge(e)}catch(s){if(s?.message==="Password prompt cancelled"||s?.message?.includes("Too many failed attempts"))throw s;ue(e),console.warn(`🔑 Password prompt error for ${n}:`,s?.message||s);continue}try{const{key:s}=await Le(o,a,{requireExistingEntry:!0});return s}catch(s){if(s?.message==="NO_CACHED_JWT")throw new Error(`No stored JWT for provider: ${o}`);if(s?.message==="Invalid password"){console.warn(`🔑 Invalid password for ${n}, retrying...`);continue}throw s}}}async function Le(e,t,n={}){const{requireExistingEntry:o=!1}=n,a=ro(e),s=await sa(t,a),f=ea(e);if(!f){if(o)throw new Error("NO_CACHED_JWT");return he(a),{provider:e,iss:a,key:s,fromCache:!1}}try{const g=await _e(s,f.encryptedJwt,f.jwtIv),I=ce.decode(g),u=window.SuiSDK.ZkLogin.decodeJwt(I),l=await ca(t,u);return he(a),lo.set(a,s),vn.set(e,l),go(),{provider:e,iss:a,key:s,fromCache:!0}}catch(g){ue(a);const I=g?.message||g;throw console.warn(`🔑 Password validation failed for ${e}:`,I),g?.name==="OperationError"||typeof I=="string"&&I.includes("decrypt")?new Error("Invalid password"):I==="Invalid password"?new Error("Invalid password"):new Error("Password validation failed. Please try again.")}}async function Cl(e,t,n){be(e);const o=ro(n),a=await sa(e,o),s=Zn.encode(t),{ciphertext:f,iv:g}=await yl(a,s);Al(n,{encryptedJwt:f,jwtIv:g}),lo.set(o,a),bl(n),go()}async function xn(e,t){const n=ea(e);if(!n)throw new Error(`No stored JWT for provider: ${e}`);const o=ro(e);let a;t?a=await sa(t,o):a=await fe(o);try{const s=await _e(a,n.encryptedJwt,n.jwtIv);return ce.decode(s)}catch(s){throw s?.name==="OperationError"||s?.message?.includes("decrypt")?new Error("Invalid password"):s}}function ra(e,t,n={}){const a={...{secure:window.location.protocol==="https:",sameSite:"Strict",httpOnly:!1,maxAge:900},...n};let s=`${e}=${encodeURIComponent(t)}`;a.maxAge&&(s+=`; Max-Age=${a.maxAge}`),a.secure&&(s+="; Secure"),s+=`; SameSite=${a.sameSite}`,a.httpOnly&&(s+="; HttpOnly"),s+="; Path=/",document.cookie=s}function ml(){const e=new Uint8Array(32);return crypto.getRandomValues(e),Array.from(e,t=>t.toString(16).padStart(2,"0")).join("")}function pe(){const e=ml();return ra("galactic-csrf",e,{sameSite:"Strict",secure:!0,maxAge:3600}),e}function Ae(e){const t=document.cookie.split(";");for(let n of t){const[o,a]=n.trim().split("=");if(o==="galactic-csrf")return decodeURIComponent(a)===e}return!1}function be(e){if(e.length<8)throw new Error("Password must be at least 8 characters")}function uo(e){return Array.from(e,t=>t.toString(16).padStart(2,"0")).join("")}async function ye(e,t){const n=window.SuiSDK.ZkLogin.decodeJwt(t),o=Jn(n.iss);return await Cl(e,t,o),o}async function ho(e){const t=e||re();if(!t)throw new Error("No active zkLogin provider");const n=vn.get(t);if(n)return n;const o=await xn(t),a=window.SuiSDK.ZkLogin.decodeJwt(o),s=await ge(a.iss),f=await ca(s,a);return vn.set(t,f),f}async function fo(e){const t=e||re();if(!t)throw new Error("No active zkLogin provider");const n=await xn(t),o=window.SuiSDK.ZkLogin.decodeJwt(n),a=await ho(t),s=await Ie(o.sub,a,o.iss),f=await Ce(o.iss),g=crypto.getRandomValues(new Uint8Array(32)),I=await wl(),u={combinedInput:BigInt("0x"+uo(s)),nonce:BigInt("0x"+uo(g)),maxEpoch:BigInt(I+1),iss_hash:BigInt("0x"+uo(f))},{proof:l,publicSignals:E}=await Ee(u);return{proof:l,publicSignals:E}}async function wl(){return Math.floor(Date.now()/864e5)}async function Ie(e,t,n){try{const o=new TextEncoder,a=uo(t),s=o.encode(e+a+n),f=await crypto.subtle.digest("SHA-256",s);return new Uint8Array(f)}catch(o){throw new Error(`Hashing failed: ${o.message}`)}}async function Ce(e){try{const n=new TextEncoder().encode(e);return new Uint8Array(await crypto.subtle.digest("SHA-256",n))}catch(t){throw new Error(`Issuer hashing failed: ${t.message}`)}}async function me(e){const t=ro(e);if(ea(e))try{await fe(t);const o=await xn(e);window.SuiSDK.ZkLogin.decodeJwt(o),await ho(e);const{proof:a,publicSignals:s}=await fo(e);return{proof:a,publicSignals:s,fromCache:!0}}catch(o){if(o?.message?.includes("Too many failed attempts")||o?.message==="Invalid password")throw o;console.warn(`⚠️ Failed to use cached ${e} identity:`,o?.message)}throw new Error(`OAUTH_REQUIRED:${e}`)}function Bl(e){switch(e.toLowerCase()){case"google":return"https://accounts.google.com";case"microsoft":return"https://login.microsoftonline.com";default:throw new Error(`Unsupported provider: ${e}`)}}async function we(e,t,n){const o=t.includes("http")?Jn(t):t,a=await xn(o);if(window.SuiSDK.ZkLogin.decodeJwt(a).sub!==e)throw new Error("User ID mismatch with stored claims");const{proof:f,publicSignals:g}=await fo(o),I=g[0];return{proof:f,ephemeralKey:I,publicSignals:g}}typeof window<"u"&&(window.WitnessCalculatorBuilder=Xi,window.createCircomRuntimeImports=na,window.snarkjs={groth16:ta},window.initiateSmartZkLogin=me,window.storeVerifiedJwt=ye,window.getSaltForClaims=ho,window.generateFreshProof=fo,window.deriveEphemeralKey=we,window.loadJwt=xn,window.setSecureCookie=ra,window.setCSRFToken=pe,window.validateCSRFToken=Ae);function Be(e){return{combinedInput:e.combinedInput,nonce:e.nonce,maxEpoch:e.maxEpoch,iss_hash:e.iss_hash}}async function Ee(e){const t=Be(e),n=await fetch("/zklogin.wasm").then(f=>f.arrayBuffer()),o=await fetch("/zklogin.zkey").then(f=>f.arrayBuffer()),{proof:a,publicSignals:s}=await ta.fullProve(t,new Uint8Array(n),new Uint8Array(o));return{proof:a,publicSignals:s}}return typeof window<"u"&&(window.ZkLoginHelpers={...window.ZkLoginHelpers??{},preloadZkLoginAssets:te}),Ut.buildZkLoginInputs=Be,Ut.clearSensitiveSessionData=de,Ut.deriveEphemeralKey=we,Ut.deriveSaltFromClaims=ca,Ut.generateFreshProof=fo,Ut.generateProof=Ee,Ut.getIssuerUrl=Bl,Ut.getSaltForClaims=ho,Ut.hashIss=Ce,Ut.hashSubSaltIss=Ie,Ut.initiateSmartZkLogin=me,Ut.loadJwt=xn,Ut.preloadZkLoginAssets=te,Ut.setCSRFToken=pe,Ut.setPasswordPromptFunction=Il,Ut.setSecureCookie=ra,Ut.storeVerifiedJwt=ye,Ut.validateCSRFToken=Ae,Ut.validatePasswordForProvider=Le,Object.defineProperty(Ut,Symbol.toStringTag,{value:"Module"}),Ut})({});
